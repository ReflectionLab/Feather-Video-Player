(function(u,lt){typeof exports=="object"&&typeof module<"u"?module.exports=lt(require("vue")):typeof define=="function"&&define.amd?define(["vue"],lt):(u=typeof globalThis<"u"?globalThis:u||self,u["feather-video-player"]=lt(u.Vue))})(this,function(u){"use strict";const lt=(r,e,{checkForDefaultPrevented:t=!0}={})=>i=>{const s=r==null?void 0:r(i);if(t===!1||!s)return e==null?void 0:e(i)};var gs;const ct=typeof window<"u",Hl=r=>typeof r=="string",ms=()=>{},Wl=ct&&((gs=window==null?void 0:window.navigator)==null?void 0:gs.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function ys(r){return typeof r=="function"?r():u.unref(r)}function Ql(r){return r}function Mr(r){return u.getCurrentScope()?(u.onScopeDispose(r),!0):!1}function Jl(r,e=!0){u.getCurrentInstance()?u.onMounted(r):e?r():u.nextTick(r)}function Nt(r){var e;const t=ys(r);return(e=t==null?void 0:t.$el)!=null?e:t}const Fr=ct?window:void 0;function Jn(...r){let e,t,n,i;if(Hl(r[0])||Array.isArray(r[0])?([t,n,i]=r,e=Fr):[e,t,n,i]=r,!e)return ms;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const s=[],o=()=>{s.forEach(d=>d()),s.length=0},a=(d,f,h,g)=>(d.addEventListener(f,h,g),()=>d.removeEventListener(f,h,g)),l=u.watch(()=>[Nt(e),ys(i)],([d,f])=>{o(),d&&s.push(...t.flatMap(h=>n.map(g=>a(d,h,g,f))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return Mr(c),c}let Es=!1;function Yl(r,e,t={}){const{window:n=Fr,ignore:i=[],capture:s=!0,detectIframe:o=!1}=t;if(!n)return;Wl&&!Es&&(Es=!0,Array.from(n.document.body.children).forEach(h=>h.addEventListener("click",ms)));let a=!0;const l=h=>i.some(g=>{if(typeof g=="string")return Array.from(n.document.querySelectorAll(g)).some(p=>p===h.target||h.composedPath().includes(p));{const p=Nt(g);return p&&(h.target===p||h.composedPath().includes(p))}}),d=[Jn(n,"click",h=>{const g=Nt(r);if(!(!g||g===h.target||h.composedPath().includes(g))){if(h.detail===0&&(a=!l(h)),!a){a=!0;return}e(h)}},{passive:!0,capture:s}),Jn(n,"pointerdown",h=>{const g=Nt(r);g&&(a=!h.composedPath().includes(g)&&!l(h))},{passive:!0}),o&&Jn(n,"blur",h=>{var g;const p=Nt(r);((g=n.document.activeElement)==null?void 0:g.tagName)==="IFRAME"&&!(p!=null&&p.contains(n.document.activeElement))&&e(h)})].filter(Boolean);return()=>d.forEach(h=>h())}function zl(r,e=!1){const t=u.ref(),n=()=>t.value=!!r();return n(),Jl(n,e),t}const vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},As="__vueuse_ssr_handlers__";vs[As]=vs[As]||{};var _s=Object.getOwnPropertySymbols,ql=Object.prototype.hasOwnProperty,Zl=Object.prototype.propertyIsEnumerable,Xl=(r,e)=>{var t={};for(var n in r)ql.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&_s)for(var n of _s(r))e.indexOf(n)<0&&Zl.call(r,n)&&(t[n]=r[n]);return t};function $l(r,e,t={}){const n=t,{window:i=Fr}=n,s=Xl(n,["window"]);let o;const a=zl(()=>i&&"ResizeObserver"in i),l=()=>{o&&(o.disconnect(),o=void 0)},c=u.watch(()=>Nt(r),f=>{l(),a.value&&i&&f&&(o=new ResizeObserver(e),o.observe(f,s))},{immediate:!0,flush:"post"}),d=()=>{l(),c()};return Mr(d),{isSupported:a,stop:d}}var xs;(function(r){r.UP="UP",r.RIGHT="RIGHT",r.DOWN="DOWN",r.LEFT="LEFT",r.NONE="NONE"})(xs||(xs={}));var eu=Object.defineProperty,Ss=Object.getOwnPropertySymbols,tu=Object.prototype.hasOwnProperty,nu=Object.prototype.propertyIsEnumerable,Ts=(r,e,t)=>e in r?eu(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ru=(r,e)=>{for(var t in e||(e={}))tu.call(e,t)&&Ts(r,t,e[t]);if(Ss)for(var t of Ss(e))nu.call(e,t)&&Ts(r,t,e[t]);return r};ru({linear:Ql},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const iu=()=>ct&&/firefox/i.test(window.navigator.userAgent);process.env.NODE_ENV!=="production"&&Object.freeze({}),process.env.NODE_ENV!=="production"&&Object.freeze([]);const Yn=()=>{},su=Object.prototype.hasOwnProperty,Is=(r,e)=>su.call(r,e),bs=Array.isArray,Ut=r=>typeof r=="function",ut=r=>typeof r=="string",rn=r=>r!==null&&typeof r=="object",Cs=r=>rn(r)&&Ut(r.then)&&Ut(r.catch);var ou=typeof global=="object"&&global&&global.Object===Object&&global;const au=ou;var lu=typeof self=="object"&&self&&self.Object===Object&&self,uu=au||lu||Function("return this")();const zn=uu;var cu=zn.Symbol;const sn=cu;var Ls=Object.prototype,du=Ls.hasOwnProperty,fu=Ls.toString,In=sn?sn.toStringTag:void 0;function hu(r){var e=du.call(r,In),t=r[In];try{r[In]=void 0;var n=!0}catch{}var i=fu.call(r);return n&&(e?r[In]=t:delete r[In]),i}var pu=Object.prototype,gu=pu.toString;function mu(r){return gu.call(r)}var yu="[object Null]",Eu="[object Undefined]",Rs=sn?sn.toStringTag:void 0;function ws(r){return r==null?r===void 0?Eu:yu:Rs&&Rs in Object(r)?hu(r):mu(r)}function vu(r){return r!=null&&typeof r=="object"}var Au="[object Symbol]";function qn(r){return typeof r=="symbol"||vu(r)&&ws(r)==Au}function _u(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}var xu=Array.isArray;const Nr=xu;var Su=1/0,ks=sn?sn.prototype:void 0,Ds=ks?ks.toString:void 0;function Os(r){if(typeof r=="string")return r;if(Nr(r))return _u(r,Os)+"";if(qn(r))return Ds?Ds.call(r):"";var e=r+"";return e=="0"&&1/r==-Su?"-0":e}var Tu=/\s/;function Iu(r){for(var e=r.length;e--&&Tu.test(r.charAt(e)););return e}var bu=/^\s+/;function Cu(r){return r&&r.slice(0,Iu(r)+1).replace(bu,"")}function bn(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Ps=0/0,Lu=/^[-+]0x[0-9a-f]+$/i,Ru=/^0b[01]+$/i,wu=/^0o[0-7]+$/i,ku=parseInt;function Bs(r){if(typeof r=="number")return r;if(qn(r))return Ps;if(bn(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=bn(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=Cu(r);var t=Ru.test(r);return t||wu.test(r)?ku(r.slice(2),t?2:8):Lu.test(r)?Ps:+r}var Du="[object AsyncFunction]",Ou="[object Function]",Pu="[object GeneratorFunction]",Bu="[object Proxy]";function Mu(r){if(!bn(r))return!1;var e=ws(r);return e==Ou||e==Pu||e==Du||e==Bu}var Fu=zn["__core-js_shared__"];const Ur=Fu;var Ms=function(){var r=/[^.]+$/.exec(Ur&&Ur.keys&&Ur.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function Nu(r){return!!Ms&&Ms in r}var Uu=Function.prototype,Vu=Uu.toString;function Ku(r){if(r!=null){try{return Vu.call(r)}catch{}try{return r+""}catch{}}return""}var Gu=/[\\^$.*+?()[\]{}|]/g,ju=/^\[object .+?Constructor\]$/,Hu=Function.prototype,Wu=Object.prototype,Qu=Hu.toString,Ju=Wu.hasOwnProperty,Yu=RegExp("^"+Qu.call(Ju).replace(Gu,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zu(r){if(!bn(r)||Nu(r))return!1;var e=Mu(r)?Yu:ju;return e.test(Ku(r))}function qu(r,e){return r==null?void 0:r[e]}function Fs(r,e){var t=qu(r,e);return zu(t)?t:void 0}function Zu(r,e){return r===e||r!==r&&e!==e}var Xu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$u=/^\w*$/;function ec(r,e){if(Nr(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||qn(r)?!0:$u.test(r)||!Xu.test(r)||e!=null&&r in Object(e)}var tc=Fs(Object,"create");const Cn=tc;function nc(){this.__data__=Cn?Cn(null):{},this.size=0}function rc(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var ic="__lodash_hash_undefined__",sc=Object.prototype,oc=sc.hasOwnProperty;function ac(r){var e=this.__data__;if(Cn){var t=e[r];return t===ic?void 0:t}return oc.call(e,r)?e[r]:void 0}var lc=Object.prototype,uc=lc.hasOwnProperty;function cc(r){var e=this.__data__;return Cn?e[r]!==void 0:uc.call(e,r)}var dc="__lodash_hash_undefined__";function fc(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Cn&&e===void 0?dc:e,this}function Qt(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Qt.prototype.clear=nc,Qt.prototype.delete=rc,Qt.prototype.get=ac,Qt.prototype.has=cc,Qt.prototype.set=fc;function hc(){this.__data__=[],this.size=0}function Zn(r,e){for(var t=r.length;t--;)if(Zu(r[t][0],e))return t;return-1}var pc=Array.prototype,gc=pc.splice;function mc(r){var e=this.__data__,t=Zn(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():gc.call(e,t,1),--this.size,!0}function yc(r){var e=this.__data__,t=Zn(e,r);return t<0?void 0:e[t][1]}function Ec(r){return Zn(this.__data__,r)>-1}function vc(r,e){var t=this.__data__,n=Zn(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}function on(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}on.prototype.clear=hc,on.prototype.delete=mc,on.prototype.get=yc,on.prototype.has=Ec,on.prototype.set=vc;var Ac=Fs(zn,"Map");const _c=Ac;function xc(){this.size=0,this.__data__={hash:new Qt,map:new(_c||on),string:new Qt}}function Sc(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function Xn(r,e){var t=r.__data__;return Sc(e)?t[typeof e=="string"?"string":"hash"]:t.map}function Tc(r){var e=Xn(this,r).delete(r);return this.size-=e?1:0,e}function Ic(r){return Xn(this,r).get(r)}function bc(r){return Xn(this,r).has(r)}function Cc(r,e){var t=Xn(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}function Jt(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Jt.prototype.clear=xc,Jt.prototype.delete=Tc,Jt.prototype.get=Ic,Jt.prototype.has=bc,Jt.prototype.set=Cc;var Lc="Expected a function";function Vr(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(Lc);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=t.cache;if(s.has(i))return s.get(i);var o=r.apply(this,n);return t.cache=s.set(i,o)||s,o};return t.cache=new(Vr.Cache||Jt),t}Vr.Cache=Jt;var Rc=500;function wc(r){var e=Vr(r,function(n){return t.size===Rc&&t.clear(),n}),t=e.cache;return e}var kc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dc=/\\(\\)?/g,Oc=wc(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(kc,function(t,n,i,s){e.push(i?s.replace(Dc,"$1"):n||t)}),e});const Pc=Oc;function Bc(r){return r==null?"":Os(r)}function Mc(r,e){return Nr(r)?r:ec(r,e)?[r]:Pc(Bc(r))}var Fc=1/0;function Nc(r){if(typeof r=="string"||qn(r))return r;var e=r+"";return e=="0"&&1/r==-Fc?"-0":e}function Uc(r,e){e=Mc(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[Nc(e[t++])];return t&&t==n?r:void 0}function Vc(r,e,t){var n=r==null?void 0:Uc(r,e);return n===void 0?t:n}var Kc=function(){return zn.Date.now()};const Kr=Kc;var Gc="Expected a function",jc=Math.max,Hc=Math.min;function Ns(r,e,t){var n,i,s,o,a,l,c=0,d=!1,f=!1,h=!0;if(typeof r!="function")throw new TypeError(Gc);e=Bs(e)||0,bn(t)&&(d=!!t.leading,f="maxWait"in t,s=f?jc(Bs(t.maxWait)||0,e):s,h="trailing"in t?!!t.trailing:h);function g(T){var C=n,k=i;return n=i=void 0,c=T,o=r.apply(k,C),o}function p(T){return c=T,a=setTimeout(E,e),d?g(T):o}function m(T){var C=T-l,k=T-c,B=e-C;return f?Hc(B,s-k):B}function y(T){var C=T-l,k=T-c;return l===void 0||C>=e||C<0||f&&k>=s}function E(){var T=Kr();if(y(T))return A(T);a=setTimeout(E,m(T))}function A(T){return a=void 0,h&&n?g(T):(n=i=void 0,o)}function _(){a!==void 0&&clearTimeout(a),c=0,n=l=i=a=void 0}function x(){return a===void 0?o:A(Kr())}function v(){var T=Kr(),C=y(T);if(n=arguments,i=this,l=T,C){if(a===void 0)return p(l);if(f)return clearTimeout(a),a=setTimeout(E,e),g(l)}return a===void 0&&(a=setTimeout(E,e)),o}return v.cancel=_,v.flush=x,v}function $n(r){for(var e=-1,t=r==null?0:r.length,n={};++e<t;){var i=r[e];n[i[0]]=i[1]}return n}function kt(r){return r==null}function Wc(r){return r===void 0}const Ln=r=>r===void 0,Yt=r=>typeof r=="boolean",Ne=r=>typeof r=="number",er=r=>typeof Element>"u"?!1:r instanceof Element,Qc=r=>ut(r)?!Number.isNaN(Number(r)):!1;class Us extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function Vs(r,e){throw new Us(`[${r}] ${e}`)}function He(r,e){if(process.env.NODE_ENV!=="production"){const t=ut(r)?new Us(`[${r}] ${e}`):r;console.warn(t)}}const Jc="utils/dom/style";function Gr(r,e="px"){if(!r)return"";if(Ne(r)||Qc(r))return`${r}${e}`;if(ut(r))return r;He(Jc,"binding value must be a string or number")}/*! Element Plus Icons Vue v2.1.0 */var Dt=(r,e)=>{let t=r.__vccOpts||r;for(let[n,i]of e)t[n]=i;return t},Yc={name:"ArrowDown"},zc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},qc=u.createElementVNode("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1),Zc=[qc];function Xc(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",zc,Zc)}var $c=Dt(Yc,[["render",Xc],["__file","arrow-down.vue"]]),ed={name:"ArrowUp"},td={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},nd=u.createElementVNode("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0z"},null,-1),rd=[nd];function id(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",td,rd)}var sd=Dt(ed,[["render",id],["__file","arrow-up.vue"]]),od={name:"CircleCheck"},ad={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ld=u.createElementVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),ud=u.createElementVNode("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1),cd=[ld,ud];function dd(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",ad,cd)}var fd=Dt(od,[["render",dd],["__file","circle-check.vue"]]),hd={name:"CircleClose"},pd={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},gd=u.createElementVNode("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),md=u.createElementVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),yd=[gd,md];function Ed(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",pd,yd)}var Ks=Dt(hd,[["render",Ed],["__file","circle-close.vue"]]),vd={name:"Hide"},Ad={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_d=u.createElementVNode("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"},null,-1),xd=u.createElementVNode("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"},null,-1),Sd=[_d,xd];function Td(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",Ad,Sd)}var Id=Dt(vd,[["render",Td],["__file","hide.vue"]]),bd={name:"Loading"},Cd={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ld=u.createElementVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),Rd=[Ld];function wd(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",Cd,Rd)}var Gs=Dt(bd,[["render",wd],["__file","loading.vue"]]),kd={name:"Minus"},Dd={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Od=u.createElementVNode("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"},null,-1),Pd=[Od];function Bd(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",Dd,Pd)}var Md=Dt(kd,[["render",Bd],["__file","minus.vue"]]),Fd={name:"Plus"},Nd={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ud=u.createElementVNode("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),Vd=[Ud];function Kd(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",Nd,Vd)}var Gd=Dt(Fd,[["render",Kd],["__file","plus.vue"]]),jd={name:"View"},Hd={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Wd=u.createElementVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),Qd=[Wd];function Jd(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("svg",Hd,Qd)}var Yd=Dt(jd,[["render",Jd],["__file","view.vue"]]);const js="__epPropKey",ge=r=>r,zd=r=>rn(r)&&!!r[js],tr=(r,e)=>{if(!rn(r)||zd(r))return r;const{values:t,required:n,default:i,type:s,validator:o}=r,l={type:s,required:!!n,validator:t||o?c=>{let d=!1,f=[];if(t&&(f=Array.from(t),Is(r,"default")&&f.push(i),d||(d=f.includes(c))),o&&(d||(d=o(c))),!d&&f.length>0){const h=[...new Set(f)].map(g=>JSON.stringify(g)).join(", ");u.warn(`Invalid prop: validation failed${e?` for prop "${e}"`:""}. Expected one of [${h}], got value ${JSON.stringify(c)}.`)}return d}:void 0,[js]:!0};return Is(r,"default")&&(l.default=i),l},Ue=r=>$n(Object.entries(r).map(([e,t])=>[e,tr(t,e)])),Rn=ge([String,Object,Function]),qd={validating:Gs,success:fd,error:Ks},Vt=(r,e)=>{if(r.install=t=>{for(const n of[r,...Object.values(e??{})])t.component(n.name,n)},e)for(const[t,n]of Object.entries(e))r[t]=n;return r},Zd=(r,e)=>(r.install=t=>{t.directive(e,r)},r),wn={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},qe="update:modelValue",zt="change",It="input",Hs=["","default","small","large"],Xd=r=>["",...Hs].includes(r),$d=r=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(r),ef=r=>r,tf=["class","style"],nf=/^on[A-Z]/,rf=(r={})=>{const{excludeListeners:e=!1,excludeKeys:t}=r,n=u.computed(()=>((t==null?void 0:t.value)||[]).concat(tf)),i=u.getCurrentInstance();return i?u.computed(()=>{var s;return $n(Object.entries((s=i.proxy)==null?void 0:s.$attrs).filter(([o])=>!n.value.includes(o)&&!(e&&nf.test(o))))}):(He("use-attrs","getCurrentInstance() returned null. useAttrs() must be called at the top of a setup function"),u.computed(()=>({})))},sf=({from:r,replacement:e,scope:t,version:n,ref:i,type:s="API"},o)=>{u.watch(()=>u.unref(o),a=>{a&&He(t,`[${s}] ${r} is about to be deprecated in version ${n}, please use ${e} instead.
For more detail, please visit: ${i}
`)},{immediate:!0})};var of={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const af=r=>(e,t)=>lf(e,t,u.unref(r)),lf=(r,e,t)=>Vc(t,r,r).replace(/\{(\w+)\}/g,(n,i)=>{var s;return`${(s=e==null?void 0:e[i])!=null?s:`{${i}}`}`}),uf=r=>{const e=u.computed(()=>u.unref(r).name),t=u.isRef(r)?r:u.ref(r);return{lang:e,locale:t,t:af(r)}},cf=Symbol("localeContextKey"),Ws=r=>{const e=r||u.inject(cf,u.ref());return uf(u.computed(()=>e.value||of))},Qs="el",df="is-",qt=(r,e,t,n,i)=>{let s=`${r}-${e}`;return t&&(s+=`-${t}`),n&&(s+=`__${n}`),i&&(s+=`--${i}`),s},ff=Symbol("namespaceContextKey"),jr=r=>{const e=r||u.inject(ff,u.ref(Qs));return u.computed(()=>u.unref(e)||Qs)},$e=(r,e)=>{const t=jr(e);return{namespace:t,b:(m="")=>qt(t.value,r,m,"",""),e:m=>m?qt(t.value,r,"",m,""):"",m:m=>m?qt(t.value,r,"","",m):"",be:(m,y)=>m&&y?qt(t.value,r,m,y,""):"",em:(m,y)=>m&&y?qt(t.value,r,"",m,y):"",bm:(m,y)=>m&&y?qt(t.value,r,m,"",y):"",bem:(m,y,E)=>m&&y&&E?qt(t.value,r,m,y,E):"",is:(m,...y)=>{const E=y.length>=1?y[0]:!0;return m&&E?`${df}${m}`:""},cssVar:m=>{const y={};for(const E in m)m[E]&&(y[`--${t.value}-${E}`]=m[E]);return y},cssVarName:m=>`--${t.value}-${m}`,cssVarBlock:m=>{const y={};for(const E in m)m[E]&&(y[`--${t.value}-${r}-${E}`]=m[E]);return y},cssVarBlockName:m=>`--${t.value}-${r}-${m}`}},hf=tr({type:ge(Boolean),default:null}),pf=tr({type:ge(Function)}),Js=r=>{const e=`update:${r}`,t=`onUpdate:${r}`,n=[e],i={[r]:hf,[t]:pf};return{useModelToggle:({indicator:o,toggleReason:a,shouldHideWhenRouteChanges:l,shouldProceed:c,onShow:d,onHide:f})=>{const h=u.getCurrentInstance(),{emit:g}=h,p=h.props,m=u.computed(()=>Ut(p[t])),y=u.computed(()=>p[r]===null),E=C=>{o.value!==!0&&(o.value=!0,a&&(a.value=C),Ut(d)&&d(C))},A=C=>{o.value!==!1&&(o.value=!1,a&&(a.value=C),Ut(f)&&f(C))},_=C=>{if(p.disabled===!0||Ut(c)&&!c())return;const k=m.value&&ct;k&&g(e,!0),(y.value||!k)&&E(C)},x=C=>{if(p.disabled===!0||!ct)return;const k=m.value&&ct;k&&g(e,!1),(y.value||!k)&&A(C)},v=C=>{Yt(C)&&(p.disabled&&C?m.value&&g(e,!1):o.value!==C&&(C?E():A()))},T=()=>{o.value?x():_()};return u.watch(()=>p[r],v),l&&h.appContext.config.globalProperties.$route!==void 0&&u.watch(()=>({...h.proxy.$route}),()=>{l.value&&o.value&&x()}),u.onMounted(()=>{v(p[r])}),{hide:x,show:_,toggle:T,hasUpdateHandler:m}},useModelToggleProps:i,useModelToggleEmits:n}};Js("modelValue");const Ys=r=>{const e=u.getCurrentInstance();return u.computed(()=>{var t,n;return(n=(t=e==null?void 0:e.proxy)==null?void 0:t.$props)==null?void 0:n[r]})};var et="top",dt="bottom",ft="right",tt="left",Hr="auto",kn=[et,dt,ft,tt],an="start",Dn="end",gf="clippingParents",zs="viewport",On="popper",mf="reference",qs=kn.reduce(function(r,e){return r.concat([e+"-"+an,e+"-"+Dn])},[]),Pn=[].concat(kn,[Hr]).reduce(function(r,e){return r.concat([e,e+"-"+an,e+"-"+Dn])},[]),yf="beforeRead",Ef="read",vf="afterRead",Af="beforeMain",_f="main",xf="afterMain",Sf="beforeWrite",Tf="write",If="afterWrite",bf=[yf,Ef,vf,Af,_f,xf,Sf,Tf,If];function bt(r){return r?(r.nodeName||"").toLowerCase():null}function yt(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var e=r.ownerDocument;return e&&e.defaultView||window}return r}function ln(r){var e=yt(r).Element;return r instanceof e||r instanceof Element}function ht(r){var e=yt(r).HTMLElement;return r instanceof e||r instanceof HTMLElement}function Wr(r){if(typeof ShadowRoot>"u")return!1;var e=yt(r).ShadowRoot;return r instanceof e||r instanceof ShadowRoot}function Cf(r){var e=r.state;Object.keys(e.elements).forEach(function(t){var n=e.styles[t]||{},i=e.attributes[t]||{},s=e.elements[t];!ht(s)||!bt(s)||(Object.assign(s.style,n),Object.keys(i).forEach(function(o){var a=i[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function Lf(r){var e=r.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],s=e.attributes[n]||{},o=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:t[n]),a=o.reduce(function(l,c){return l[c]="",l},{});!ht(i)||!bt(i)||(Object.assign(i.style,a),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}var Zs={name:"applyStyles",enabled:!0,phase:"write",fn:Cf,effect:Lf,requires:["computeStyles"]};function Ct(r){return r.split("-")[0]}var Zt=Math.max,nr=Math.min,un=Math.round;function cn(r,e){e===void 0&&(e=!1);var t=r.getBoundingClientRect(),n=1,i=1;if(ht(r)&&e){var s=r.offsetHeight,o=r.offsetWidth;o>0&&(n=un(t.width)/o||1),s>0&&(i=un(t.height)/s||1)}return{width:t.width/n,height:t.height/i,top:t.top/i,right:t.right/n,bottom:t.bottom/i,left:t.left/n,x:t.left/n,y:t.top/i}}function Qr(r){var e=cn(r),t=r.offsetWidth,n=r.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:r.offsetLeft,y:r.offsetTop,width:t,height:n}}function Xs(r,e){var t=e.getRootNode&&e.getRootNode();if(r.contains(e))return!0;if(t&&Wr(t)){var n=e;do{if(n&&r.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Ot(r){return yt(r).getComputedStyle(r)}function Rf(r){return["table","td","th"].indexOf(bt(r))>=0}function Kt(r){return((ln(r)?r.ownerDocument:r.document)||window.document).documentElement}function rr(r){return bt(r)==="html"?r:r.assignedSlot||r.parentNode||(Wr(r)?r.host:null)||Kt(r)}function $s(r){return!ht(r)||Ot(r).position==="fixed"?null:r.offsetParent}function wf(r){var e=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,t=navigator.userAgent.indexOf("Trident")!==-1;if(t&&ht(r)){var n=Ot(r);if(n.position==="fixed")return null}var i=rr(r);for(Wr(i)&&(i=i.host);ht(i)&&["html","body"].indexOf(bt(i))<0;){var s=Ot(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function Bn(r){for(var e=yt(r),t=$s(r);t&&Rf(t)&&Ot(t).position==="static";)t=$s(t);return t&&(bt(t)==="html"||bt(t)==="body"&&Ot(t).position==="static")?e:t||wf(r)||e}function Jr(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function Mn(r,e,t){return Zt(r,nr(e,t))}function kf(r,e,t){var n=Mn(r,e,t);return n>t?t:n}function eo(){return{top:0,right:0,bottom:0,left:0}}function to(r){return Object.assign({},eo(),r)}function no(r,e){return e.reduce(function(t,n){return t[n]=r,t},{})}var Df=function(r,e){return r=typeof r=="function"?r(Object.assign({},e.rects,{placement:e.placement})):r,to(typeof r!="number"?r:no(r,kn))};function Of(r){var e,t=r.state,n=r.name,i=r.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=Ct(t.placement),l=Jr(a),c=[tt,ft].indexOf(a)>=0,d=c?"height":"width";if(!(!s||!o)){var f=Df(i.padding,t),h=Qr(s),g=l==="y"?et:tt,p=l==="y"?dt:ft,m=t.rects.reference[d]+t.rects.reference[l]-o[l]-t.rects.popper[d],y=o[l]-t.rects.reference[l],E=Bn(s),A=E?l==="y"?E.clientHeight||0:E.clientWidth||0:0,_=m/2-y/2,x=f[g],v=A-h[d]-f[p],T=A/2-h[d]/2+_,C=Mn(x,T,v),k=l;t.modifiersData[n]=(e={},e[k]=C,e.centerOffset=C-T,e)}}function Pf(r){var e=r.state,t=r.options,n=t.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||!Xs(e.elements.popper,i)||(e.elements.arrow=i))}var Bf={name:"arrow",enabled:!0,phase:"main",fn:Of,effect:Pf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function dn(r){return r.split("-")[1]}var Mf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ff(r){var e=r.x,t=r.y,n=window,i=n.devicePixelRatio||1;return{x:un(e*i)/i||0,y:un(t*i)/i||0}}function ro(r){var e,t=r.popper,n=r.popperRect,i=r.placement,s=r.variation,o=r.offsets,a=r.position,l=r.gpuAcceleration,c=r.adaptive,d=r.roundOffsets,f=r.isFixed,h=o.x,g=h===void 0?0:h,p=o.y,m=p===void 0?0:p,y=typeof d=="function"?d({x:g,y:m}):{x:g,y:m};g=y.x,m=y.y;var E=o.hasOwnProperty("x"),A=o.hasOwnProperty("y"),_=tt,x=et,v=window;if(c){var T=Bn(t),C="clientHeight",k="clientWidth";if(T===yt(t)&&(T=Kt(t),Ot(T).position!=="static"&&a==="absolute"&&(C="scrollHeight",k="scrollWidth")),T=T,i===et||(i===tt||i===ft)&&s===Dn){x=dt;var B=f&&T===v&&v.visualViewport?v.visualViewport.height:T[C];m-=B-n.height,m*=l?1:-1}if(i===tt||(i===et||i===dt)&&s===Dn){_=ft;var R=f&&T===v&&v.visualViewport?v.visualViewport.width:T[k];g-=R-n.width,g*=l?1:-1}}var I=Object.assign({position:a},c&&Mf),S=d===!0?Ff({x:g,y:m}):{x:g,y:m};if(g=S.x,m=S.y,l){var L;return Object.assign({},I,(L={},L[x]=A?"0":"",L[_]=E?"0":"",L.transform=(v.devicePixelRatio||1)<=1?"translate("+g+"px, "+m+"px)":"translate3d("+g+"px, "+m+"px, 0)",L))}return Object.assign({},I,(e={},e[x]=A?m+"px":"",e[_]=E?g+"px":"",e.transform="",e))}function Nf(r){var e=r.state,t=r.options,n=t.gpuAcceleration,i=n===void 0?!0:n,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:Ct(e.placement),variation:dn(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,ro(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,ro(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var io={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nf,data:{}},ir={passive:!0};function Uf(r){var e=r.state,t=r.instance,n=r.options,i=n.scroll,s=i===void 0?!0:i,o=n.resize,a=o===void 0?!0:o,l=yt(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(d){d.addEventListener("scroll",t.update,ir)}),a&&l.addEventListener("resize",t.update,ir),function(){s&&c.forEach(function(d){d.removeEventListener("scroll",t.update,ir)}),a&&l.removeEventListener("resize",t.update,ir)}}var so={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Uf,data:{}},Vf={left:"right",right:"left",bottom:"top",top:"bottom"};function sr(r){return r.replace(/left|right|bottom|top/g,function(e){return Vf[e]})}var Kf={start:"end",end:"start"};function oo(r){return r.replace(/start|end/g,function(e){return Kf[e]})}function Yr(r){var e=yt(r),t=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:t,scrollTop:n}}function zr(r){return cn(Kt(r)).left+Yr(r).scrollLeft}function Gf(r){var e=yt(r),t=Kt(r),n=e.visualViewport,i=t.clientWidth,s=t.clientHeight,o=0,a=0;return n&&(i=n.width,s=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=n.offsetLeft,a=n.offsetTop)),{width:i,height:s,x:o+zr(r),y:a}}function jf(r){var e,t=Kt(r),n=Yr(r),i=(e=r.ownerDocument)==null?void 0:e.body,s=Zt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Zt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-n.scrollLeft+zr(r),l=-n.scrollTop;return Ot(i||t).direction==="rtl"&&(a+=Zt(t.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function qr(r){var e=Ot(r),t=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+n)}function ao(r){return["html","body","#document"].indexOf(bt(r))>=0?r.ownerDocument.body:ht(r)&&qr(r)?r:ao(rr(r))}function Fn(r,e){var t;e===void 0&&(e=[]);var n=ao(r),i=n===((t=r.ownerDocument)==null?void 0:t.body),s=yt(n),o=i?[s].concat(s.visualViewport||[],qr(n)?n:[]):n,a=e.concat(o);return i?a:a.concat(Fn(rr(o)))}function Zr(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function Hf(r){var e=cn(r);return e.top=e.top+r.clientTop,e.left=e.left+r.clientLeft,e.bottom=e.top+r.clientHeight,e.right=e.left+r.clientWidth,e.width=r.clientWidth,e.height=r.clientHeight,e.x=e.left,e.y=e.top,e}function lo(r,e){return e===zs?Zr(Gf(r)):ln(e)?Hf(e):Zr(jf(Kt(r)))}function Wf(r){var e=Fn(rr(r)),t=["absolute","fixed"].indexOf(Ot(r).position)>=0,n=t&&ht(r)?Bn(r):r;return ln(n)?e.filter(function(i){return ln(i)&&Xs(i,n)&&bt(i)!=="body"}):[]}function Qf(r,e,t){var n=e==="clippingParents"?Wf(r):[].concat(e),i=[].concat(n,[t]),s=i[0],o=i.reduce(function(a,l){var c=lo(r,l);return a.top=Zt(c.top,a.top),a.right=nr(c.right,a.right),a.bottom=nr(c.bottom,a.bottom),a.left=Zt(c.left,a.left),a},lo(r,s));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function uo(r){var e=r.reference,t=r.element,n=r.placement,i=n?Ct(n):null,s=n?dn(n):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(i){case et:l={x:o,y:e.y-t.height};break;case dt:l={x:o,y:e.y+e.height};break;case ft:l={x:e.x+e.width,y:a};break;case tt:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?Jr(i):null;if(c!=null){var d=c==="y"?"height":"width";switch(s){case an:l[c]=l[c]-(e[d]/2-t[d]/2);break;case Dn:l[c]=l[c]+(e[d]/2-t[d]/2);break}}return l}function Nn(r,e){e===void 0&&(e={});var t=e,n=t.placement,i=n===void 0?r.placement:n,s=t.boundary,o=s===void 0?gf:s,a=t.rootBoundary,l=a===void 0?zs:a,c=t.elementContext,d=c===void 0?On:c,f=t.altBoundary,h=f===void 0?!1:f,g=t.padding,p=g===void 0?0:g,m=to(typeof p!="number"?p:no(p,kn)),y=d===On?mf:On,E=r.rects.popper,A=r.elements[h?y:d],_=Qf(ln(A)?A:A.contextElement||Kt(r.elements.popper),o,l),x=cn(r.elements.reference),v=uo({reference:x,element:E,strategy:"absolute",placement:i}),T=Zr(Object.assign({},E,v)),C=d===On?T:x,k={top:_.top-C.top+m.top,bottom:C.bottom-_.bottom+m.bottom,left:_.left-C.left+m.left,right:C.right-_.right+m.right},B=r.modifiersData.offset;if(d===On&&B){var R=B[i];Object.keys(k).forEach(function(I){var S=[ft,dt].indexOf(I)>=0?1:-1,L=[et,dt].indexOf(I)>=0?"y":"x";k[I]+=R[L]*S})}return k}function Jf(r,e){e===void 0&&(e={});var t=e,n=t.placement,i=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?Pn:l,d=dn(n),f=d?a?qs:qs.filter(function(p){return dn(p)===d}):kn,h=f.filter(function(p){return c.indexOf(p)>=0});h.length===0&&(h=f);var g=h.reduce(function(p,m){return p[m]=Nn(r,{placement:m,boundary:i,rootBoundary:s,padding:o})[Ct(m)],p},{});return Object.keys(g).sort(function(p,m){return g[p]-g[m]})}function Yf(r){if(Ct(r)===Hr)return[];var e=sr(r);return[oo(r),e,oo(e)]}function zf(r){var e=r.state,t=r.options,n=r.name;if(!e.modifiersData[n]._skip){for(var i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,c=t.padding,d=t.boundary,f=t.rootBoundary,h=t.altBoundary,g=t.flipVariations,p=g===void 0?!0:g,m=t.allowedAutoPlacements,y=e.options.placement,E=Ct(y),A=E===y,_=l||(A||!p?[sr(y)]:Yf(y)),x=[y].concat(_).reduce(function(H,Z){return H.concat(Ct(Z)===Hr?Jf(e,{placement:Z,boundary:d,rootBoundary:f,padding:c,flipVariations:p,allowedAutoPlacements:m}):Z)},[]),v=e.rects.reference,T=e.rects.popper,C=new Map,k=!0,B=x[0],R=0;R<x.length;R++){var I=x[R],S=Ct(I),L=dn(I)===an,b=[et,dt].indexOf(S)>=0,w=b?"width":"height",M=Nn(e,{placement:I,boundary:d,rootBoundary:f,altBoundary:h,padding:c}),O=b?L?ft:tt:L?dt:et;v[w]>T[w]&&(O=sr(O));var D=sr(O),F=[];if(s&&F.push(M[S]<=0),a&&F.push(M[O]<=0,M[D]<=0),F.every(function(H){return H})){B=I,k=!1;break}C.set(I,F)}if(k)for(var U=p?3:1,K=function(H){var Z=x.find(function(J){var X=C.get(J);if(X)return X.slice(0,H).every(function(ne){return ne})});if(Z)return B=Z,"break"},N=U;N>0;N--){var G=K(N);if(G==="break")break}e.placement!==B&&(e.modifiersData[n]._skip=!0,e.placement=B,e.reset=!0)}}var qf={name:"flip",enabled:!0,phase:"main",fn:zf,requiresIfExists:["offset"],data:{_skip:!1}};function co(r,e,t){return t===void 0&&(t={x:0,y:0}),{top:r.top-e.height-t.y,right:r.right-e.width+t.x,bottom:r.bottom-e.height+t.y,left:r.left-e.width-t.x}}function fo(r){return[et,ft,dt,tt].some(function(e){return r[e]>=0})}function Zf(r){var e=r.state,t=r.name,n=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=Nn(e,{elementContext:"reference"}),a=Nn(e,{altBoundary:!0}),l=co(o,n),c=co(a,i,s),d=fo(l),f=fo(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":f})}var Xf={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Zf};function $f(r,e,t){var n=Ct(r),i=[tt,et].indexOf(n)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:r})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[tt,ft].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}function eh(r){var e=r.state,t=r.options,n=r.name,i=t.offset,s=i===void 0?[0,0]:i,o=Pn.reduce(function(d,f){return d[f]=$f(f,e.rects,s),d},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=o}var th={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:eh};function nh(r){var e=r.state,t=r.name;e.modifiersData[t]=uo({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var ho={name:"popperOffsets",enabled:!0,phase:"read",fn:nh,data:{}};function rh(r){return r==="x"?"y":"x"}function ih(r){var e=r.state,t=r.options,n=r.name,i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,c=t.rootBoundary,d=t.altBoundary,f=t.padding,h=t.tether,g=h===void 0?!0:h,p=t.tetherOffset,m=p===void 0?0:p,y=Nn(e,{boundary:l,rootBoundary:c,padding:f,altBoundary:d}),E=Ct(e.placement),A=dn(e.placement),_=!A,x=Jr(E),v=rh(x),T=e.modifiersData.popperOffsets,C=e.rects.reference,k=e.rects.popper,B=typeof m=="function"?m(Object.assign({},e.rects,{placement:e.placement})):m,R=typeof B=="number"?{mainAxis:B,altAxis:B}:Object.assign({mainAxis:0,altAxis:0},B),I=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,S={x:0,y:0};if(T){if(s){var L,b=x==="y"?et:tt,w=x==="y"?dt:ft,M=x==="y"?"height":"width",O=T[x],D=O+y[b],F=O-y[w],U=g?-k[M]/2:0,K=A===an?C[M]:k[M],N=A===an?-k[M]:-C[M],G=e.elements.arrow,H=g&&G?Qr(G):{width:0,height:0},Z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:eo(),J=Z[b],X=Z[w],ne=Mn(0,C[M],H[M]),ce=_?C[M]/2-U-ne-J-R.mainAxis:K-ne-J-R.mainAxis,re=_?-C[M]/2+U+ne+X+R.mainAxis:N+ne+X+R.mainAxis,Ee=e.elements.arrow&&Bn(e.elements.arrow),se=Ee?x==="y"?Ee.clientTop||0:Ee.clientLeft||0:0,ee=(L=I==null?void 0:I[x])!=null?L:0,he=O+ce-ee-se,_e=O+re-ee,ke=Mn(g?nr(D,he):D,O,g?Zt(F,_e):F);T[x]=ke,S[x]=ke-O}if(a){var De,we=x==="x"?et:tt,Ie=x==="x"?dt:ft,ve=T[v],Ce=v==="y"?"height":"width",Re=ve+y[we],je=ve-y[Ie],z=[et,tt].indexOf(E)!==-1,Ae=(De=I==null?void 0:I[v])!=null?De:0,Me=z?Re:ve-C[Ce]-k[Ce]-Ae+R.altAxis,Ze=z?ve+C[Ce]+k[Ce]-Ae-R.altAxis:je,Fe=g&&z?kf(Me,ve,Ze):Mn(g?Me:Re,ve,g?Ze:je);T[v]=Fe,S[v]=Fe-ve}e.modifiersData[n]=S}}var sh={name:"preventOverflow",enabled:!0,phase:"main",fn:ih,requiresIfExists:["offset"]};function oh(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function ah(r){return r===yt(r)||!ht(r)?Yr(r):oh(r)}function lh(r){var e=r.getBoundingClientRect(),t=un(e.width)/r.offsetWidth||1,n=un(e.height)/r.offsetHeight||1;return t!==1||n!==1}function uh(r,e,t){t===void 0&&(t=!1);var n=ht(e),i=ht(e)&&lh(e),s=Kt(e),o=cn(r,i),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!t)&&((bt(e)!=="body"||qr(s))&&(a=ah(e)),ht(e)?(l=cn(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=zr(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function ch(r){var e=new Map,t=new Set,n=[];r.forEach(function(s){e.set(s.name,s)});function i(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&i(l)}}),n.push(s)}return r.forEach(function(s){t.has(s.name)||i(s)}),n}function dh(r){var e=ch(r);return bf.reduce(function(t,n){return t.concat(e.filter(function(i){return i.phase===n}))},[])}function fh(r){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(r())})})),e}}function hh(r){var e=r.reduce(function(t,n){var i=t[n.name];return t[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,t},{});return Object.keys(e).map(function(t){return e[t]})}var po={placement:"bottom",modifiers:[],strategy:"absolute"};function go(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Xr(r){r===void 0&&(r={});var e=r,t=e.defaultModifiers,n=t===void 0?[]:t,i=e.defaultOptions,s=i===void 0?po:i;return function(o,a,l){l===void 0&&(l=s);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},po,s),modifiersData:{},elements:{reference:o,popper:a},attributes:{},styles:{}},d=[],f=!1,h={state:c,setOptions:function(m){var y=typeof m=="function"?m(c.options):m;p(),c.options=Object.assign({},s,c.options,y),c.scrollParents={reference:ln(o)?Fn(o):o.contextElement?Fn(o.contextElement):[],popper:Fn(a)};var E=dh(hh([].concat(n,c.options.modifiers)));return c.orderedModifiers=E.filter(function(A){return A.enabled}),g(),h.update()},forceUpdate:function(){if(!f){var m=c.elements,y=m.reference,E=m.popper;if(go(y,E)){c.rects={reference:uh(y,Bn(E),c.options.strategy==="fixed"),popper:Qr(E)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(k){return c.modifiersData[k.name]=Object.assign({},k.data)});for(var A=0;A<c.orderedModifiers.length;A++){if(c.reset===!0){c.reset=!1,A=-1;continue}var _=c.orderedModifiers[A],x=_.fn,v=_.options,T=v===void 0?{}:v,C=_.name;typeof x=="function"&&(c=x({state:c,options:T,name:C,instance:h})||c)}}}},update:fh(function(){return new Promise(function(m){h.forceUpdate(),m(c)})}),destroy:function(){p(),f=!0}};if(!go(o,a))return h;h.setOptions(l).then(function(m){!f&&l.onFirstUpdate&&l.onFirstUpdate(m)});function g(){c.orderedModifiers.forEach(function(m){var y=m.name,E=m.options,A=E===void 0?{}:E,_=m.effect;if(typeof _=="function"){var x=_({state:c,name:y,instance:h,options:A}),v=function(){};d.push(x||v)}})}function p(){d.forEach(function(m){return m()}),d=[]}return h}}Xr();var ph=[so,ho,io,Zs];Xr({defaultModifiers:ph});var gh=[so,ho,io,Zs,th,qf,sh,Bf,Xf],mh=Xr({defaultModifiers:gh});const yh=(r,e,t={})=>{const n={name:"updateState",enabled:!0,phase:"write",fn:({state:l})=>{const c=Eh(l);Object.assign(o.value,c)},requires:["computeStyles"]},i=u.computed(()=>{const{onFirstUpdate:l,placement:c,strategy:d,modifiers:f}=u.unref(t);return{onFirstUpdate:l,placement:c||"bottom",strategy:d||"absolute",modifiers:[...f||[],n,{name:"applyStyles",enabled:!1}]}}),s=u.shallowRef(),o=u.ref({styles:{popper:{position:u.unref(i).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),a=()=>{s.value&&(s.value.destroy(),s.value=void 0)};return u.watch(i,l=>{const c=u.unref(s);c&&c.setOptions(l)},{deep:!0}),u.watch([r,e],([l,c])=>{a(),!(!l||!c)&&(s.value=mh(l,c,u.unref(i)))}),u.onBeforeUnmount(()=>{a()}),{state:u.computed(()=>{var l;return{...((l=u.unref(s))==null?void 0:l.state)||{}}}),styles:u.computed(()=>u.unref(o).styles),attributes:u.computed(()=>u.unref(o).attributes),update:()=>{var l;return(l=u.unref(s))==null?void 0:l.update()},forceUpdate:()=>{var l;return(l=u.unref(s))==null?void 0:l.forceUpdate()},instanceRef:u.computed(()=>u.unref(s))}};function Eh(r){const e=Object.keys(r.elements),t=$n(e.map(i=>[i,r.styles[i]||{}])),n=$n(e.map(i=>[i,r.attributes[i]]));return{styles:t,attributes:n}}function mo(){let r;const e=(n,i)=>{t(),r=window.setTimeout(n,i)},t=()=>window.clearTimeout(r);return Mr(()=>t()),{registerTimeout:e,cancelTimeout:t}}const $r={prefix:Math.floor(Math.random()*1e4),current:0},vh=Symbol("elIdInjection"),yo=()=>u.getCurrentInstance()?u.inject(vh,$r):$r,Eo=r=>{const e=yo();!ct&&e===$r&&He("IdInjection",`Looks like you are using server rendering, you must provide a id provider to ensure the hydration process to be succeed
usage: app.provide(ID_INJECTION_KEY, {
  prefix: number,
  current: number,
})`);const t=jr();return u.computed(()=>u.unref(r)||`${t.value}-id-${e.prefix}-${e.current++}`)};let fn=[];const vo=r=>{const e=r;e.key===wn.esc&&fn.forEach(t=>t(e))},Ah=r=>{u.onMounted(()=>{fn.length===0&&document.addEventListener("keydown",vo),ct&&fn.push(r)}),u.onBeforeUnmount(()=>{fn=fn.filter(e=>e!==r),fn.length===0&&ct&&document.removeEventListener("keydown",vo)})};let Ao;const _o=()=>{const r=jr(),e=yo(),t=u.computed(()=>`${r.value}-popper-container-${e.prefix}`),n=u.computed(()=>`#${t.value}`);return{id:t,selector:n}},_h=r=>{const e=document.createElement("div");return e.id=r,document.body.appendChild(e),e},xh=()=>{const{id:r,selector:e}=_o();return u.onBeforeMount(()=>{ct&&(process.env.NODE_ENV==="test"||!Ao&&!document.body.querySelector(e.value))&&(Ao=_h(r.value))}),{id:r,selector:e}},Sh=Ue({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),Th=({showAfter:r,hideAfter:e,autoClose:t,open:n,close:i})=>{const{registerTimeout:s}=mo(),{registerTimeout:o,cancelTimeout:a}=mo();return{onOpen:d=>{s(()=>{n(d);const f=u.unref(t);Ne(f)&&f>0&&o(()=>{i(d)},f)},u.unref(r))},onClose:d=>{a(),s(()=>{i(d)},u.unref(e))}}},xo=Symbol("elForwardRef"),Ih=r=>{const e=t=>{r.value=t};u.provide(xo,{setForwardRef:e})},bh=r=>({mounted(e){r(e)},updated(e){r(e)},unmounted(){r(null)}}),So=u.ref(0),Ch=2e3,Lh=Symbol("zIndexContextKey"),Rh=r=>{const e=r||u.inject(Lh,void 0),t=u.computed(()=>{const s=u.unref(e);return Ne(s)?s:Ch}),n=u.computed(()=>t.value+So.value);return{initialZIndex:t,currentZIndex:n,nextZIndex:()=>(So.value++,n.value)}};function wh(r){const e=u.ref();function t(){if(r.value==null)return;const{selectionStart:i,selectionEnd:s,value:o}=r.value;if(i==null||s==null)return;const a=o.slice(0,Math.max(0,i)),l=o.slice(Math.max(0,s));e.value={selectionStart:i,selectionEnd:s,value:o,beforeTxt:a,afterTxt:l}}function n(){if(r.value==null||e.value==null)return;const{value:i}=r.value,{beforeTxt:s,afterTxt:o,selectionStart:a}=e.value;if(s==null||o==null||a==null)return;let l=i.length;if(i.endsWith(o))l=i.length-o.length;else if(i.startsWith(s))l=s.length;else{const c=s[a-1],d=i.indexOf(c,a-1);d!==-1&&(l=d+1)}r.value.setSelectionRange(l,l)}return[t,n]}const or=tr({type:String,values:Hs,required:!1}),kh=Symbol("size"),Dh=()=>{const r=u.inject(kh,{});return u.computed(()=>u.unref(r.size)||"")};var We=(r,e)=>{const t=r.__vccOpts||r;for(const[n,i]of e)t[n]=i;return t};const Oh=Ue({size:{type:ge([Number,String])},color:{type:String}}),Ph=u.defineComponent({name:"ElIcon",inheritAttrs:!1}),Bh=u.defineComponent({...Ph,props:Oh,setup(r){const e=r,t=$e("icon"),n=u.computed(()=>{const{size:i,color:s}=e;return!i&&!s?{}:{fontSize:Ln(i)?void 0:Gr(i),"--color":s}});return(i,s)=>(u.openBlock(),u.createElementBlock("i",u.mergeProps({class:u.unref(t).b(),style:u.unref(n)},i.$attrs),[u.renderSlot(i.$slots,"default")],16))}});var Mh=We(Bh,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const Et=Vt(Mh),ei=Symbol("formContextKey"),ar=Symbol("formItemContextKey"),lr=(r,e={})=>{const t=u.ref(void 0),n=e.prop?t:Ys("size"),i=e.global?t:Dh(),s=e.form?{size:void 0}:u.inject(ei,void 0),o=e.formItem?{size:void 0}:u.inject(ar,void 0);return u.computed(()=>n.value||u.unref(r)||(o==null?void 0:o.size)||(s==null?void 0:s.size)||i.value||"")},ti=r=>{const e=Ys("disabled"),t=u.inject(ei,void 0);return u.computed(()=>e.value||u.unref(r)||(t==null?void 0:t.disabled)||!1)},ur=()=>{const r=u.inject(ei,void 0),e=u.inject(ar,void 0);return{form:r,formItem:e}},ni=(r,{formItemContext:e,disableIdGeneration:t,disableIdManagement:n})=>{t||(t=u.ref(!1)),n||(n=u.ref(!1));const i=u.ref();let s;const o=u.computed(()=>{var a;return!!(!r.label&&e&&e.inputIds&&((a=e.inputIds)==null?void 0:a.length)<=1)});return u.onMounted(()=>{s=u.watch([u.toRef(r,"id"),t],([a,l])=>{const c=a??(l?void 0:Eo().value);c!==i.value&&(e!=null&&e.removeInputId&&(i.value&&e.removeInputId(i.value),!(n!=null&&n.value)&&!l&&c&&e.addInputId(c)),i.value=c)},{immediate:!0})}),u.onUnmounted(()=>{s&&s(),e!=null&&e.removeInputId&&i.value&&e.removeInputId(i.value)}),{isLabeledByFormItem:o,inputId:i}};let vt;const Fh=`
  height:0 !important;
  visibility:hidden !important;
  ${iu()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Nh=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Uh(r){const e=window.getComputedStyle(r),t=e.getPropertyValue("box-sizing"),n=Number.parseFloat(e.getPropertyValue("padding-bottom"))+Number.parseFloat(e.getPropertyValue("padding-top")),i=Number.parseFloat(e.getPropertyValue("border-bottom-width"))+Number.parseFloat(e.getPropertyValue("border-top-width"));return{contextStyle:Nh.map(o=>`${o}:${e.getPropertyValue(o)}`).join(";"),paddingSize:n,borderSize:i,boxSizing:t}}function To(r,e=1,t){var n;vt||(vt=document.createElement("textarea"),document.body.appendChild(vt));const{paddingSize:i,borderSize:s,boxSizing:o,contextStyle:a}=Uh(r);vt.setAttribute("style",`${a};${Fh}`),vt.value=r.value||r.placeholder||"";let l=vt.scrollHeight;const c={};o==="border-box"?l=l+s:o==="content-box"&&(l=l-i),vt.value="";const d=vt.scrollHeight-i;if(Ne(e)){let f=d*e;o==="border-box"&&(f=f+i+s),l=Math.max(f,l),c.minHeight=`${f}px`}if(Ne(t)){let f=d*t;o==="border-box"&&(f=f+i+s),l=Math.min(f,l)}return c.height=`${l}px`,(n=vt.parentNode)==null||n.removeChild(vt),vt=void 0,c}const Vh=Ue({id:{type:String,default:void 0},size:or,disabled:Boolean,modelValue:{type:ge([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:ge([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Rn},prefixIcon:{type:Rn},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:ge([Object,Array,String]),default:()=>ef({})}}),Kh={[qe]:r=>ut(r),input:r=>ut(r),change:r=>ut(r),focus:r=>r instanceof FocusEvent,blur:r=>r instanceof FocusEvent,clear:()=>!0,mouseleave:r=>r instanceof MouseEvent,mouseenter:r=>r instanceof MouseEvent,keydown:r=>r instanceof Event,compositionstart:r=>r instanceof CompositionEvent,compositionupdate:r=>r instanceof CompositionEvent,compositionend:r=>r instanceof CompositionEvent},Gh=["role"],jh=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],Hh=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],Wh=u.defineComponent({name:"ElInput",inheritAttrs:!1}),Qh=u.defineComponent({...Wh,props:Vh,emits:Kh,setup(r,{expose:e,emit:t}){const n=r,i=u.useAttrs(),s=u.useSlots(),o=u.computed(()=>{const z={};return n.containerRole==="combobox"&&(z["aria-haspopup"]=i["aria-haspopup"],z["aria-owns"]=i["aria-owns"],z["aria-expanded"]=i["aria-expanded"]),z}),a=u.computed(()=>[n.type==="textarea"?y.b():m.b(),m.m(g.value),m.is("disabled",p.value),m.is("exceed",K.value),{[m.b("group")]:s.prepend||s.append,[m.bm("group","append")]:s.append,[m.bm("group","prepend")]:s.prepend,[m.m("prefix")]:s.prefix||n.prefixIcon,[m.m("suffix")]:s.suffix||n.suffixIcon||n.clearable||n.showPassword,[m.bm("suffix","password-clear")]:O.value&&D.value},i.class]),l=u.computed(()=>[m.e("wrapper"),m.is("focus",_.value)]),c=rf({excludeKeys:u.computed(()=>Object.keys(o.value))}),{form:d,formItem:f}=ur(),{inputId:h}=ni(n,{formItemContext:f}),g=lr(),p=ti(),m=$e("input"),y=$e("textarea"),E=u.shallowRef(),A=u.shallowRef(),_=u.ref(!1),x=u.ref(!1),v=u.ref(!1),T=u.ref(!1),C=u.ref(),k=u.shallowRef(n.inputStyle),B=u.computed(()=>E.value||A.value),R=u.computed(()=>{var z;return(z=d==null?void 0:d.statusIcon)!=null?z:!1}),I=u.computed(()=>(f==null?void 0:f.validateState)||""),S=u.computed(()=>I.value&&qd[I.value]),L=u.computed(()=>T.value?Yd:Id),b=u.computed(()=>[i.style,n.inputStyle]),w=u.computed(()=>[n.inputStyle,k.value,{resize:n.resize}]),M=u.computed(()=>kt(n.modelValue)?"":String(n.modelValue)),O=u.computed(()=>n.clearable&&!p.value&&!n.readonly&&!!M.value&&(_.value||x.value)),D=u.computed(()=>n.showPassword&&!p.value&&!n.readonly&&!!M.value&&(!!M.value||_.value)),F=u.computed(()=>n.showWordLimit&&!!c.value.maxlength&&(n.type==="text"||n.type==="textarea")&&!p.value&&!n.readonly&&!n.showPassword),U=u.computed(()=>M.value.length),K=u.computed(()=>!!F.value&&U.value>Number(c.value.maxlength)),N=u.computed(()=>!!s.suffix||!!n.suffixIcon||O.value||n.showPassword||F.value||!!I.value&&R.value),[G,H]=wh(E);$l(A,z=>{if(X(),!F.value||n.resize!=="both")return;const Ae=z[0],{width:Me}=Ae.contentRect;C.value={right:`calc(100% - ${Me+15+6}px)`}});const Z=()=>{const{type:z,autosize:Ae}=n;if(!(!ct||z!=="textarea"||!A.value))if(Ae){const Me=rn(Ae)?Ae.minRows:void 0,Ze=rn(Ae)?Ae.maxRows:void 0,Fe=To(A.value,Me,Ze);k.value={overflowY:"hidden",...Fe},u.nextTick(()=>{A.value.offsetHeight,k.value=Fe})}else k.value={minHeight:To(A.value).minHeight}},X=(z=>{let Ae=!1;return()=>{var Me;if(Ae||!n.autosize)return;((Me=A.value)==null?void 0:Me.offsetParent)===null||(z(),Ae=!0)}})(Z),ne=()=>{const z=B.value;!z||z.value===M.value||(z.value=M.value)},ce=async z=>{G();let{value:Ae}=z.target;if(n.formatter&&(Ae=n.parser?n.parser(Ae):Ae,Ae=n.formatter(Ae)),!v.value){if(Ae===M.value){ne();return}t(qe,Ae),t("input",Ae),await u.nextTick(),ne(),H()}},re=z=>{t("change",z.target.value)},Ee=z=>{t("compositionstart",z),v.value=!0},se=z=>{var Ae;t("compositionupdate",z);const Me=(Ae=z.target)==null?void 0:Ae.value,Ze=Me[Me.length-1]||"";v.value=!$d(Ze)},ee=z=>{t("compositionend",z),v.value&&(v.value=!1,ce(z))},he=()=>{T.value=!T.value,_e()},_e=async()=>{var z;await u.nextTick(),(z=B.value)==null||z.focus()},ke=()=>{var z;return(z=B.value)==null?void 0:z.blur()},De=z=>{_.value=!0,t("focus",z)},we=z=>{var Ae;_.value=!1,t("blur",z),n.validateEvent&&((Ae=f==null?void 0:f.validate)==null||Ae.call(f,"blur").catch(Me=>He(Me)))},Ie=z=>{x.value=!1,t("mouseleave",z)},ve=z=>{x.value=!0,t("mouseenter",z)},Ce=z=>{t("keydown",z)},Re=()=>{var z;(z=B.value)==null||z.select()},je=()=>{t(qe,""),t("change",""),t("clear"),t("input","")};return u.watch(()=>n.modelValue,()=>{var z;u.nextTick(()=>Z()),n.validateEvent&&((z=f==null?void 0:f.validate)==null||z.call(f,"change").catch(Ae=>He(Ae)))}),u.watch(M,()=>ne()),u.watch(()=>n.type,async()=>{await u.nextTick(),ne(),Z()}),u.onMounted(()=>{!n.formatter&&n.parser&&He("ElInput","If you set the parser, you also need to set the formatter."),ne(),u.nextTick(Z)}),e({input:E,textarea:A,ref:B,textareaStyle:w,autosize:u.toRef(n,"autosize"),focus:_e,blur:ke,select:Re,clear:je,resizeTextarea:Z}),(z,Ae)=>u.withDirectives((u.openBlock(),u.createElementBlock("div",u.mergeProps(u.unref(o),{class:u.unref(a),style:u.unref(b),role:z.containerRole,onMouseenter:ve,onMouseleave:Ie}),[u.createCommentVNode(" input "),z.type!=="textarea"?(u.openBlock(),u.createElementBlock(u.Fragment,{key:0},[u.createCommentVNode(" prepend slot "),z.$slots.prepend?(u.openBlock(),u.createElementBlock("div",{key:0,class:u.normalizeClass(u.unref(m).be("group","prepend"))},[u.renderSlot(z.$slots,"prepend")],2)):u.createCommentVNode("v-if",!0),u.createElementVNode("div",{class:u.normalizeClass(u.unref(l))},[u.createCommentVNode(" prefix slot "),z.$slots.prefix||z.prefixIcon?(u.openBlock(),u.createElementBlock("span",{key:0,class:u.normalizeClass(u.unref(m).e("prefix"))},[u.createElementVNode("span",{class:u.normalizeClass(u.unref(m).e("prefix-inner")),onClick:_e},[u.renderSlot(z.$slots,"prefix"),z.prefixIcon?(u.openBlock(),u.createBlock(u.unref(Et),{key:0,class:u.normalizeClass(u.unref(m).e("icon"))},{default:u.withCtx(()=>[(u.openBlock(),u.createBlock(u.resolveDynamicComponent(z.prefixIcon)))]),_:1},8,["class"])):u.createCommentVNode("v-if",!0)],2)],2)):u.createCommentVNode("v-if",!0),u.createElementVNode("input",u.mergeProps({id:u.unref(h),ref_key:"input",ref:E,class:u.unref(m).e("inner")},u.unref(c),{type:z.showPassword?T.value?"text":"password":z.type,disabled:u.unref(p),formatter:z.formatter,parser:z.parser,readonly:z.readonly,autocomplete:z.autocomplete,tabindex:z.tabindex,"aria-label":z.label,placeholder:z.placeholder,style:z.inputStyle,form:n.form,onCompositionstart:Ee,onCompositionupdate:se,onCompositionend:ee,onInput:ce,onFocus:De,onBlur:we,onChange:re,onKeydown:Ce}),null,16,jh),u.createCommentVNode(" suffix slot "),u.unref(N)?(u.openBlock(),u.createElementBlock("span",{key:1,class:u.normalizeClass(u.unref(m).e("suffix"))},[u.createElementVNode("span",{class:u.normalizeClass(u.unref(m).e("suffix-inner")),onClick:_e},[!u.unref(O)||!u.unref(D)||!u.unref(F)?(u.openBlock(),u.createElementBlock(u.Fragment,{key:0},[u.renderSlot(z.$slots,"suffix"),z.suffixIcon?(u.openBlock(),u.createBlock(u.unref(Et),{key:0,class:u.normalizeClass(u.unref(m).e("icon"))},{default:u.withCtx(()=>[(u.openBlock(),u.createBlock(u.resolveDynamicComponent(z.suffixIcon)))]),_:1},8,["class"])):u.createCommentVNode("v-if",!0)],64)):u.createCommentVNode("v-if",!0),u.unref(O)?(u.openBlock(),u.createBlock(u.unref(Et),{key:1,class:u.normalizeClass([u.unref(m).e("icon"),u.unref(m).e("clear")]),onMousedown:u.withModifiers(u.unref(Yn),["prevent"]),onClick:je},{default:u.withCtx(()=>[u.createVNode(u.unref(Ks))]),_:1},8,["class","onMousedown"])):u.createCommentVNode("v-if",!0),u.unref(D)?(u.openBlock(),u.createBlock(u.unref(Et),{key:2,class:u.normalizeClass([u.unref(m).e("icon"),u.unref(m).e("password")]),onClick:he},{default:u.withCtx(()=>[(u.openBlock(),u.createBlock(u.resolveDynamicComponent(u.unref(L))))]),_:1},8,["class"])):u.createCommentVNode("v-if",!0),u.unref(F)?(u.openBlock(),u.createElementBlock("span",{key:3,class:u.normalizeClass(u.unref(m).e("count"))},[u.createElementVNode("span",{class:u.normalizeClass(u.unref(m).e("count-inner"))},u.toDisplayString(u.unref(U))+" / "+u.toDisplayString(u.unref(c).maxlength),3)],2)):u.createCommentVNode("v-if",!0),u.unref(I)&&u.unref(S)&&u.unref(R)?(u.openBlock(),u.createBlock(u.unref(Et),{key:4,class:u.normalizeClass([u.unref(m).e("icon"),u.unref(m).e("validateIcon"),u.unref(m).is("loading",u.unref(I)==="validating")])},{default:u.withCtx(()=>[(u.openBlock(),u.createBlock(u.resolveDynamicComponent(u.unref(S))))]),_:1},8,["class"])):u.createCommentVNode("v-if",!0)],2)],2)):u.createCommentVNode("v-if",!0)],2),u.createCommentVNode(" append slot "),z.$slots.append?(u.openBlock(),u.createElementBlock("div",{key:1,class:u.normalizeClass(u.unref(m).be("group","append"))},[u.renderSlot(z.$slots,"append")],2)):u.createCommentVNode("v-if",!0)],64)):(u.openBlock(),u.createElementBlock(u.Fragment,{key:1},[u.createCommentVNode(" textarea "),u.createElementVNode("textarea",u.mergeProps({id:u.unref(h),ref_key:"textarea",ref:A,class:u.unref(y).e("inner")},u.unref(c),{tabindex:z.tabindex,disabled:u.unref(p),readonly:z.readonly,autocomplete:z.autocomplete,style:u.unref(w),"aria-label":z.label,placeholder:z.placeholder,form:n.form,onCompositionstart:Ee,onCompositionupdate:se,onCompositionend:ee,onInput:ce,onFocus:De,onBlur:we,onChange:re,onKeydown:Ce}),null,16,Hh),u.unref(F)?(u.openBlock(),u.createElementBlock("span",{key:0,style:u.normalizeStyle(C.value),class:u.normalizeClass(u.unref(m).e("count"))},u.toDisplayString(u.unref(U))+" / "+u.toDisplayString(u.unref(c).maxlength),7)):u.createCommentVNode("v-if",!0)],64))],16,Gh)),[[u.vShow,z.type!=="hidden"]])}});var Jh=We(Qh,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const Yh=Vt(Jh),ri=Symbol("popper"),Io=Symbol("popperContent"),bo=Ue({role:{type:String,values:["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],default:"tooltip"}}),zh=u.defineComponent({name:"ElPopper",inheritAttrs:!1}),qh=u.defineComponent({...zh,props:bo,setup(r,{expose:e}){const t=r,n=u.ref(),i=u.ref(),s=u.ref(),o=u.ref(),a=u.computed(()=>t.role),l={triggerRef:n,popperInstanceRef:i,contentRef:s,referenceRef:o,role:a};return e(l),u.provide(ri,l),(c,d)=>u.renderSlot(c.$slots,"default")}});var Zh=We(qh,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const Co=Ue({arrowOffset:{type:Number,default:5}}),Xh=u.defineComponent({name:"ElPopperArrow",inheritAttrs:!1}),$h=u.defineComponent({...Xh,props:Co,setup(r,{expose:e}){const t=r,n=$e("popper"),{arrowOffset:i,arrowRef:s,arrowStyle:o}=u.inject(Io,void 0);return u.watch(()=>t.arrowOffset,a=>{i.value=a}),u.onBeforeUnmount(()=>{s.value=void 0}),e({arrowRef:s}),(a,l)=>(u.openBlock(),u.createElementBlock("span",{ref_key:"arrowRef",ref:s,class:u.normalizeClass(u.unref(n).e("arrow")),style:u.normalizeStyle(u.unref(o)),"data-popper-arrow":""},null,6))}});var ep=We($h,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const ii="ElOnlyChild",tp=u.defineComponent({name:ii,setup(r,{slots:e,attrs:t}){var n;const i=u.inject(xo),s=bh((n=i==null?void 0:i.setForwardRef)!=null?n:Yn);return()=>{var o;const a=(o=e.default)==null?void 0:o.call(e,t);if(!a)return null;if(a.length>1)return He(ii,"requires exact only one valid child."),null;const l=Lo(a);return l?u.withDirectives(u.cloneVNode(l,t),[[s]]):(He(ii,"no valid child node found"),null)}}});function Lo(r){if(!r)return null;const e=r;for(const t of e){if(rn(t))switch(t.type){case u.Comment:continue;case u.Text:case"svg":return Ro(t);case u.Fragment:return Lo(t.children);default:return t}return Ro(t)}return null}function Ro(r){const e=$e("only-child");return u.createVNode("span",{class:e.e("content")},[r])}const wo=Ue({virtualRef:{type:ge(Object)},virtualTriggering:Boolean,onMouseenter:{type:ge(Function)},onMouseleave:{type:ge(Function)},onClick:{type:ge(Function)},onKeydown:{type:ge(Function)},onFocus:{type:ge(Function)},onBlur:{type:ge(Function)},onContextmenu:{type:ge(Function)},id:String,open:Boolean}),np=u.defineComponent({name:"ElPopperTrigger",inheritAttrs:!1}),rp=u.defineComponent({...np,props:wo,setup(r,{expose:e}){const t=r,{role:n,triggerRef:i}=u.inject(ri,void 0);Ih(i);const s=u.computed(()=>a.value?t.id:void 0),o=u.computed(()=>{if(n&&n.value==="tooltip")return t.open&&t.id?t.id:void 0}),a=u.computed(()=>{if(n&&n.value!=="tooltip")return n.value}),l=u.computed(()=>a.value?`${t.open}`:void 0);let c;return u.onMounted(()=>{u.watch(()=>t.virtualRef,d=>{d&&(i.value=Nt(d))},{immediate:!0}),u.watch(i,(d,f)=>{c==null||c(),c=void 0,er(d)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(h=>{var g;const p=t[h];p&&(d.addEventListener(h.slice(2).toLowerCase(),p),(g=f==null?void 0:f.removeEventListener)==null||g.call(f,h.slice(2).toLowerCase(),p))}),c=u.watch([s,o,a,l],h=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((g,p)=>{kt(h[p])?d.removeAttribute(g):d.setAttribute(g,h[p])})},{immediate:!0})),er(f)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(h=>f.removeAttribute(h))},{immediate:!0})}),u.onBeforeUnmount(()=>{c==null||c(),c=void 0}),e({triggerRef:i}),(d,f)=>d.virtualTriggering?u.createCommentVNode("v-if",!0):(u.openBlock(),u.createBlock(u.unref(tp),u.mergeProps({key:0},d.$attrs,{"aria-controls":u.unref(s),"aria-describedby":u.unref(o),"aria-expanded":u.unref(l),"aria-haspopup":u.unref(a)}),{default:u.withCtx(()=>[u.renderSlot(d.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var ip=We(rp,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const si="focus-trap.focus-after-trapped",oi="focus-trap.focus-after-released",sp="focus-trap.focusout-prevented",ko={cancelable:!0,bubbles:!1},op={cancelable:!0,bubbles:!1},Do="focusAfterTrapped",Oo="focusAfterReleased",ap=Symbol("elFocusTrap"),ai=u.ref(),cr=u.ref(0),li=u.ref(0);let dr=0;const Po=r=>{const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e},Bo=(r,e)=>{for(const t of r)if(!lp(t,e))return t},lp=(r,e)=>{if(process.env.NODE_ENV==="test")return!1;if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1},up=r=>{const e=Po(r),t=Bo(e,r),n=Bo(e.reverse(),r);return[t,n]},cp=r=>r instanceof HTMLInputElement&&"select"in r,Gt=(r,e)=>{if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),li.value=window.performance.now(),r!==t&&cp(r)&&e&&r.select()}};function Mo(r,e){const t=[...r],n=r.indexOf(e);return n!==-1&&t.splice(n,1),t}const dp=()=>{let r=[];return{push:n=>{const i=r[0];i&&n!==i&&i.pause(),r=Mo(r,n),r.unshift(n)},remove:n=>{var i,s;r=Mo(r,n),(s=(i=r[0])==null?void 0:i.resume)==null||s.call(i)}}},fp=(r,e=!1)=>{const t=document.activeElement;for(const n of r)if(Gt(n,e),document.activeElement!==t)return},Fo=dp(),hp=()=>cr.value>li.value,fr=()=>{ai.value="pointer",cr.value=window.performance.now()},No=()=>{ai.value="keyboard",cr.value=window.performance.now()},pp=()=>(u.onMounted(()=>{dr===0&&(document.addEventListener("mousedown",fr),document.addEventListener("touchstart",fr),document.addEventListener("keydown",No)),dr++}),u.onBeforeUnmount(()=>{dr--,dr<=0&&(document.removeEventListener("mousedown",fr),document.removeEventListener("touchstart",fr),document.removeEventListener("keydown",No))}),{focusReason:ai,lastUserFocusTimestamp:cr,lastAutomatedFocusTimestamp:li}),hr=r=>new CustomEvent(sp,{...op,detail:r}),gp=u.defineComponent({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Do,Oo,"focusin","focusout","focusout-prevented","release-requested"],setup(r,{emit:e}){const t=u.ref();let n,i;const{focusReason:s}=pp();Ah(p=>{r.trapped&&!o.paused&&e("release-requested",p)});const o={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=p=>{if(!r.loop&&!r.trapped||o.paused)return;const{key:m,altKey:y,ctrlKey:E,metaKey:A,currentTarget:_,shiftKey:x}=p,{loop:v}=r,T=m===wn.tab&&!y&&!E&&!A,C=document.activeElement;if(T&&C){const k=_,[B,R]=up(k);if(B&&R){if(!x&&C===R){const S=hr({focusReason:s.value});e("focusout-prevented",S),S.defaultPrevented||(p.preventDefault(),v&&Gt(B,!0))}else if(x&&[B,k].includes(C)){const S=hr({focusReason:s.value});e("focusout-prevented",S),S.defaultPrevented||(p.preventDefault(),v&&Gt(R,!0))}}else if(C===k){const S=hr({focusReason:s.value});e("focusout-prevented",S),S.defaultPrevented||p.preventDefault()}}};u.provide(ap,{focusTrapRef:t,onKeydown:a}),u.watch(()=>r.focusTrapEl,p=>{p&&(t.value=p)},{immediate:!0}),u.watch([t],([p],[m])=>{p&&(p.addEventListener("keydown",a),p.addEventListener("focusin",d),p.addEventListener("focusout",f)),m&&(m.removeEventListener("keydown",a),m.removeEventListener("focusin",d),m.removeEventListener("focusout",f))});const l=p=>{e(Do,p)},c=p=>e(Oo,p),d=p=>{const m=u.unref(t);if(!m)return;const y=p.target,E=p.relatedTarget,A=y&&m.contains(y);r.trapped||E&&m.contains(E)||(n=E),A&&e("focusin",p),!o.paused&&r.trapped&&(A?i=y:Gt(i,!0))},f=p=>{const m=u.unref(t);if(!(o.paused||!m))if(r.trapped){const y=p.relatedTarget;!kt(y)&&!m.contains(y)&&setTimeout(()=>{if(!o.paused&&r.trapped){const E=hr({focusReason:s.value});e("focusout-prevented",E),E.defaultPrevented||Gt(i,!0)}},0)}else{const y=p.target;y&&m.contains(y)||e("focusout",p)}};async function h(){await u.nextTick();const p=u.unref(t);if(p){Fo.push(o);const m=p.contains(document.activeElement)?n:document.activeElement;if(n=m,!p.contains(m)){const E=new Event(si,ko);p.addEventListener(si,l),p.dispatchEvent(E),E.defaultPrevented||u.nextTick(()=>{let A=r.focusStartEl;ut(A)||(Gt(A),document.activeElement!==A&&(A="first")),A==="first"&&fp(Po(p),!0),(document.activeElement===m||A==="container")&&Gt(p)})}}}function g(){const p=u.unref(t);if(p){p.removeEventListener(si,l);const m=new CustomEvent(oi,{...ko,detail:{focusReason:s.value}});p.addEventListener(oi,c),p.dispatchEvent(m),!m.defaultPrevented&&(s.value=="keyboard"||!hp()||p.contains(document.activeElement))&&Gt(n??document.body),p.removeEventListener(oi,l),Fo.remove(o)}}return u.onMounted(()=>{r.trapped&&h(),u.watch(()=>r.trapped,p=>{p?h():g()})}),u.onBeforeUnmount(()=>{r.trapped&&g()}),{onKeydown:a}}});function mp(r,e,t,n,i,s){return u.renderSlot(r.$slots,"default",{handleKeydown:r.onKeydown})}var yp=We(gp,[["render",mp],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const Ep=["fixed","absolute"],vp=Ue({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:ge(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Pn,default:"bottom"},popperOptions:{type:ge(Object),default:()=>({})},strategy:{type:String,values:Ep,default:"absolute"}}),Uo=Ue({...vp,id:String,style:{type:ge([String,Array,Object])},className:{type:ge([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:ge([String,Array,Object])},popperStyle:{type:ge([String,Array,Object])},referenceEl:{type:ge(Object)},triggerTargetEl:{type:ge(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),Ap={mouseenter:r=>r instanceof MouseEvent,mouseleave:r=>r instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},_p=(r,e=[])=>{const{placement:t,strategy:n,popperOptions:i}=r,s={placement:t,strategy:n,...i,modifiers:[...Sp(r),...e]};return Tp(s,i==null?void 0:i.modifiers),s},xp=r=>{if(ct)return Nt(r)};function Sp(r){const{offset:e,gpuAcceleration:t,fallbackPlacements:n}=r;return[{name:"offset",options:{offset:[0,e??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:n}},{name:"computeStyles",options:{gpuAcceleration:t}}]}function Tp(r,e){e&&(r.modifiers=[...r.modifiers,...e??[]])}const Ip=0,bp=r=>{const{popperInstanceRef:e,contentRef:t,triggerRef:n,role:i}=u.inject(ri,void 0),s=u.ref(),o=u.ref(),a=u.computed(()=>({name:"eventListeners",enabled:!!r.visible})),l=u.computed(()=>{var E;const A=u.unref(s),_=(E=u.unref(o))!=null?E:Ip;return{name:"arrow",enabled:!Wc(A),options:{element:A,padding:_}}}),c=u.computed(()=>({onFirstUpdate:()=>{p()},..._p(r,[u.unref(l),u.unref(a)])})),d=u.computed(()=>xp(r.referenceEl)||u.unref(n)),{attributes:f,state:h,styles:g,update:p,forceUpdate:m,instanceRef:y}=yh(d,t,c);return u.watch(y,E=>e.value=E),u.onMounted(()=>{u.watch(()=>{var E;return(E=u.unref(d))==null?void 0:E.getBoundingClientRect()},()=>{p()})}),{attributes:f,arrowRef:s,contentRef:t,instanceRef:y,state:h,styles:g,role:i,forceUpdate:m,update:p}},Cp=(r,{attributes:e,styles:t,role:n})=>{const{nextZIndex:i}=Rh(),s=$e("popper"),o=u.computed(()=>u.unref(e).popper),a=u.ref(r.zIndex||i()),l=u.computed(()=>[s.b(),s.is("pure",r.pure),s.is(r.effect),r.popperClass]),c=u.computed(()=>[{zIndex:u.unref(a)},r.popperStyle||{},u.unref(t).popper]),d=u.computed(()=>n.value==="dialog"?"false":void 0),f=u.computed(()=>u.unref(t).arrow||{});return{ariaModal:d,arrowStyle:f,contentAttrs:o,contentClass:l,contentStyle:c,contentZIndex:a,updateZIndex:()=>{a.value=r.zIndex||i()}}},Lp=(r,e)=>{const t=u.ref(!1),n=u.ref();return{focusStartRef:n,trapped:t,onFocusAfterReleased:c=>{var d;((d=c.detail)==null?void 0:d.focusReason)!=="pointer"&&(n.value="first",e("blur"))},onFocusAfterTrapped:()=>{e("focus")},onFocusInTrap:c=>{r.visible&&!t.value&&(c.target&&(n.value=c.target),t.value=!0)},onFocusoutPrevented:c=>{r.trapping||(c.detail.focusReason==="pointer"&&c.preventDefault(),t.value=!1)},onReleaseRequested:()=>{t.value=!1,e("close")}}},Rp=u.defineComponent({name:"ElPopperContent"}),wp=u.defineComponent({...Rp,props:Uo,emits:Ap,setup(r,{expose:e,emit:t}){const n=r,{focusStartRef:i,trapped:s,onFocusAfterReleased:o,onFocusAfterTrapped:a,onFocusInTrap:l,onFocusoutPrevented:c,onReleaseRequested:d}=Lp(n,t),{attributes:f,arrowRef:h,contentRef:g,styles:p,instanceRef:m,role:y,update:E}=bp(n),{ariaModal:A,arrowStyle:_,contentAttrs:x,contentClass:v,contentStyle:T,updateZIndex:C}=Cp(n,{styles:p,attributes:f,role:y}),k=u.inject(ar,void 0),B=u.ref();u.provide(Io,{arrowStyle:_,arrowRef:h,arrowOffset:B}),k&&(k.addInputId||k.removeInputId)&&u.provide(ar,{...k,addInputId:Yn,removeInputId:Yn});let R;const I=(L=!0)=>{E(),L&&C()},S=()=>{I(!1),n.visible&&n.focusOnShow?s.value=!0:n.visible===!1&&(s.value=!1)};return u.onMounted(()=>{u.watch(()=>n.triggerTargetEl,(L,b)=>{R==null||R(),R=void 0;const w=u.unref(L||g.value),M=u.unref(b||g.value);er(w)&&(R=u.watch([y,()=>n.ariaLabel,A,()=>n.id],O=>{["role","aria-label","aria-modal","id"].forEach((D,F)=>{kt(O[F])?w.removeAttribute(D):w.setAttribute(D,O[F])})},{immediate:!0})),M!==w&&er(M)&&["role","aria-label","aria-modal","id"].forEach(O=>{M.removeAttribute(O)})},{immediate:!0}),u.watch(()=>n.visible,S,{immediate:!0})}),u.onBeforeUnmount(()=>{R==null||R(),R=void 0}),e({popperContentRef:g,popperInstanceRef:m,updatePopper:I,contentStyle:T}),(L,b)=>(u.openBlock(),u.createElementBlock("div",u.mergeProps({ref_key:"contentRef",ref:g},u.unref(x),{style:u.unref(T),class:u.unref(v),tabindex:"-1",onMouseenter:b[0]||(b[0]=w=>L.$emit("mouseenter",w)),onMouseleave:b[1]||(b[1]=w=>L.$emit("mouseleave",w))}),[u.createVNode(u.unref(yp),{trapped:u.unref(s),"trap-on-focus-in":!0,"focus-trap-el":u.unref(g),"focus-start-el":u.unref(i),onFocusAfterTrapped:u.unref(a),onFocusAfterReleased:u.unref(o),onFocusin:u.unref(l),onFocusoutPrevented:u.unref(c),onReleaseRequested:u.unref(d)},{default:u.withCtx(()=>[u.renderSlot(L.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var kp=We(wp,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const Dp=Vt(Zh),ui=Symbol("elTooltip"),pt=Ue({...Sh,...Uo,appendTo:{type:ge([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:ge(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),Un=Ue({...wo,disabled:Boolean,trigger:{type:ge([String,Array]),default:"hover"},triggerKeys:{type:ge(Array),default:()=>[wn.enter,wn.space]}}),{useModelToggleProps:Op,useModelToggleEmits:Pp,useModelToggle:Bp}=Js("visible"),Mp=Ue({...bo,...Op,...pt,...Un,...Co,showArrow:{type:Boolean,default:!0}}),Fp=[...Pp,"before-show","before-hide","show","hide","open","close"],Np=(r,e)=>bs(r)?r.includes(e):r===e,hn=(r,e,t)=>n=>{Np(u.unref(r),e)&&t(n)},Up=u.defineComponent({name:"ElTooltipTrigger"}),Vp=u.defineComponent({...Up,props:Un,setup(r,{expose:e}){const t=r,n=$e("tooltip"),{controlled:i,id:s,open:o,onOpen:a,onClose:l,onToggle:c}=u.inject(ui,void 0),d=u.ref(null),f=()=>{if(u.unref(i)||t.disabled)return!0},h=u.toRef(t,"trigger"),g=lt(f,hn(h,"hover",a)),p=lt(f,hn(h,"hover",l)),m=lt(f,hn(h,"click",x=>{x.button===0&&c(x)})),y=lt(f,hn(h,"focus",a)),E=lt(f,hn(h,"focus",l)),A=lt(f,hn(h,"contextmenu",x=>{x.preventDefault(),c(x)})),_=lt(f,x=>{const{code:v}=x;t.triggerKeys.includes(v)&&(x.preventDefault(),c(x))});return e({triggerRef:d}),(x,v)=>(u.openBlock(),u.createBlock(u.unref(ip),{id:u.unref(s),"virtual-ref":x.virtualRef,open:u.unref(o),"virtual-triggering":x.virtualTriggering,class:u.normalizeClass(u.unref(n).e("trigger")),onBlur:u.unref(E),onClick:u.unref(m),onContextmenu:u.unref(A),onFocus:u.unref(y),onMouseenter:u.unref(g),onMouseleave:u.unref(p),onKeydown:u.unref(_)},{default:u.withCtx(()=>[u.renderSlot(x.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var Kp=We(Vp,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const Gp=u.defineComponent({name:"ElTooltipContent",inheritAttrs:!1}),jp=u.defineComponent({...Gp,props:pt,setup(r,{expose:e}){const t=r,{selector:n}=_o(),i=$e("tooltip"),s=u.ref(null),o=u.ref(!1),{controlled:a,id:l,open:c,trigger:d,onClose:f,onOpen:h,onShow:g,onHide:p,onBeforeShow:m,onBeforeHide:y}=u.inject(ui,void 0),E=u.computed(()=>t.transition||`${i.namespace.value}-fade-in-linear`),A=u.computed(()=>process.env.NODE_ENV==="test"?!0:t.persistent);u.onBeforeUnmount(()=>{o.value=!0});const _=u.computed(()=>u.unref(A)?!0:u.unref(c)),x=u.computed(()=>t.disabled?!1:u.unref(c)),v=u.computed(()=>t.appendTo||n.value),T=u.computed(()=>{var O;return(O=t.style)!=null?O:{}}),C=u.computed(()=>!u.unref(c)),k=()=>{p()},B=()=>{if(u.unref(a))return!0},R=lt(B,()=>{t.enterable&&u.unref(d)==="hover"&&h()}),I=lt(B,()=>{u.unref(d)==="hover"&&f()}),S=()=>{var O,D;(D=(O=s.value)==null?void 0:O.updatePopper)==null||D.call(O),m==null||m()},L=()=>{y==null||y()},b=()=>{g(),M=Yl(u.computed(()=>{var O;return(O=s.value)==null?void 0:O.popperContentRef}),()=>{if(u.unref(a))return;u.unref(d)!=="hover"&&f()})},w=()=>{t.virtualTriggering||f()};let M;return u.watch(()=>u.unref(c),O=>{O||M==null||M()},{flush:"post"}),u.watch(()=>t.content,()=>{var O,D;(D=(O=s.value)==null?void 0:O.updatePopper)==null||D.call(O)}),e({contentRef:s}),(O,D)=>(u.openBlock(),u.createBlock(u.Teleport,{disabled:!O.teleported,to:u.unref(v)},[u.createVNode(u.Transition,{name:u.unref(E),onAfterLeave:k,onBeforeEnter:S,onAfterEnter:b,onBeforeLeave:L},{default:u.withCtx(()=>[u.unref(_)?u.withDirectives((u.openBlock(),u.createBlock(u.unref(kp),u.mergeProps({key:0,id:u.unref(l),ref_key:"contentRef",ref:s},O.$attrs,{"aria-label":O.ariaLabel,"aria-hidden":u.unref(C),"boundaries-padding":O.boundariesPadding,"fallback-placements":O.fallbackPlacements,"gpu-acceleration":O.gpuAcceleration,offset:O.offset,placement:O.placement,"popper-options":O.popperOptions,strategy:O.strategy,effect:O.effect,enterable:O.enterable,pure:O.pure,"popper-class":O.popperClass,"popper-style":[O.popperStyle,u.unref(T)],"reference-el":O.referenceEl,"trigger-target-el":O.triggerTargetEl,visible:u.unref(x),"z-index":O.zIndex,onMouseenter:u.unref(R),onMouseleave:u.unref(I),onBlur:w,onClose:u.unref(f)}),{default:u.withCtx(()=>[o.value?u.createCommentVNode("v-if",!0):u.renderSlot(O.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[u.vShow,u.unref(x)]]):u.createCommentVNode("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var Hp=We(jp,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const Wp=["innerHTML"],Qp={key:1},Jp=u.defineComponent({name:"ElTooltip"}),Yp=u.defineComponent({...Jp,props:Mp,emits:Fp,setup(r,{expose:e,emit:t}){const n=r;xh();const i=Eo(),s=u.ref(),o=u.ref(),a=()=>{var E;const A=u.unref(s);A&&((E=A.popperInstanceRef)==null||E.update())},l=u.ref(!1),c=u.ref(),{show:d,hide:f,hasUpdateHandler:h}=Bp({indicator:l,toggleReason:c}),{onOpen:g,onClose:p}=Th({showAfter:u.toRef(n,"showAfter"),hideAfter:u.toRef(n,"hideAfter"),autoClose:u.toRef(n,"autoClose"),open:d,close:f}),m=u.computed(()=>Yt(n.visible)&&!h.value);u.provide(ui,{controlled:m,id:i,open:u.readonly(l),trigger:u.toRef(n,"trigger"),onOpen:E=>{g(E)},onClose:E=>{p(E)},onToggle:E=>{u.unref(l)?p(E):g(E)},onShow:()=>{t("show",c.value)},onHide:()=>{t("hide",c.value)},onBeforeShow:()=>{t("before-show",c.value)},onBeforeHide:()=>{t("before-hide",c.value)},updatePopper:a}),u.watch(()=>n.disabled,E=>{E&&l.value&&(l.value=!1)});const y=()=>{var E,A;const _=(A=(E=o.value)==null?void 0:E.contentRef)==null?void 0:A.popperContentRef;return _&&_.contains(document.activeElement)};return u.onDeactivated(()=>l.value&&f()),e({popperRef:s,contentRef:o,isFocusInsideContent:y,updatePopper:a,onOpen:g,onClose:p,hide:f}),(E,A)=>(u.openBlock(),u.createBlock(u.unref(Dp),{ref_key:"popperRef",ref:s,role:E.role},{default:u.withCtx(()=>[u.createVNode(Kp,{disabled:E.disabled,trigger:E.trigger,"trigger-keys":E.triggerKeys,"virtual-ref":E.virtualRef,"virtual-triggering":E.virtualTriggering},{default:u.withCtx(()=>[E.$slots.default?u.renderSlot(E.$slots,"default",{key:0}):u.createCommentVNode("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),u.createVNode(Hp,{ref_key:"contentRef",ref:o,"aria-label":E.ariaLabel,"boundaries-padding":E.boundariesPadding,content:E.content,disabled:E.disabled,effect:E.effect,enterable:E.enterable,"fallback-placements":E.fallbackPlacements,"hide-after":E.hideAfter,"gpu-acceleration":E.gpuAcceleration,offset:E.offset,persistent:E.persistent,"popper-class":E.popperClass,"popper-style":E.popperStyle,placement:E.placement,"popper-options":E.popperOptions,pure:E.pure,"raw-content":E.rawContent,"reference-el":E.referenceEl,"trigger-target-el":E.triggerTargetEl,"show-after":E.showAfter,strategy:E.strategy,teleported:E.teleported,transition:E.transition,"virtual-triggering":E.virtualTriggering,"z-index":E.zIndex,"append-to":E.appendTo},{default:u.withCtx(()=>[u.renderSlot(E.$slots,"content",{},()=>[E.rawContent?(u.openBlock(),u.createElementBlock("span",{key:0,innerHTML:E.content},null,8,Wp)):(u.openBlock(),u.createElementBlock("span",Qp,u.toDisplayString(E.content),1))]),E.showArrow?(u.openBlock(),u.createBlock(u.unref(ep),{key:0,"arrow-offset":E.arrowOffset},null,8,["arrow-offset"])):u.createCommentVNode("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var zp=We(Yp,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const ci=Vt(zp);function qp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}const Zp=100,Xp=600,Vo={beforeMount(r,e){const t=e.value,{interval:n=Zp,delay:i=Xp}=Ut(t)?{}:t;let s,o;const a=()=>Ut(t)?t():t.handler(),l=()=>{o&&(clearTimeout(o),o=void 0),s&&(clearInterval(s),s=void 0)};r.addEventListener("mousedown",c=>{c.button===0&&(l(),a(),document.addEventListener("mouseup",()=>l(),{once:!0}),o=setTimeout(()=>{s=setInterval(()=>{a()},n)},i))})}},$p=u.defineComponent({inheritAttrs:!1});function e0(r,e,t,n,i,s){return u.renderSlot(r.$slots,"default")}var t0=We($p,[["render",e0],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);const n0=u.defineComponent({name:"ElCollectionItem",inheritAttrs:!1});function r0(r,e,t,n,i,s){return u.renderSlot(r.$slots,"default")}var i0=We(n0,[["render",r0],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const s0="data-el-collection-item",o0=r=>{const e=`El${r}Collection`,t=`${e}Item`,n=Symbol(e),i=Symbol(t),s={...t0,name:e,setup(){const a=u.ref(null),l=new Map,c=()=>{const d=u.unref(a);if(!d)return[];const f=Array.from(d.querySelectorAll(`[${s0}]`));return[...l.values()].sort((g,p)=>f.indexOf(g.ref)-f.indexOf(p.ref))};u.provide(n,{itemMap:l,getItems:c,collectionRef:a})}},o={...i0,name:t,setup(a,{attrs:l}){const c=u.ref(null),d=u.inject(n,void 0);u.provide(i,{collectionItemRef:c}),u.onMounted(()=>{const f=u.unref(c);f&&d.itemMap.set(f,{ref:f,...l})}),u.onBeforeUnmount(()=>{const f=u.unref(c);d.itemMap.delete(f)})}};return{COLLECTION_INJECTION_KEY:n,COLLECTION_ITEM_INJECTION_KEY:i,ElCollection:s,ElCollectionItem:o}},di=Ue({trigger:Un.trigger,effect:{...pt.effect,default:"light"},type:{type:ge(String)},placement:{type:ge(String),default:"bottom"},popperOptions:{type:ge(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:ge([Number,String]),default:0},maxHeight:{type:ge([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:ge(Object)},teleported:pt.teleported});Ue({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Rn}}),Ue({onKeydown:{type:ge(Function)}}),o0("Dropdown");const a0=Ue({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:or,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:r=>r===null||Ne(r)||["min","max"].includes(r),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:r=>r>=0&&r===Number.parseInt(`${r}`,10)},validateEvent:{type:Boolean,default:!0}}),l0={[zt]:(r,e)=>e!==r,blur:r=>r instanceof FocusEvent,focus:r=>r instanceof FocusEvent,[It]:r=>Ne(r)||kt(r),[qe]:r=>Ne(r)||kt(r)},u0=["aria-label","onKeydown"],c0=["aria-label","onKeydown"],d0=u.defineComponent({name:"ElInputNumber"}),f0=u.defineComponent({...d0,props:a0,emits:l0,setup(r,{expose:e,emit:t}){const n=r,{t:i}=Ws(),s=$e("input-number"),o=u.ref(),a=u.reactive({currentValue:n.modelValue,userInput:null}),{formItem:l}=ur(),c=u.computed(()=>Ne(n.modelValue)&&n.modelValue<=n.min),d=u.computed(()=>Ne(n.modelValue)&&n.modelValue>=n.max),f=u.computed(()=>{const L=E(n.step);return Ln(n.precision)?Math.max(E(n.modelValue),L):(L>n.precision&&He("InputNumber","precision should not be less than the decimal places of step"),n.precision)}),h=u.computed(()=>n.controls&&n.controlsPosition==="right"),g=lr(),p=ti(),m=u.computed(()=>{if(a.userInput!==null)return a.userInput;let L=a.currentValue;if(kt(L))return"";if(Ne(L)){if(Number.isNaN(L))return"";Ln(n.precision)||(L=L.toFixed(n.precision))}return L}),y=(L,b)=>{if(Ln(b)&&(b=f.value),b===0)return Math.round(L);let w=String(L);const M=w.indexOf(".");if(M===-1||!w.replace(".","").split("")[M+b])return L;const F=w.length;return w.charAt(F-1)==="5"&&(w=`${w.slice(0,Math.max(0,F-1))}6`),Number.parseFloat(Number(w).toFixed(b))},E=L=>{if(kt(L))return 0;const b=L.toString(),w=b.indexOf(".");let M=0;return w!==-1&&(M=b.length-w-1),M},A=(L,b=1)=>Ne(L)?y(L+n.step*b):a.currentValue,_=()=>{if(n.readonly||p.value||d.value)return;const L=Number(m.value)||0,b=A(L);T(b),t(It,a.currentValue)},x=()=>{if(n.readonly||p.value||c.value)return;const L=Number(m.value)||0,b=A(L,-1);T(b),t(It,a.currentValue)},v=(L,b)=>{const{max:w,min:M,step:O,precision:D,stepStrictly:F,valueOnClear:U}=n;let K=Number(L);if(kt(L)||Number.isNaN(K))return null;if(L===""){if(U===null)return null;K=ut(U)?{min:M,max:w}[U]:U}return F&&(K=y(Math.round(K/O)*O,D)),Ln(D)||(K=y(K,D)),(K>w||K<M)&&(K=K>w?w:M,b&&t(qe,K)),K},T=(L,b=!0)=>{var w;const M=a.currentValue,O=v(L);if(!b){t(qe,O);return}M!==O&&(a.userInput=null,t(qe,O),t(zt,O,M),n.validateEvent&&((w=l==null?void 0:l.validate)==null||w.call(l,"change").catch(D=>He(D))),a.currentValue=O)},C=L=>{a.userInput=L;const b=L===""?null:Number(L);t(It,b),T(b,!1)},k=L=>{const b=L!==""?Number(L):"";(Ne(b)&&!Number.isNaN(b)||L==="")&&T(b),a.userInput=null},B=()=>{var L,b;(b=(L=o.value)==null?void 0:L.focus)==null||b.call(L)},R=()=>{var L,b;(b=(L=o.value)==null?void 0:L.blur)==null||b.call(L)},I=L=>{t("focus",L)},S=L=>{var b;t("blur",L),n.validateEvent&&((b=l==null?void 0:l.validate)==null||b.call(l,"blur").catch(w=>He(w)))};return u.watch(()=>n.modelValue,L=>{const b=v(a.userInput),w=v(L,!0);!Ne(b)&&(!b||b!==w)&&(a.currentValue=w,a.userInput=null)},{immediate:!0}),u.onMounted(()=>{var L;const{min:b,max:w,modelValue:M}=n,O=(L=o.value)==null?void 0:L.input;if(O.setAttribute("role","spinbutton"),Number.isFinite(w)?O.setAttribute("aria-valuemax",String(w)):O.removeAttribute("aria-valuemax"),Number.isFinite(b)?O.setAttribute("aria-valuemin",String(b)):O.removeAttribute("aria-valuemin"),O.setAttribute("aria-valuenow",String(a.currentValue)),O.setAttribute("aria-disabled",String(p.value)),!Ne(M)&&M!=null){let D=Number(M);Number.isNaN(D)&&(D=null),t(qe,D)}}),u.onUpdated(()=>{var L;const b=(L=o.value)==null?void 0:L.input;b==null||b.setAttribute("aria-valuenow",`${a.currentValue}`)}),e({focus:B,blur:R}),(L,b)=>(u.openBlock(),u.createElementBlock("div",{class:u.normalizeClass([u.unref(s).b(),u.unref(s).m(u.unref(g)),u.unref(s).is("disabled",u.unref(p)),u.unref(s).is("without-controls",!L.controls),u.unref(s).is("controls-right",u.unref(h))]),onDragstart:b[1]||(b[1]=u.withModifiers(()=>{},["prevent"]))},[L.controls?u.withDirectives((u.openBlock(),u.createElementBlock("span",{key:0,role:"button","aria-label":u.unref(i)("el.inputNumber.decrease"),class:u.normalizeClass([u.unref(s).e("decrease"),u.unref(s).is("disabled",u.unref(c))]),onKeydown:u.withKeys(x,["enter"])},[u.createVNode(u.unref(Et),null,{default:u.withCtx(()=>[u.unref(h)?(u.openBlock(),u.createBlock(u.unref($c),{key:0})):(u.openBlock(),u.createBlock(u.unref(Md),{key:1}))]),_:1})],42,u0)),[[u.unref(Vo),x]]):u.createCommentVNode("v-if",!0),L.controls?u.withDirectives((u.openBlock(),u.createElementBlock("span",{key:1,role:"button","aria-label":u.unref(i)("el.inputNumber.increase"),class:u.normalizeClass([u.unref(s).e("increase"),u.unref(s).is("disabled",u.unref(d))]),onKeydown:u.withKeys(_,["enter"])},[u.createVNode(u.unref(Et),null,{default:u.withCtx(()=>[u.unref(h)?(u.openBlock(),u.createBlock(u.unref(sd),{key:0})):(u.openBlock(),u.createBlock(u.unref(Gd),{key:1}))]),_:1})],42,c0)),[[u.unref(Vo),_]]):u.createCommentVNode("v-if",!0),u.createVNode(u.unref(Yh),{id:L.id,ref_key:"input",ref:o,type:"number",step:L.step,"model-value":u.unref(m),placeholder:L.placeholder,readonly:L.readonly,disabled:u.unref(p),size:u.unref(g),max:L.max,min:L.min,name:L.name,label:L.label,"validate-event":!1,onWheel:b[0]||(b[0]=u.withModifiers(()=>{},["prevent"])),onKeydown:[u.withKeys(u.withModifiers(_,["prevent"]),["up"]),u.withKeys(u.withModifiers(x,["prevent"]),["down"])],onBlur:S,onFocus:I,onInput:C,onChange:k},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var h0=We(f0,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]);const p0=Vt(h0),g0=Ue({trigger:Un.trigger,placement:di.placement,disabled:Un.disabled,visible:pt.visible,transition:pt.transition,popperOptions:di.popperOptions,tabindex:di.tabindex,content:pt.content,popperStyle:pt.popperStyle,popperClass:pt.popperClass,enterable:{...pt.enterable,default:!0},effect:{...pt.effect,default:"light"},teleported:pt.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),m0={"update:visible":r=>Yt(r),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},y0="onUpdate:visible",E0=u.defineComponent({name:"ElPopover"}),v0=u.defineComponent({...E0,props:g0,emits:m0,setup(r,{expose:e,emit:t}){const n=r,i=u.computed(()=>n[y0]),s=$e("popover"),o=u.ref(),a=u.computed(()=>{var y;return(y=u.unref(o))==null?void 0:y.popperRef}),l=u.computed(()=>[{width:Gr(n.width)},n.popperStyle]),c=u.computed(()=>[s.b(),n.popperClass,{[s.m("plain")]:!!n.content}]),d=u.computed(()=>n.transition===`${s.namespace.value}-fade-in-linear`),f=()=>{var y;(y=o.value)==null||y.hide()},h=()=>{t("before-enter")},g=()=>{t("before-leave")},p=()=>{t("after-enter")},m=()=>{t("update:visible",!1),t("after-leave")};return e({popperRef:a,hide:f}),(y,E)=>(u.openBlock(),u.createBlock(u.unref(ci),u.mergeProps({ref_key:"tooltipRef",ref:o},y.$attrs,{trigger:y.trigger,placement:y.placement,disabled:y.disabled,visible:y.visible,transition:y.transition,"popper-options":y.popperOptions,tabindex:y.tabindex,content:y.content,offset:y.offset,"show-after":y.showAfter,"hide-after":y.hideAfter,"auto-close":y.autoClose,"show-arrow":y.showArrow,"aria-label":y.title,effect:y.effect,enterable:y.enterable,"popper-class":u.unref(c),"popper-style":u.unref(l),teleported:y.teleported,persistent:y.persistent,"gpu-acceleration":u.unref(d),"onUpdate:visible":u.unref(i),onBeforeShow:h,onBeforeHide:g,onShow:p,onHide:m}),{content:u.withCtx(()=>[y.title?(u.openBlock(),u.createElementBlock("div",{key:0,class:u.normalizeClass(u.unref(s).e("title")),role:"title"},u.toDisplayString(y.title),3)):u.createCommentVNode("v-if",!0),u.renderSlot(y.$slots,"default",{},()=>[u.createTextVNode(u.toDisplayString(y.content),1)])]),default:u.withCtx(()=>[y.$slots.reference?u.renderSlot(y.$slots,"reference",{key:0}):u.createCommentVNode("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var A0=We(v0,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popover/src/popover.vue"]]);const Ko=(r,e)=>{const t=e.arg||e.value,n=t==null?void 0:t.popperRef;n&&(n.triggerRef=r)};var _0={mounted(r,e){Ko(r,e)},updated(r,e){Ko(r,e)}};const x0=Zd(_0,"popover"),S0=Vt(A0,{directive:x0}),Go=Symbol("sliderContextKey"),T0=Ue({modelValue:{type:ge([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:or,inputSize:or,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:ge(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:ge(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Pn,default:"top"},marks:{type:ge(Object)},validateEvent:{type:Boolean,default:!0}}),fi=r=>Ne(r)||bs(r)&&r.every(Ne),I0={[qe]:fi,[It]:fi,[zt]:fi},b0=(r,e,t)=>{const n=u.ref();return u.onMounted(async()=>{r.range?(Array.isArray(r.modelValue)?(e.firstValue=Math.max(r.min,r.modelValue[0]),e.secondValue=Math.min(r.max,r.modelValue[1])):(e.firstValue=r.min,e.secondValue=r.max),e.oldValue=[e.firstValue,e.secondValue]):(typeof r.modelValue!="number"||Number.isNaN(r.modelValue)?e.firstValue=r.min:e.firstValue=Math.min(r.max,Math.max(r.min,r.modelValue)),e.oldValue=e.firstValue),Jn(window,"resize",t),await u.nextTick(),t()}),{sliderWrapper:n}},C0=r=>u.computed(()=>r.marks?Object.keys(r.marks).map(Number.parseFloat).sort((t,n)=>t-n).filter(t=>t<=r.max&&t>=r.min).map(t=>({point:t,position:(t-r.min)*100/(r.max-r.min),mark:r.marks[t]})):[]),L0=(r,e,t)=>{const{form:n,formItem:i}=ur(),s=u.shallowRef(),o=u.ref(),a=u.ref(),l={firstButton:o,secondButton:a},c=u.computed(()=>r.disabled||(n==null?void 0:n.disabled)||!1),d=u.computed(()=>Math.min(e.firstValue,e.secondValue)),f=u.computed(()=>Math.max(e.firstValue,e.secondValue)),h=u.computed(()=>r.range?`${100*(f.value-d.value)/(r.max-r.min)}%`:`${100*(e.firstValue-r.min)/(r.max-r.min)}%`),g=u.computed(()=>r.range?`${100*(d.value-r.min)/(r.max-r.min)}%`:"0%"),p=u.computed(()=>r.vertical?{height:r.height}:{}),m=u.computed(()=>r.vertical?{height:h.value,bottom:g.value}:{width:h.value,left:g.value}),y=()=>{s.value&&(e.sliderSize=s.value[`client${r.vertical?"Height":"Width"}`])},E=I=>{const S=r.min+I*(r.max-r.min)/100;if(!r.range)return o;let L;return Math.abs(d.value-S)<Math.abs(f.value-S)?L=e.firstValue<e.secondValue?"firstButton":"secondButton":L=e.firstValue>e.secondValue?"firstButton":"secondButton",l[L]},A=I=>{const S=E(I);return S.value.setPosition(I),S},_=I=>{e.firstValue=I,v(r.range?[d.value,f.value]:I)},x=I=>{e.secondValue=I,r.range&&v([d.value,f.value])},v=I=>{t(qe,I),t(It,I)},T=async()=>{await u.nextTick(),t(zt,r.range?[d.value,f.value]:r.modelValue)},C=I=>{var S,L,b,w,M,O;if(c.value||e.dragging)return;y();let D=0;if(r.vertical){const F=(b=(L=(S=I.touches)==null?void 0:S.item(0))==null?void 0:L.clientY)!=null?b:I.clientY;D=(s.value.getBoundingClientRect().bottom-F)/e.sliderSize*100}else{const F=(O=(M=(w=I.touches)==null?void 0:w.item(0))==null?void 0:M.clientX)!=null?O:I.clientX,U=s.value.getBoundingClientRect().left;D=(F-U)/e.sliderSize*100}if(!(D<0||D>100))return A(D)};return{elFormItem:i,slider:s,firstButton:o,secondButton:a,sliderDisabled:c,minValue:d,maxValue:f,runwayStyle:p,barStyle:m,resetSize:y,setPosition:A,emitChange:T,onSliderWrapperPrevent:I=>{var S,L;((S=l.firstButton.value)!=null&&S.dragging||(L=l.secondButton.value)!=null&&L.dragging)&&I.preventDefault()},onSliderClick:I=>{C(I)&&T()},onSliderDown:async I=>{const S=C(I);S&&(await u.nextTick(),S.value.onButtonDown(I))},setFirstValue:_,setSecondValue:x}},{left:R0,down:w0,right:k0,up:D0,home:O0,end:P0,pageUp:B0,pageDown:M0}=wn,F0=(r,e,t)=>{const n=u.ref(),i=u.ref(!1),s=u.computed(()=>e.value instanceof Function),o=u.computed(()=>s.value&&e.value(r.modelValue)||r.modelValue),a=Ns(()=>{t.value&&(i.value=!0)},50),l=Ns(()=>{t.value&&(i.value=!1)},50);return{tooltip:n,tooltipVisible:i,formatValue:o,displayTooltip:a,hideTooltip:l}},N0=(r,e,t)=>{const{disabled:n,min:i,max:s,step:o,showTooltip:a,precision:l,sliderSize:c,formatTooltip:d,emitChange:f,resetSize:h,updateDragging:g}=u.inject(Go),{tooltip:p,tooltipVisible:m,formatValue:y,displayTooltip:E,hideTooltip:A}=F0(r,d,a),_=u.ref(),x=u.computed(()=>`${(r.modelValue-i.value)/(s.value-i.value)*100}%`),v=u.computed(()=>r.vertical?{bottom:x.value}:{left:x.value}),T=()=>{e.hovering=!0,E()},C=()=>{e.hovering=!1,e.dragging||A()},k=N=>{n.value||(N.preventDefault(),D(N),window.addEventListener("mousemove",F),window.addEventListener("touchmove",F),window.addEventListener("mouseup",U),window.addEventListener("touchend",U),window.addEventListener("contextmenu",U),_.value.focus())},B=N=>{n.value||(e.newPosition=Number.parseFloat(x.value)+N/(s.value-i.value)*100,K(e.newPosition),f())},R=()=>{B(-o.value)},I=()=>{B(o.value)},S=()=>{B(-o.value*4)},L=()=>{B(o.value*4)},b=()=>{n.value||(K(0),f())},w=()=>{n.value||(K(100),f())},M=N=>{let G=!0;[R0,w0].includes(N.key)?R():[k0,D0].includes(N.key)?I():N.key===O0?b():N.key===P0?w():N.key===M0?S():N.key===B0?L():G=!1,G&&N.preventDefault()},O=N=>{let G,H;return N.type.startsWith("touch")?(H=N.touches[0].clientY,G=N.touches[0].clientX):(H=N.clientY,G=N.clientX),{clientX:G,clientY:H}},D=N=>{e.dragging=!0,e.isClick=!0;const{clientX:G,clientY:H}=O(N);r.vertical?e.startY=H:e.startX=G,e.startPosition=Number.parseFloat(x.value),e.newPosition=e.startPosition},F=N=>{if(e.dragging){e.isClick=!1,E(),h();let G;const{clientX:H,clientY:Z}=O(N);r.vertical?(e.currentY=Z,G=(e.startY-e.currentY)/c.value*100):(e.currentX=H,G=(e.currentX-e.startX)/c.value*100),e.newPosition=e.startPosition+G,K(e.newPosition)}},U=()=>{e.dragging&&(setTimeout(()=>{e.dragging=!1,e.hovering||A(),e.isClick||K(e.newPosition),f()},0),window.removeEventListener("mousemove",F),window.removeEventListener("touchmove",F),window.removeEventListener("mouseup",U),window.removeEventListener("touchend",U),window.removeEventListener("contextmenu",U))},K=async N=>{if(N===null||Number.isNaN(+N))return;N<0?N=0:N>100&&(N=100);const G=100/((s.value-i.value)/o.value);let Z=Math.round(N/G)*G*(s.value-i.value)*.01+i.value;Z=Number.parseFloat(Z.toFixed(l.value)),Z!==r.modelValue&&t(qe,Z),!e.dragging&&r.modelValue!==e.oldValue&&(e.oldValue=r.modelValue),await u.nextTick(),e.dragging&&E(),p.value.updatePopper()};return u.watch(()=>e.dragging,N=>{g(N)}),{disabled:n,button:_,tooltip:p,tooltipVisible:m,showTooltip:a,wrapperStyle:v,formatValue:y,handleMouseEnter:T,handleMouseLeave:C,onButtonDown:k,onKeyDown:M,setPosition:K}},U0=(r,e,t,n)=>({stops:u.computed(()=>{if(!r.showStops||r.min>r.max)return[];if(r.step===0)return He("ElSlider","step should not be 0."),[];const o=(r.max-r.min)/r.step,a=100*r.step/(r.max-r.min),l=Array.from({length:o-1}).map((c,d)=>(d+1)*a);return r.range?l.filter(c=>c<100*(t.value-r.min)/(r.max-r.min)||c>100*(n.value-r.min)/(r.max-r.min)):l.filter(c=>c>100*(e.firstValue-r.min)/(r.max-r.min))}),getStopStyle:o=>r.vertical?{bottom:`${o}%`}:{left:`${o}%`}}),V0=(r,e,t,n,i,s)=>{const o=c=>{i(qe,c),i(It,c)},a=()=>r.range?![t.value,n.value].every((c,d)=>c===e.oldValue[d]):r.modelValue!==e.oldValue,l=()=>{var c,d;r.min>r.max&&Vs("Slider","min should not be greater than max.");const f=r.modelValue;r.range&&Array.isArray(f)?f[1]<r.min?o([r.min,r.min]):f[0]>r.max?o([r.max,r.max]):f[0]<r.min?o([r.min,f[1]]):f[1]>r.max?o([f[0],r.max]):(e.firstValue=f[0],e.secondValue=f[1],a()&&(r.validateEvent&&((c=s==null?void 0:s.validate)==null||c.call(s,"change").catch(h=>He(h))),e.oldValue=f.slice())):!r.range&&typeof f=="number"&&!Number.isNaN(f)&&(f<r.min?o(r.min):f>r.max?o(r.max):(e.firstValue=f,a()&&(r.validateEvent&&((d=s==null?void 0:s.validate)==null||d.call(s,"change").catch(h=>He(h))),e.oldValue=f)))};l(),u.watch(()=>e.dragging,c=>{c||l()}),u.watch(()=>r.modelValue,(c,d)=>{e.dragging||Array.isArray(c)&&Array.isArray(d)&&c.every((f,h)=>f===d[h])&&e.firstValue===c[0]&&e.secondValue===c[1]||l()},{deep:!0}),u.watch(()=>[r.min,r.max],()=>{l()})},K0=Ue({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Pn,default:"top"}}),G0={[qe]:r=>Ne(r)},j0=["tabindex"],H0=u.defineComponent({name:"ElSliderButton"}),W0=u.defineComponent({...H0,props:K0,emits:G0,setup(r,{expose:e,emit:t}){const n=r,i=$e("slider"),s=u.reactive({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:n.modelValue}),{disabled:o,button:a,tooltip:l,showTooltip:c,tooltipVisible:d,wrapperStyle:f,formatValue:h,handleMouseEnter:g,handleMouseLeave:p,onButtonDown:m,onKeyDown:y,setPosition:E}=N0(n,s,t),{hovering:A,dragging:_}=u.toRefs(s);return e({onButtonDown:m,onKeyDown:y,setPosition:E,hovering:A,dragging:_}),(x,v)=>(u.openBlock(),u.createElementBlock("div",{ref_key:"button",ref:a,class:u.normalizeClass([u.unref(i).e("button-wrapper"),{hover:u.unref(A),dragging:u.unref(_)}]),style:u.normalizeStyle(u.unref(f)),tabindex:u.unref(o)?-1:0,onMouseenter:v[0]||(v[0]=(...T)=>u.unref(g)&&u.unref(g)(...T)),onMouseleave:v[1]||(v[1]=(...T)=>u.unref(p)&&u.unref(p)(...T)),onMousedown:v[2]||(v[2]=(...T)=>u.unref(m)&&u.unref(m)(...T)),onTouchstart:v[3]||(v[3]=(...T)=>u.unref(m)&&u.unref(m)(...T)),onFocus:v[4]||(v[4]=(...T)=>u.unref(g)&&u.unref(g)(...T)),onBlur:v[5]||(v[5]=(...T)=>u.unref(p)&&u.unref(p)(...T)),onKeydown:v[6]||(v[6]=(...T)=>u.unref(y)&&u.unref(y)(...T))},[u.createVNode(u.unref(ci),{ref_key:"tooltip",ref:l,visible:u.unref(d),placement:x.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":x.tooltipClass,disabled:!u.unref(c),persistent:""},{content:u.withCtx(()=>[u.createElementVNode("span",null,u.toDisplayString(u.unref(h)),1)]),default:u.withCtx(()=>[u.createElementVNode("div",{class:u.normalizeClass([u.unref(i).e("button"),{hover:u.unref(A),dragging:u.unref(_)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled"])],46,j0))}});var jo=We(W0,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/button.vue"]]);const Q0=Ue({mark:{type:ge([String,Object]),default:void 0}});var J0=u.defineComponent({name:"ElSliderMarker",props:Q0,setup(r){const e=$e("slider"),t=u.computed(()=>ut(r.mark)?r.mark:r.mark.label),n=u.computed(()=>ut(r.mark)?void 0:r.mark.style);return()=>u.h("div",{class:e.e("marks-text"),style:n.value},t.value)}});const Y0=["id","role","aria-label","aria-labelledby"],z0={key:1},q0=u.defineComponent({name:"ElSlider"}),Z0=u.defineComponent({...q0,props:T0,emits:I0,setup(r,{expose:e,emit:t}){const n=r,i=$e("slider"),{t:s}=Ws(),o=u.reactive({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:a,slider:l,firstButton:c,secondButton:d,sliderDisabled:f,minValue:h,maxValue:g,runwayStyle:p,barStyle:m,resetSize:y,emitChange:E,onSliderWrapperPrevent:A,onSliderClick:_,onSliderDown:x,setFirstValue:v,setSecondValue:T}=L0(n,o,t),{stops:C,getStopStyle:k}=U0(n,o,h,g),{inputId:B,isLabeledByFormItem:R}=ni(n,{formItemContext:a}),I=lr(),S=u.computed(()=>n.inputSize||I.value),L=u.computed(()=>n.label||s("el.slider.defaultLabel",{min:n.min,max:n.max})),b=u.computed(()=>n.range?n.rangeStartLabel||s("el.slider.defaultRangeStartLabel"):L.value),w=u.computed(()=>n.formatValueText?n.formatValueText(N.value):`${N.value}`),M=u.computed(()=>n.rangeEndLabel||s("el.slider.defaultRangeEndLabel")),O=u.computed(()=>n.formatValueText?n.formatValueText(G.value):`${G.value}`),D=u.computed(()=>[i.b(),i.m(I.value),i.is("vertical",n.vertical),{[i.m("with-input")]:n.showInput}]),F=C0(n);V0(n,o,h,g,t,a);const U=u.computed(()=>{const J=[n.min,n.max,n.step].map(X=>{const ne=`${X}`.split(".")[1];return ne?ne.length:0});return Math.max.apply(null,J)}),{sliderWrapper:K}=b0(n,o,y),{firstValue:N,secondValue:G,sliderSize:H}=u.toRefs(o),Z=J=>{o.dragging=J};return u.provide(Go,{...u.toRefs(n),sliderSize:H,disabled:f,precision:U,emitChange:E,resetSize:y,updateDragging:Z}),e({onSliderClick:_}),(J,X)=>{var ne,ce;return u.openBlock(),u.createElementBlock("div",{id:J.range?u.unref(B):void 0,ref_key:"sliderWrapper",ref:K,class:u.normalizeClass(u.unref(D)),role:J.range?"group":void 0,"aria-label":J.range&&!u.unref(R)?u.unref(L):void 0,"aria-labelledby":J.range&&u.unref(R)?(ne=u.unref(a))==null?void 0:ne.labelId:void 0,onTouchstart:X[2]||(X[2]=(...re)=>u.unref(A)&&u.unref(A)(...re)),onTouchmove:X[3]||(X[3]=(...re)=>u.unref(A)&&u.unref(A)(...re))},[u.createElementVNode("div",{ref_key:"slider",ref:l,class:u.normalizeClass([u.unref(i).e("runway"),{"show-input":J.showInput&&!J.range},u.unref(i).is("disabled",u.unref(f))]),style:u.normalizeStyle(u.unref(p)),onMousedown:X[0]||(X[0]=(...re)=>u.unref(x)&&u.unref(x)(...re)),onTouchstart:X[1]||(X[1]=(...re)=>u.unref(x)&&u.unref(x)(...re))},[u.createElementVNode("div",{class:u.normalizeClass(u.unref(i).e("bar")),style:u.normalizeStyle(u.unref(m))},null,6),u.createVNode(jo,{id:J.range?void 0:u.unref(B),ref_key:"firstButton",ref:c,"model-value":u.unref(N),vertical:J.vertical,"tooltip-class":J.tooltipClass,placement:J.placement,role:"slider","aria-label":J.range||!u.unref(R)?u.unref(b):void 0,"aria-labelledby":!J.range&&u.unref(R)?(ce=u.unref(a))==null?void 0:ce.labelId:void 0,"aria-valuemin":J.min,"aria-valuemax":J.range?u.unref(G):J.max,"aria-valuenow":u.unref(N),"aria-valuetext":u.unref(w),"aria-orientation":J.vertical?"vertical":"horizontal","aria-disabled":u.unref(f),"onUpdate:modelValue":u.unref(v)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),J.range?(u.openBlock(),u.createBlock(jo,{key:0,ref_key:"secondButton",ref:d,"model-value":u.unref(G),vertical:J.vertical,"tooltip-class":J.tooltipClass,placement:J.placement,role:"slider","aria-label":u.unref(M),"aria-valuemin":u.unref(N),"aria-valuemax":J.max,"aria-valuenow":u.unref(G),"aria-valuetext":u.unref(O),"aria-orientation":J.vertical?"vertical":"horizontal","aria-disabled":u.unref(f),"onUpdate:modelValue":u.unref(T)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):u.createCommentVNode("v-if",!0),J.showStops?(u.openBlock(),u.createElementBlock("div",z0,[(u.openBlock(!0),u.createElementBlock(u.Fragment,null,u.renderList(u.unref(C),(re,Ee)=>(u.openBlock(),u.createElementBlock("div",{key:Ee,class:u.normalizeClass(u.unref(i).e("stop")),style:u.normalizeStyle(u.unref(k)(re))},null,6))),128))])):u.createCommentVNode("v-if",!0),u.unref(F).length>0?(u.openBlock(),u.createElementBlock(u.Fragment,{key:2},[u.createElementVNode("div",null,[(u.openBlock(!0),u.createElementBlock(u.Fragment,null,u.renderList(u.unref(F),(re,Ee)=>(u.openBlock(),u.createElementBlock("div",{key:Ee,style:u.normalizeStyle(u.unref(k)(re.position)),class:u.normalizeClass([u.unref(i).e("stop"),u.unref(i).e("marks-stop")])},null,6))),128))]),u.createElementVNode("div",{class:u.normalizeClass(u.unref(i).e("marks"))},[(u.openBlock(!0),u.createElementBlock(u.Fragment,null,u.renderList(u.unref(F),(re,Ee)=>(u.openBlock(),u.createBlock(u.unref(J0),{key:Ee,mark:re.mark,style:u.normalizeStyle(u.unref(k)(re.position))},null,8,["mark","style"]))),128))],2)],64)):u.createCommentVNode("v-if",!0)],38),J.showInput&&!J.range?(u.openBlock(),u.createBlock(u.unref(p0),{key:0,ref:"input","model-value":u.unref(N),class:u.normalizeClass(u.unref(i).e("input")),step:J.step,disabled:u.unref(f),controls:J.showInputControls,min:J.min,max:J.max,debounce:J.debounce,size:u.unref(S),"onUpdate:modelValue":u.unref(v),onChange:u.unref(E)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):u.createCommentVNode("v-if",!0)],42,Y0)}}});var X0=We(Z0,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/slider.vue"]]);const $0=Vt(X0),eg=Ue({modelValue:{type:[Boolean,String,Number],default:!1},value:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},activeIcon:{type:Rn},inactiveIcon:{type:Rn},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},id:String,loading:{type:Boolean,default:!1},beforeChange:{type:ge(Function)},size:{type:String,validator:Xd},tabindex:{type:[String,Number]}}),tg={[qe]:r=>Yt(r)||ut(r)||Ne(r),[zt]:r=>Yt(r)||ut(r)||Ne(r),[It]:r=>Yt(r)||ut(r)||Ne(r)},ng=["onClick"],rg=["id","aria-checked","aria-disabled","name","true-value","false-value","disabled","tabindex","onKeydown"],ig=["aria-hidden"],sg=["aria-hidden"],og=["aria-hidden"],pr="ElSwitch",ag=u.defineComponent({name:pr}),lg=u.defineComponent({...ag,props:eg,emits:tg,setup(r,{expose:e,emit:t}){const n=r,i=u.getCurrentInstance(),{formItem:s}=ur(),o=lr(),a=$e("switch");sf({from:'"value"',replacement:'"model-value" or "v-model"',scope:pr,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},u.computed(()=>{var v;return!!((v=i.vnode.props)!=null&&v.value)}));const{inputId:l}=ni(n,{formItemContext:s}),c=ti(u.computed(()=>n.loading)),d=u.ref(n.modelValue!==!1),f=u.ref(),h=u.ref(),g=u.computed(()=>[a.b(),a.m(o.value),a.is("disabled",c.value),a.is("checked",y.value)]),p=u.computed(()=>({width:Gr(n.width)}));u.watch(()=>n.modelValue,()=>{d.value=!0}),u.watch(()=>n.value,()=>{d.value=!1});const m=u.computed(()=>d.value?n.modelValue:n.value),y=u.computed(()=>m.value===n.activeValue);[n.activeValue,n.inactiveValue].includes(m.value)||(t(qe,n.inactiveValue),t(zt,n.inactiveValue),t(It,n.inactiveValue)),u.watch(y,v=>{var T;f.value.checked=v,n.validateEvent&&((T=s==null?void 0:s.validate)==null||T.call(s,"change").catch(C=>He(C)))});const E=()=>{const v=y.value?n.inactiveValue:n.activeValue;t(qe,v),t(zt,v),t(It,v),u.nextTick(()=>{f.value.checked=y.value})},A=()=>{if(c.value)return;const{beforeChange:v}=n;if(!v){E();return}const T=v();[Cs(T),Yt(T)].includes(!0)||Vs(pr,"beforeChange must return type `Promise<boolean>` or `boolean`"),Cs(T)?T.then(k=>{k&&E()}).catch(k=>{He(pr,`some error occurred: ${k}`)}):T&&E()},_=u.computed(()=>a.cssVarBlock({...n.activeColor?{"on-color":n.activeColor}:null,...n.inactiveColor?{"off-color":n.inactiveColor}:null,...n.borderColor?{"border-color":n.borderColor}:null})),x=()=>{var v,T;(T=(v=f.value)==null?void 0:v.focus)==null||T.call(v)};return u.onMounted(()=>{f.value.checked=y.value}),e({focus:x,checked:y}),(v,T)=>(u.openBlock(),u.createElementBlock("div",{class:u.normalizeClass(u.unref(g)),style:u.normalizeStyle(u.unref(_)),onClick:u.withModifiers(A,["prevent"])},[u.createElementVNode("input",{id:u.unref(l),ref_key:"input",ref:f,class:u.normalizeClass(u.unref(a).e("input")),type:"checkbox",role:"switch","aria-checked":u.unref(y),"aria-disabled":u.unref(c),name:v.name,"true-value":v.activeValue,"false-value":v.inactiveValue,disabled:u.unref(c),tabindex:v.tabindex,onChange:E,onKeydown:u.withKeys(A,["enter"])},null,42,rg),!v.inlinePrompt&&(v.inactiveIcon||v.inactiveText)?(u.openBlock(),u.createElementBlock("span",{key:0,class:u.normalizeClass([u.unref(a).e("label"),u.unref(a).em("label","left"),u.unref(a).is("active",!u.unref(y))])},[v.inactiveIcon?(u.openBlock(),u.createBlock(u.unref(Et),{key:0},{default:u.withCtx(()=>[(u.openBlock(),u.createBlock(u.resolveDynamicComponent(v.inactiveIcon)))]),_:1})):u.createCommentVNode("v-if",!0),!v.inactiveIcon&&v.inactiveText?(u.openBlock(),u.createElementBlock("span",{key:1,"aria-hidden":u.unref(y)},u.toDisplayString(v.inactiveText),9,ig)):u.createCommentVNode("v-if",!0)],2)):u.createCommentVNode("v-if",!0),u.createElementVNode("span",{ref_key:"core",ref:h,class:u.normalizeClass(u.unref(a).e("core")),style:u.normalizeStyle(u.unref(p))},[v.inlinePrompt?(u.openBlock(),u.createElementBlock("div",{key:0,class:u.normalizeClass(u.unref(a).e("inner"))},[v.activeIcon||v.inactiveIcon?(u.openBlock(),u.createBlock(u.unref(Et),{key:0,class:u.normalizeClass(u.unref(a).is("icon"))},{default:u.withCtx(()=>[(u.openBlock(),u.createBlock(u.resolveDynamicComponent(u.unref(y)?v.activeIcon:v.inactiveIcon)))]),_:1},8,["class"])):v.activeText||v.inactiveText?(u.openBlock(),u.createElementBlock("span",{key:1,class:u.normalizeClass(u.unref(a).is("text")),"aria-hidden":!u.unref(y)},u.toDisplayString(u.unref(y)?v.activeText:v.inactiveText),11,sg)):u.createCommentVNode("v-if",!0)],2)):u.createCommentVNode("v-if",!0),u.createElementVNode("div",{class:u.normalizeClass(u.unref(a).e("action"))},[v.loading?(u.openBlock(),u.createBlock(u.unref(Et),{key:0,class:u.normalizeClass(u.unref(a).is("loading"))},{default:u.withCtx(()=>[u.createVNode(u.unref(Gs))]),_:1},8,["class"])):u.createCommentVNode("v-if",!0)],2)],6),!v.inlinePrompt&&(v.activeIcon||v.activeText)?(u.openBlock(),u.createElementBlock("span",{key:1,class:u.normalizeClass([u.unref(a).e("label"),u.unref(a).em("label","right"),u.unref(a).is("active",u.unref(y))])},[v.activeIcon?(u.openBlock(),u.createBlock(u.unref(Et),{key:0},{default:u.withCtx(()=>[(u.openBlock(),u.createBlock(u.resolveDynamicComponent(v.activeIcon)))]),_:1})):u.createCommentVNode("v-if",!0),!v.activeIcon&&v.activeText?(u.openBlock(),u.createElementBlock("span",{key:1,"aria-hidden":!u.unref(y)},u.toDisplayString(v.activeText),9,og)):u.createCommentVNode("v-if",!0)],2)):u.createCommentVNode("v-if",!0)],14,ng))}});var ug=We(lg,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const cg=Vt(ug),Vv="",Kv="",Gv="",jv="",Hv="",Wv="",Qv="",Jv="",dg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAFQElEQVRoge2W228UVRzHv78z07l0L6Vt1hZ8gMpqgaWUaNSaIFowxGBibEqNMTxoTDTGR5/1P/ClDz4Zn7ylSBoeQKKWcolXCKGV1tKWUhIMUkrY3e5lZs7MOT50Nymw053dbSkx/b5scn5nfvv5/n7nBqxrXeta11qK1vLPe27ITsnQS8AeSWiHREuBaR7ANQAXCfhF3YjvjhB5pXKsiYFXr7oHdZ19Qoy6gswn4PDgJvq6VIytLFoZSckOTDhDuqEcDwoPAALY4xd7aAbiJ6T+7NnU98SwjyrsOxE6/WJqrWBBlBiTWv18egCg1z1XVvy9lGjzi626gfgJqZvz6aMAXgMA4VVugIBGv9iqLqHEmNQaQ+kBKsAD1RkAUPIEAlaxA/dXvighqjJwxy+wKh0oVfmilnbAsVzMXpqD6/gWeFGESb/QinfAr/JFyYIBO8fx28AEFu5YABG2dMZ8cxJw1i+2oh2In5D6hlD6aKnKFyWEhJ3j+H1gHJn5HCLNBja1++7RxW8Ig36xFbuJg8ADgMc9zP4xi/R8HuGmELre2gEjVOc7X0qcPfY4veQXX5ElFP/qTnRDffpbAg4uN8+1XUyfm4GVthBprsfz5eEhhPvpcjlrNtB+7HbEytiTUigtpPg31LVdXD03DTtlQY+a2PLCFiTnbCiKA1IITCEwVvhVCEwlwMPwj9u1M6tmYBGeTzk5t0V4EszHgGdzzJyZgpVehI+/+ARUTYXnCniuX3Y5eH5vw6FyDFVv4sTwXNha4JNOzm0BAOEJX/irp6/ASmVhhDXE98ahGv7LBgBAOBkSDW+DqHTSJarKQGJ4Lpz5x51y8m5rcazUDevZHDPDf8NOZaGHDWx9uT0YvBftOd1NVhCWig0kBqSWueFOLoUHHrxhPZtj5tQ47GQBvntbWXgJHL+bib4RFB6oYg/kxc1fHcvdeP+4t6QDnsVxbfgv2Mkc9IYQ2vZtDwSfzEZ7pw+SXQlPRR3YOnDr/fyC+0ypmCg8kz2L49qpUdh3M9CjJtr2JaAa2vKJCSfDInqoUnigwg5w2/3ML+Z5Ep7lYPbnETipLLSGENr2d5SFl8DxZCbae74KeKCCDjx59OY73PLCfnHXcnD9p4uwkwvQIibaXukMBl/FslmqwB1wHXzgC8I5kpevwMvmoEcj2Hxgd7Bl40UPXagBHqjAgMdFotS45Bz58XGIXB5KqB6RXduQTgooqgXGCIp63w2rMJBCNS2bag08sHwk57DGxiByObB6E+a27XA4weGObx7NUOYbw/WHp3tqhwcC7oHE8FxYCHnPO0FyB9blUYhsBoppwNyxE6Qtf1RqunJb0c34pZ7GZA3M9yiQgexs7J4Xi+QOrNERyGwGzNRhJDrKwxvKfGOk/qmZN5tSNfA+oEAGZt8liwozJXdgj14Cchkww4Sxs3NNKl9U4GNUVZklHQfOyEXI7ALIMGHs2g3Slj9tdFO9WceM+EpXvqjABojzOWfkAmQmDWaaMDqfBsrAGyH1z+bsxs3Th5vTNZP6cQWZFO77MmZElQmRt5sQCkPf/dyy8HW6mtZCdR9P98a+WDFSH5U9Rlv7+mNctYdEjprINJLhrq6UULXHPFeYsvBaZwoJRWVZtY5GFY19PtXb+s1qgxe1rIHWvv4YZ2wIUnYQYYItZLuvv/fEvw8LLogUv0BrX3+ME4aI0AFggnnovn3ko0cKHvDpQGtff8yDHCIU4AV7JOEBHwNSej8A6CDQZca1/bcGP5x7yFyBVfIYlcLLA/ICc/kjDb+uda3rf6D/AMizOvqVjqIFAAAAAElFTkSuQmCC",fg="data:image/png;base64,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",hg="data:image/png;base64,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",pg="data:image/png;base64,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",gg="data:image/png;base64,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",mg="data:image/png;base64,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",yg="data:image/png;base64,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",Eg="data:image/png;base64,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",vg="data:image/png;base64,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",Ag="data:image/png;base64,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",_g="data:image/png;base64,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",xg="data:image/png;base64,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",Sg="data:image/png;base64,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";function pn(r){"@babel/helpers - typeof";return pn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(r)}function Ho(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return s}function Wo(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||e)}var Tg=function(r,e){var t=Date.now();return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=Date.now();s-t<e||(t=s,r.call.apply(r,Wo([this],Ho(n))))}},Qo=function(){function r(e){this.memoryCache=new Map,this.timer={},this.maxCache=(e==null?void 0:e.maxCache)||1e3}return r.prototype.put=function(e,t,n,i){var s=this;if(!e||!t)throw new Error("key & value is required");this.size()>=this.maxCache&&this.del(Wo([],Ho(this.memoryCache))[0][0]),this.memoryCache.set(e,t),n&&typeof n=="number"&&n>0&&(this.timer[e]=setTimeout(function(){s.del(e),delete s.timer[e],i&&i()},n))},r.prototype.get=function(e){return this.has(e)?this.memoryCache.get(e):null},r.prototype.has=function(e){return this.memoryCache.has(e)},r.prototype.del=function(e){this.has(e)&&(this.timer[e]&&(clearTimeout(this.timer[e]),delete this.timer[e]),this.memoryCache.delete(e))},r.prototype.clear=function(){if(!(this.size()<=0)){this.memoryCache.clear();for(var e in this.timer)clearTimeout(this.timer[e]),delete this.timer[e]}},r.prototype.size=function(){return this.memoryCache.size},r}();new Qo,new Qo;var gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ig={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(gn,function(){var t=1e3,n=6e4,i=36e5,s="millisecond",o="second",a="minute",l="hour",c="day",d="week",f="month",h="quarter",g="year",p="date",m="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,A={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},_=function(b,w,M){var O=String(b);return!O||O.length>=w?b:""+Array(w+1-O.length).join(M)+b},x={s:_,z:function(b){var w=-b.utcOffset(),M=Math.abs(w),O=Math.floor(M/60),D=M%60;return(w<=0?"+":"-")+_(O,2,"0")+":"+_(D,2,"0")},m:function L(b,w){if(b.date()<w.date())return-L(w,b);var M=12*(w.year()-b.year())+(w.month()-b.month()),O=b.clone().add(M,f),D=w-O<0,F=b.clone().add(M+(D?-1:1),f);return+(-(M+(w-O)/(D?O-F:F-O))||0)},a:function(b){return b<0?Math.ceil(b)||0:Math.floor(b)},p:function(b){return{M:f,y:g,w:d,d:c,D:p,h:l,m:a,s:o,ms:s,Q:h}[b]||String(b||"").toLowerCase().replace(/s$/,"")},u:function(b){return b===void 0}},v="en",T={};T[v]=A;var C=function(b){return b instanceof I},k=function(b,w,M){var O;if(!b)return v;if(typeof b=="string")T[b]&&(O=b),w&&(T[b]=w,O=b);else{var D=b.name;T[D]=b,O=D}return!M&&O&&(v=O),O||!M&&v},B=function(b,w){if(C(b))return b.clone();var M=pn(w)=="object"?w:{};return M.date=b,M.args=arguments,new I(M)},R=x;R.l=k,R.i=C,R.w=function(L,b){return B(L,{locale:b.$L,utc:b.$u,x:b.$x,$offset:b.$offset})};var I=function(){function L(w){this.$L=k(w.locale,null,!0),this.parse(w)}var b=L.prototype;return b.parse=function(w){this.$d=function(M){var O=M.date,D=M.utc;if(O===null)return new Date(NaN);if(R.u(O))return new Date;if(O instanceof Date)return new Date(O);if(typeof O=="string"&&!/Z$/i.test(O)){var F=O.match(y);if(F){var U=F[2]-1||0,K=(F[7]||"0").substring(0,3);return D?new Date(Date.UTC(F[1],U,F[3]||1,F[4]||0,F[5]||0,F[6]||0,K)):new Date(F[1],U,F[3]||1,F[4]||0,F[5]||0,F[6]||0,K)}}return new Date(O)}(w),this.$x=w.x||{},this.init()},b.init=function(){var w=this.$d;this.$y=w.getFullYear(),this.$M=w.getMonth(),this.$D=w.getDate(),this.$W=w.getDay(),this.$H=w.getHours(),this.$m=w.getMinutes(),this.$s=w.getSeconds(),this.$ms=w.getMilliseconds()},b.$utils=function(){return R},b.isValid=function(){return this.$d.toString()!==m},b.isSame=function(w,M){var O=B(w);return this.startOf(M)<=O&&O<=this.endOf(M)},b.isAfter=function(w,M){return B(w)<this.startOf(M)},b.isBefore=function(w,M){return this.endOf(M)<B(w)},b.$g=function(w,M,O){return R.u(w)?this[M]:this.set(O,w)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(w,M){var O=this,D=!!R.u(M)||M,F=R.p(w),U=function(ce,re){var Ee=R.w(O.$u?Date.UTC(O.$y,re,ce):new Date(O.$y,re,ce),O);return D?Ee:Ee.endOf(c)},K=function(ce,re){return R.w(O.toDate()[ce].apply(O.toDate("s"),(D?[0,0,0,0]:[23,59,59,999]).slice(re)),O)},N=this.$W,G=this.$M,H=this.$D,Z="set"+(this.$u?"UTC":"");switch(F){case g:return D?U(1,0):U(31,11);case f:return D?U(1,G):U(0,G+1);case d:var J=this.$locale().weekStart||0,X=(N<J?N+7:N)-J;return U(D?H-X:H+(6-X),G);case c:case p:return K(Z+"Hours",0);case l:return K(Z+"Minutes",1);case a:return K(Z+"Seconds",2);case o:return K(Z+"Milliseconds",3);default:return this.clone()}},b.endOf=function(w){return this.startOf(w,!1)},b.$set=function(w,M){var O,D=R.p(w),F="set"+(this.$u?"UTC":""),U=(O={},O[c]=F+"Date",O[p]=F+"Date",O[f]=F+"Month",O[g]=F+"FullYear",O[l]=F+"Hours",O[a]=F+"Minutes",O[o]=F+"Seconds",O[s]=F+"Milliseconds",O)[D],K=D===c?this.$D+(M-this.$W):M;if(D===f||D===g){var N=this.clone().set(p,1);N.$d[U](K),N.init(),this.$d=N.set(p,Math.min(this.$D,N.daysInMonth())).$d}else U&&this.$d[U](K);return this.init(),this},b.set=function(w,M){return this.clone().$set(w,M)},b.get=function(w){return this[R.p(w)]()},b.add=function(w,M){var O,D=this;w=Number(w);var F=R.p(M),U=function(H){var Z=B(D);return R.w(Z.date(Z.date()+Math.round(H*w)),D)};if(F===f)return this.set(f,this.$M+w);if(F===g)return this.set(g,this.$y+w);if(F===c)return U(1);if(F===d)return U(7);var K=(O={},O[a]=n,O[l]=i,O[o]=t,O)[F]||1,N=this.$d.getTime()+w*K;return R.w(N,this)},b.subtract=function(w,M){return this.add(-1*w,M)},b.format=function(w){var M=this,O=this.$locale();if(!this.isValid())return O.invalidDate||m;var D=w||"YYYY-MM-DDTHH:mm:ssZ",F=R.z(this),U=this.$H,K=this.$m,N=this.$M,G=O.weekdays,H=O.months,Z=function(re,Ee,se,ee){return re&&(re[Ee]||re(M,D))||se[Ee].substr(0,ee)},J=function(re){return R.s(U%12||12,re,"0")},X=O.meridiem||function(ce,re,Ee){var se=ce<12?"AM":"PM";return Ee?se.toLowerCase():se},ne={YY:String(this.$y).slice(-2),YYYY:this.$y,M:N+1,MM:R.s(N+1,2,"0"),MMM:Z(O.monthsShort,N,H,3),MMMM:Z(H,N),D:this.$D,DD:R.s(this.$D,2,"0"),d:String(this.$W),dd:Z(O.weekdaysMin,this.$W,G,2),ddd:Z(O.weekdaysShort,this.$W,G,3),dddd:G[this.$W],H:String(U),HH:R.s(U,2,"0"),h:J(1),hh:J(2),a:X(U,K,!0),A:X(U,K,!1),m:String(K),mm:R.s(K,2,"0"),s:String(this.$s),ss:R.s(this.$s,2,"0"),SSS:R.s(this.$ms,3,"0"),Z:F};return D.replace(E,function(ce,re){return re||ne[ce]||F.replace(":","")})},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(w,M,O){var D,F=R.p(M),U=B(w),K=(U.utcOffset()-this.utcOffset())*n,N=this-U,G=R.m(this,U);return G=(D={},D[g]=G/12,D[f]=G,D[h]=G/3,D[d]=(N-K)/6048e5,D[c]=(N-K)/864e5,D[l]=N/i,D[a]=N/n,D[o]=N/t,D)[F]||N,O?G:R.a(G)},b.daysInMonth=function(){return this.endOf(f).$D},b.$locale=function(){return T[this.$L]},b.locale=function(w,M){if(!w)return this.$L;var O=this.clone(),D=k(w,M,!0);return D&&(O.$L=D),O},b.clone=function(){return R.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},L}(),S=I.prototype;return B.prototype=S,[["$ms",s],["$s",o],["$m",a],["$H",l],["$W",c],["$M",f],["$y",g],["$D",p]].forEach(function(L){S[L[1]]=function(b){return this.$g(b,L[0],L[1])}}),B.extend=function(L,b){return L.$i||(L(b,I,B),L.$i=!0),B},B.locale=k,B.isDayjs=C,B.unix=function(L){return B(1e3*L)},B.en=T[v],B.Ls=T,B.p={},B})})(Ig);var bg=1e3,Cg=function(r,e){var t=Tg(r,typeof e=="number"?e:bg);return{run:t}},Lg={exports:{}};/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */(function(r,e){(function(t){var n;if(r.exports=t(),n=!0,!n){var i=window.Cookies,s=window.Cookies=t();s.noConflict=function(){return window.Cookies=i,s}}})(function(){function t(){for(var s=0,o={};s<arguments.length;s++){var a=arguments[s];for(var l in a)o[l]=a[l]}return o}function n(s){return s.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function i(s){function o(){}function a(c,d,f){if(!(typeof document>"u")){f=t({path:"/"},o.defaults,f),typeof f.expires=="number"&&(f.expires=new Date(new Date*1+f.expires*864e5)),f.expires=f.expires?f.expires.toUTCString():"";try{var h=JSON.stringify(d);/^[\{\[]/.test(h)&&(d=h)}catch{}d=s.write?s.write(d,c):encodeURIComponent(String(d)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),c=encodeURIComponent(String(c)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var g="";for(var p in f)f[p]&&(g+="; "+p,f[p]!==!0&&(g+="="+f[p].split(";")[0]));return document.cookie=c+"="+d+g}}function l(c,d){if(!(typeof document>"u")){for(var f={},h=document.cookie?document.cookie.split("; "):[],g=0;g<h.length;g++){var p=h[g].split("="),m=p.slice(1).join("=");!d&&m.charAt(0)==='"'&&(m=m.slice(1,-1));try{var y=n(p[0]);if(m=(s.read||s)(m,y)||n(m),d)try{m=JSON.parse(m)}catch{}if(f[y]=m,c===y)break}catch{}}return c?f[c]:f}}return o.set=a,o.get=function(c){return l(c,!1)},o.getJSON=function(c){return l(c,!0)},o.remove=function(c,d){a(c,"",t(d,{expires:-1}))},o.defaults={},o.withConverter=i,o}return i(function(){})})})(Lg);var hi={exports:{}};(function(r,e){(function(){function t(h,g){var p,m=Object.keys(g);for(p=0;p<m.length;p++)h=h.replace(new RegExp("\\{"+m[p]+"\\}","gi"),g[m[p]]);return h}function n(h){var g,p,m;if(!h)throw new Error("cannot create a random attribute name for an undefined object");g="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",p="";do for(p="",m=0;m<12;m++)p+=g[Math.floor(Math.random()*g.length)];while(h[p]);return p}function i(h){var g={left:"start",right:"end",center:"middle",start:"start",end:"end"};return g[h]||g.start}function s(h){var g={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return g[h]||g.alphabetic}var o,a,l,c,d;d=function(h,g){var p,m,y,E={};for(h=h.split(","),g=g||10,p=0;p<h.length;p+=2)m="&"+h[p+1]+";",y=parseInt(h[p],g),E[m]="&#"+y+";";return E["\\xa0"]="&#160;",E}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),o={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},l=function(g,p){this.__root=g,this.__ctx=p},l.prototype.addColorStop=function(h,g){var p,m,y=this.__ctx.__createElement("stop");y.setAttribute("offset",h),g.indexOf("rgba")!==-1?(p=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,m=p.exec(g),y.setAttribute("stop-color",t("rgb({r},{g},{b})",{r:m[1],g:m[2],b:m[3]})),y.setAttribute("stop-opacity",m[4])):y.setAttribute("stop-color",g),this.__root.appendChild(y)},c=function(g,p){this.__root=g,this.__ctx=p},a=function(g){var p,m={width:500,height:500,enableMirroring:!1};if(arguments.length>1?(p=m,p.width=arguments[0],p.height=arguments[1]):p=g||m,!(this instanceof a))return new a(p);this.width=p.width||m.width,this.height=p.height||m.height,this.enableMirroring=p.enableMirroring!==void 0?p.enableMirroring:m.enableMirroring,this.canvas=this,this.__document=p.document||document,p.ctx?this.__ctx=p.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)},a.prototype.__createElement=function(h,g,p){g===void 0&&(g={});var m,y,E=this.__document.createElementNS("http://www.w3.org/2000/svg",h),A=Object.keys(g);for(p&&(E.setAttribute("fill","none"),E.setAttribute("stroke","none")),m=0;m<A.length;m++)y=A[m],E.setAttribute(y,g[y]);return E},a.prototype.__setDefaultStyles=function(){var h,g,p=Object.keys(o);for(h=0;h<p.length;h++)g=p[h],this[g]=o[g].canvas},a.prototype.__applyStyleState=function(h){var g,p,m=Object.keys(h);for(g=0;g<m.length;g++)p=m[g],this[p]=h[p]},a.prototype.__getStyleState=function(){var h,g,p={},m=Object.keys(o);for(h=0;h<m.length;h++)g=m[h],p[g]=this[g];return p},a.prototype.__applyStyleToCurrentElement=function(h){var g=this.__currentElement,p=this.__currentElementsToStyle;p&&(g.setAttribute(h,""),g=p.element,p.children.forEach(function(B){B.setAttribute(h,"")}));var m,y,E,A,_,x,v=Object.keys(o);for(m=0;m<v.length;m++)if(y=o[v[m]],E=this[v[m]],y.apply){if(E instanceof c){if(E.__ctx)for(;E.__ctx.__defs.childNodes.length;)A=E.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[A]=A,this.__defs.appendChild(E.__ctx.__defs.childNodes[0]);g.setAttribute(y.apply,t("url(#{id})",{id:E.__root.getAttribute("id")}))}else if(E instanceof l)g.setAttribute(y.apply,t("url(#{id})",{id:E.__root.getAttribute("id")}));else if(y.apply.indexOf(h)!==-1&&y.svg!==E)if(y.svgAttr!=="stroke"&&y.svgAttr!=="fill"||E.indexOf("rgba")===-1){var T=y.svgAttr;if(v[m]==="globalAlpha"&&(T=h+"-"+y.svgAttr,g.getAttribute(T)))continue;g.setAttribute(T,E)}else{_=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,x=_.exec(E),g.setAttribute(y.svgAttr,t("rgb({r},{g},{b})",{r:x[1],g:x[2],b:x[3]}));var C=x[4],k=this.globalAlpha;k!=null&&(C*=k),g.setAttribute(y.svgAttr+"-opacity",C)}}},a.prototype.__closestGroupOrSvg=function(h){return h=h||this.__currentElement,h.nodeName==="g"||h.nodeName==="svg"?h:this.__closestGroupOrSvg(h.parentNode)},a.prototype.getSerializedSvg=function(h){var g,p,m,y,E,A,_=new XMLSerializer().serializeToString(this.__root);if(A=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi,A.test(_)&&(_=_.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),h)for(g=Object.keys(d),p=0;p<g.length;p++)m=g[p],y=d[m],E=new RegExp(m,"gi"),E.test(_)&&(_=_.replace(E,y));return _},a.prototype.getSvg=function(){return this.__root},a.prototype.save=function(){var h=this.__createElement("g"),g=this.__closestGroupOrSvg();this.__groupStack.push(g),g.appendChild(h),this.__currentElement=h,this.__stack.push(this.__getStyleState())},a.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var h=this.__stack.pop();this.__applyStyleState(h)},a.prototype.__addTransform=function(h){var g=this.__closestGroupOrSvg();if(g.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:g,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var p=this.__createElement("g");g.appendChild(p),this.__currentElement=p}var m=this.__currentElement.getAttribute("transform");m?m+=" ":m="",m+=h,this.__currentElement.setAttribute("transform",m)},a.prototype.scale=function(h,g){g===void 0&&(g=h),this.__addTransform(t("scale({x},{y})",{x:h,y:g}))},a.prototype.rotate=function(h){var g=180*h/Math.PI;this.__addTransform(t("rotate({angle},{cx},{cy})",{angle:g,cx:0,cy:0}))},a.prototype.translate=function(h,g){this.__addTransform(t("translate({x},{y})",{x:h,y:g}))},a.prototype.transform=function(h,g,p,m,y,E){this.__addTransform(t("matrix({a},{b},{c},{d},{e},{f})",{a:h,b:g,c:p,d:m,e:y,f:E}))},a.prototype.beginPath=function(){var h,g;this.__currentDefaultPath="",this.__currentPosition={},h=this.__createElement("path",{},!0),g=this.__closestGroupOrSvg(),g.appendChild(h),this.__currentElement=h},a.prototype.__applyCurrentDefaultPath=function(){var h=this.__currentElement;h.nodeName==="path"?h.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",h.nodeName)},a.prototype.__addPathCommand=function(h){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=h},a.prototype.moveTo=function(h,g){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:h,y:g},this.__addPathCommand(t("M {x} {y}",{x:h,y:g}))},a.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")},a.prototype.lineTo=function(h,g){this.__currentPosition={x:h,y:g},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(t("L {x} {y}",{x:h,y:g})):this.__addPathCommand(t("M {x} {y}",{x:h,y:g}))},a.prototype.bezierCurveTo=function(h,g,p,m,y,E){this.__currentPosition={x:y,y:E},this.__addPathCommand(t("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:h,cp1y:g,cp2x:p,cp2y:m,x:y,y:E}))},a.prototype.quadraticCurveTo=function(h,g,p,m){this.__currentPosition={x:p,y:m},this.__addPathCommand(t("Q {cpx} {cpy} {x} {y}",{cpx:h,cpy:g,x:p,y:m}))};var f=function(g){var p=Math.sqrt(g[0]*g[0]+g[1]*g[1]);return[g[0]/p,g[1]/p]};a.prototype.arcTo=function(h,g,p,m,y){var E=this.__currentPosition&&this.__currentPosition.x,A=this.__currentPosition&&this.__currentPosition.y;if(E!==void 0&&A!==void 0){if(y<0)throw new Error("IndexSizeError: The radius provided ("+y+") is negative.");if(E===h&&A===g||h===p&&g===m||y===0)return void this.lineTo(h,g);var _=f([E-h,A-g]),x=f([p-h,m-g]);if(_[0]*x[1]==_[1]*x[0])return void this.lineTo(h,g);var v=_[0]*x[0]+_[1]*x[1],T=Math.acos(Math.abs(v)),C=f([_[0]+x[0],_[1]+x[1]]),k=y/Math.sin(T/2),B=h+k*C[0],R=g+k*C[1],I=[-_[1],_[0]],S=[x[1],-x[0]],L=function(O){var D=O[0];return O[1]>=0?Math.acos(D):-Math.acos(D)},b=L(I),w=L(S);this.lineTo(B+I[0]*y,R+I[1]*y),this.arc(B,R,y,b,w)}},a.prototype.stroke=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")},a.prototype.fill=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")},a.prototype.rect=function(h,g,p,m){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(h,g),this.lineTo(h+p,g),this.lineTo(h+p,g+m),this.lineTo(h,g+m),this.lineTo(h,g),this.closePath()},a.prototype.fillRect=function(h,g,p,m){var y,E;y=this.__createElement("rect",{x:h,y:g,width:p,height:m,"shape-rendering":"crispEdges"},!0),E=this.__closestGroupOrSvg(),E.appendChild(y),this.__currentElement=y,this.__applyStyleToCurrentElement("fill")},a.prototype.strokeRect=function(h,g,p,m){var y,E;y=this.__createElement("rect",{x:h,y:g,width:p,height:m},!0),E=this.__closestGroupOrSvg(),E.appendChild(y),this.__currentElement=y,this.__applyStyleToCurrentElement("stroke")},a.prototype.__clearCanvas=function(){for(var h=this.__closestGroupOrSvg(),g=h.getAttribute("transform"),p=this.__root.childNodes[1],m=p.childNodes,y=m.length-1;y>=0;y--)m[y]&&p.removeChild(m[y]);this.__currentElement=p,this.__groupStack=[],g&&this.__addTransform(g)},a.prototype.clearRect=function(h,g,p,m){if(h===0&&g===0&&p===this.width&&m===this.height)return void this.__clearCanvas();var y,E=this.__closestGroupOrSvg();y=this.__createElement("rect",{x:h,y:g,width:p,height:m,fill:"#FFFFFF"},!0),E.appendChild(y)},a.prototype.createLinearGradient=function(h,g,p,m){var y=this.__createElement("linearGradient",{id:n(this.__ids),x1:h+"px",x2:p+"px",y1:g+"px",y2:m+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(y),new l(y,this)},a.prototype.createRadialGradient=function(h,g,p,m,y,E){var A=this.__createElement("radialGradient",{id:n(this.__ids),cx:m+"px",cy:y+"px",r:E+"px",fx:h+"px",fy:g+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(A),new l(A,this)},a.prototype.__parseFont=function(){var h=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,g=h.exec(this.font),p={style:g[1]||"normal",size:g[4]||"10px",family:g[6]||"sans-serif",weight:g[3]||"normal",decoration:g[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(p.decoration="underline"),this.__fontHref&&(p.href=this.__fontHref),p},a.prototype.__wrapTextLink=function(h,g){if(h.href){var p=this.__createElement("a");return p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h.href),p.appendChild(g),p}return g},a.prototype.__applyText=function(h,g,p,m){var y=this.__parseFont(),E=this.__closestGroupOrSvg(),A=this.__createElement("text",{"font-family":y.family,"font-size":y.size,"font-style":y.style,"font-weight":y.weight,"text-decoration":y.decoration,x:g,y:p,"text-anchor":i(this.textAlign),"dominant-baseline":s(this.textBaseline)},!0);A.appendChild(this.__document.createTextNode(h)),this.__currentElement=A,this.__applyStyleToCurrentElement(m),E.appendChild(this.__wrapTextLink(y,A))},a.prototype.fillText=function(h,g,p){this.__applyText(h,g,p,"fill")},a.prototype.strokeText=function(h,g,p){this.__applyText(h,g,p,"stroke")},a.prototype.measureText=function(h){return this.__ctx.font=this.font,this.__ctx.measureText(h)},a.prototype.arc=function(h,g,p,m,y,E){if(m!==y){m%=2*Math.PI,y%=2*Math.PI,m===y&&(y=(y+2*Math.PI-.001*(E?-1:1))%(2*Math.PI));var A=h+p*Math.cos(y),_=g+p*Math.sin(y),x=h+p*Math.cos(m),v=g+p*Math.sin(m),T=E?0:1,C=0,k=y-m;k<0&&(k+=2*Math.PI),C=E?k>Math.PI?0:1:k>Math.PI?1:0,this.lineTo(x,v),this.__addPathCommand(t("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:p,ry:p,xAxisRotation:0,largeArcFlag:C,sweepFlag:T,endX:A,endY:_})),this.__currentPosition={x:A,y:_}}},a.prototype.clip=function(){var h=this.__closestGroupOrSvg(),g=this.__createElement("clipPath"),p=n(this.__ids),m=this.__createElement("g");this.__applyCurrentDefaultPath(),h.removeChild(this.__currentElement),g.setAttribute("id",p),g.appendChild(this.__currentElement),this.__defs.appendChild(g),h.setAttribute("clip-path",t("url(#{id})",{id:p})),h.appendChild(m),this.__currentElement=m},a.prototype.drawImage=function(){var h,g,p,m,y,E,A,_,x,v,T,C,k,B,R=Array.prototype.slice.call(arguments),I=R[0],S=0,L=0;if(R.length===3)h=R[1],g=R[2],y=I.width,E=I.height,p=y,m=E;else if(R.length===5)h=R[1],g=R[2],p=R[3],m=R[4],y=I.width,E=I.height;else{if(R.length!==9)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);S=R[1],L=R[2],y=R[3],E=R[4],h=R[5],g=R[6],p=R[7],m=R[8]}A=this.__closestGroupOrSvg(),this.__currentElement;var b="translate("+h+", "+g+")";if(I instanceof a){if(_=I.getSvg().cloneNode(!0),_.childNodes&&_.childNodes.length>1){for(x=_.childNodes[0];x.childNodes.length;)B=x.childNodes[0].getAttribute("id"),this.__ids[B]=B,this.__defs.appendChild(x.childNodes[0]);if(v=_.childNodes[1]){var w,M=v.getAttribute("transform");w=M?M+" "+b:b,v.setAttribute("transform",w),A.appendChild(v)}}}else I.nodeName!=="CANVAS"&&I.nodeName!=="IMG"||(T=this.__createElement("image"),T.setAttribute("width",p),T.setAttribute("height",m),T.setAttribute("preserveAspectRatio","none"),T.setAttribute("opacity",this.globalAlpha),(S||L||y!==I.width||E!==I.height)&&(C=this.__document.createElement("canvas"),C.width=p,C.height=m,k=C.getContext("2d"),k.drawImage(I,S,L,y,E,0,0,p,m),I=C),T.setAttribute("transform",b),T.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",I.nodeName==="CANVAS"?I.toDataURL():I.originalSrc),A.appendChild(T))},a.prototype.createPattern=function(h,g){var p,m=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),y=n(this.__ids);return m.setAttribute("id",y),m.setAttribute("width",h.width),m.setAttribute("height",h.height),h.nodeName==="CANVAS"||h.nodeName==="IMG"?(p=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),p.setAttribute("width",h.width),p.setAttribute("height",h.height),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h.nodeName==="CANVAS"?h.toDataURL():h.getAttribute("src")),m.appendChild(p),this.__defs.appendChild(m)):h instanceof a&&(m.appendChild(h.__root.childNodes[1]),this.__defs.appendChild(m)),new c(m,this)},a.prototype.setLineDash=function(h){h&&h.length>0?this.lineDash=h.join(","):this.lineDash=null},a.prototype.drawFocusRing=function(){},a.prototype.createImageData=function(){},a.prototype.getImageData=function(){},a.prototype.putImageData=function(){},a.prototype.globalCompositeOperation=function(){},a.prototype.setTransform=function(){},(typeof window>"u"?"undefined":pn(window))=="object"&&(window.C2S=a),r.exports=a})(),function(){function t(R,I){this.mode=A.MODE_8BIT_BYTE,this.data=R,this.parsedData=[];for(var S=0,L=this.data.length;S<L;S++){var b=[],w=this.data.charCodeAt(S);I?b[0]=w:w>65536?(b[0]=240|(1835008&w)>>>18,b[1]=128|(258048&w)>>>12,b[2]=128|(4032&w)>>>6,b[3]=128|63&w):w>2048?(b[0]=224|(61440&w)>>>12,b[1]=128|(4032&w)>>>6,b[2]=128|63&w):w>128?(b[0]=192|(1984&w)>>>6,b[1]=128|63&w):b[0]=w,this.parsedData.push(b)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function n(R,I){this.typeNumber=R,this.errorCorrectLevel=I,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function i(R,I){if(R.length==d)throw new Error(R.length+"/"+I);for(var S=0;S<R.length&&R[S]==0;)S++;this.num=new Array(R.length-S+I);for(var L=0;L<R.length-S;L++)this.num[L]=R[L+S]}function s(R,I){this.totalCount=R,this.dataCount=I}function o(){this.buffer=[],this.length=0}function a(){var R=!1,I=navigator.userAgent;if(/android/i.test(I)){R=!0;var S=I.toString().match(/android ([0-9]\.[0-9])/i);S&&S[1]&&(R=parseFloat(S[1]))}return R}function l(R,I){for(var S=I.correctLevel,L=1,b=c(R),w=0,M=k.length;w<M;w++){var O=0;switch(S){case _.L:O=k[w][0];break;case _.M:O=k[w][1];break;case _.Q:O=k[w][2];break;case _.H:O=k[w][3]}if(b<=O)break;L++}if(L>k.length)throw new Error("Too long data. the CorrectLevel."+["M","L","H","Q"][S]+" limit length is "+O);return I.version!=0&&(L<=I.version?(L=I.version,I.runVersion=L):(console.warn("QR Code version "+I.version+" too small, run version use "+L),I.runVersion=L)),L}function c(R){var I=encodeURI(R).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return I.length+(I.length!=R.length?3:0)}var d,f,h=pn(gn)=="object"&&gn&&gn.Object===Object&&gn,g=(typeof self>"u"?"undefined":pn(self))=="object"&&self&&self.Object===Object&&self,p=h||g||Function("return this")(),m=e&&!e.nodeType&&e,y=m&&!0&&r&&!r.nodeType&&r,E=p.QRCode;t.prototype={getLength:function(I){return this.parsedData.length},write:function(I){for(var S=0,L=this.parsedData.length;S<L;S++)I.put(this.parsedData[S],8)}},n.prototype={addData:function(I,S){var L=new t(I,S);this.dataList.push(L),this.dataCache=null},isDark:function(I,S){if(I<0||this.moduleCount<=I||S<0||this.moduleCount<=S)throw new Error(I+","+S);return this.modules[I][S][0]},getEye:function(I,S){if(I<0||this.moduleCount<=I||S<0||this.moduleCount<=S)throw new Error(I+","+S);var L=this.modules[I][S];if(L[1]){var b="P"+L[1]+"_"+L[2];return L[2]=="A"&&(b="A"+L[1]),{isDark:L[0],type:b}}return null},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(I,S){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var L=0;L<this.moduleCount;L++){this.modules[L]=new Array(this.moduleCount);for(var b=0;b<this.moduleCount;b++)this.modules[L][b]=[]}this.setupPositionProbePattern(0,0,"TL"),this.setupPositionProbePattern(this.moduleCount-7,0,"BL"),this.setupPositionProbePattern(0,this.moduleCount-7,"TR"),this.setupPositionAdjustPattern("A"),this.setupTimingPattern(),this.setupTypeInfo(I,S),this.typeNumber>=7&&this.setupTypeNumber(I),this.dataCache==null&&(this.dataCache=n.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,S)},setupPositionProbePattern:function(I,S,L){for(var b=-1;b<=7;b++)if(!(I+b<=-1||this.moduleCount<=I+b))for(var w=-1;w<=7;w++)S+w<=-1||this.moduleCount<=S+w||(0<=b&&b<=6&&(w==0||w==6)||0<=w&&w<=6&&(b==0||b==6)||2<=b&&b<=4&&2<=w&&w<=4?(this.modules[I+b][S+w][0]=!0,this.modules[I+b][S+w][2]=L,this.modules[I+b][S+w][1]=b==-0||w==-0||b==6||w==6?"O":"I"):this.modules[I+b][S+w][0]=!1)},getBestMaskPattern:function(){for(var I=0,S=0,L=0;L<8;L++){this.makeImpl(!0,L);var b=v.getLostPoint(this);(L==0||I>b)&&(I=b,S=L)}return S},createMovieClip:function(I,S,L){var b=I.createEmptyMovieClip(S,L);this.make();for(var w=0;w<this.modules.length;w++)for(var M=1*w,O=0;O<this.modules[w].length;O++){var D=1*O,F=this.modules[w][O][0];F&&(b.beginFill(0,100),b.moveTo(D,M),b.lineTo(D+1,M),b.lineTo(D+1,M+1),b.lineTo(D,M+1),b.endFill())}return b},setupTimingPattern:function(){for(var I=8;I<this.moduleCount-8;I++)this.modules[I][6][0]==null&&(this.modules[I][6][0]=I%2==0);for(var S=8;S<this.moduleCount-8;S++)this.modules[6][S][0]==null&&(this.modules[6][S][0]=S%2==0)},setupPositionAdjustPattern:function(I){for(var S=v.getPatternPosition(this.typeNumber),L=0;L<S.length;L++)for(var b=0;b<S.length;b++){var w=S[L],M=S[b];if(this.modules[w][M][0]==null)for(var O=-2;O<=2;O++)for(var D=-2;D<=2;D++)O==-2||O==2||D==-2||D==2||O==0&&D==0?(this.modules[w+O][M+D][0]=!0,this.modules[w+O][M+D][2]=I,this.modules[w+O][M+D][1]=O==-2||D==-2||O==2||D==2?"O":"I"):this.modules[w+O][M+D][0]=!1}},setupTypeNumber:function(I){for(var S=v.getBCHTypeNumber(this.typeNumber),L=0;L<18;L++){var b=!I&&(S>>L&1)==1;this.modules[Math.floor(L/3)][L%3+this.moduleCount-8-3][0]=b}for(var L=0;L<18;L++){var b=!I&&(S>>L&1)==1;this.modules[L%3+this.moduleCount-8-3][Math.floor(L/3)][0]=b}},setupTypeInfo:function(I,S){for(var L=this.errorCorrectLevel<<3|S,b=v.getBCHTypeInfo(L),w=0;w<15;w++){var M=!I&&(b>>w&1)==1;w<6?this.modules[w][8][0]=M:w<8?this.modules[w+1][8][0]=M:this.modules[this.moduleCount-15+w][8][0]=M}for(var w=0;w<15;w++){var M=!I&&(b>>w&1)==1;w<8?this.modules[8][this.moduleCount-w-1][0]=M:w<9?this.modules[8][15-w-1+1][0]=M:this.modules[8][15-w-1][0]=M}this.modules[this.moduleCount-8][8][0]=!I},mapData:function(I,S){for(var L=-1,b=this.moduleCount-1,w=7,M=0,O=this.moduleCount-1;O>0;O-=2)for(O==6&&O--;;){for(var D=0;D<2;D++)if(this.modules[b][O-D][0]==null){var F=!1;M<I.length&&(F=(I[M]>>>w&1)==1);var U=v.getMask(S,b,O-D);U&&(F=!F),this.modules[b][O-D][0]=F,w--,w==-1&&(M++,w=7)}if((b+=L)<0||this.moduleCount<=b){b-=L,L=-L;break}}}},n.PAD0=236,n.PAD1=17,n.createData=function(R,I,S){for(var L=s.getRSBlocks(R,I),b=new o,w=0;w<S.length;w++){var M=S[w];b.put(M.mode,4),b.put(M.getLength(),v.getLengthInBits(M.mode,R)),M.write(b)}for(var O=0,w=0;w<L.length;w++)O+=L[w].dataCount;if(b.getLengthInBits()>8*O)throw new Error("code length overflow. ("+b.getLengthInBits()+">"+8*O+")");for(b.getLengthInBits()+4<=8*O&&b.put(0,4);b.getLengthInBits()%8!=0;)b.putBit(!1);for(;!(b.getLengthInBits()>=8*O||(b.put(n.PAD0,8),b.getLengthInBits()>=8*O));)b.put(n.PAD1,8);return n.createBytes(b,L)},n.createBytes=function(R,I){for(var S=0,L=0,b=0,w=new Array(I.length),M=new Array(I.length),O=0;O<I.length;O++){var D=I[O].dataCount,F=I[O].totalCount-D;L=Math.max(L,D),b=Math.max(b,F),w[O]=new Array(D);for(var U=0;U<w[O].length;U++)w[O][U]=255&R.buffer[U+S];S+=D;var K=v.getErrorCorrectPolynomial(F),N=new i(w[O],K.getLength()-1),G=N.mod(K);M[O]=new Array(K.getLength()-1);for(var U=0;U<M[O].length;U++){var H=U+G.getLength()-M[O].length;M[O][U]=H>=0?G.get(H):0}}for(var Z=0,U=0;U<I.length;U++)Z+=I[U].totalCount;for(var J=new Array(Z),X=0,U=0;U<L;U++)for(var O=0;O<I.length;O++)U<w[O].length&&(J[X++]=w[O][U]);for(var U=0;U<b;U++)for(var O=0;O<I.length;O++)U<M[O].length&&(J[X++]=M[O][U]);return J};for(var A={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},_={L:1,M:0,Q:3,H:2},x={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},v={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(I){for(var S=I<<10;v.getBCHDigit(S)-v.getBCHDigit(v.G15)>=0;)S^=v.G15<<v.getBCHDigit(S)-v.getBCHDigit(v.G15);return(I<<10|S)^v.G15_MASK},getBCHTypeNumber:function(I){for(var S=I<<12;v.getBCHDigit(S)-v.getBCHDigit(v.G18)>=0;)S^=v.G18<<v.getBCHDigit(S)-v.getBCHDigit(v.G18);return I<<12|S},getBCHDigit:function(I){for(var S=0;I!=0;)S++,I>>>=1;return S},getPatternPosition:function(I){return v.PATTERN_POSITION_TABLE[I-1]},getMask:function(I,S,L){switch(I){case x.PATTERN000:return(S+L)%2==0;case x.PATTERN001:return S%2==0;case x.PATTERN010:return L%3==0;case x.PATTERN011:return(S+L)%3==0;case x.PATTERN100:return(Math.floor(S/2)+Math.floor(L/3))%2==0;case x.PATTERN101:return S*L%2+S*L%3==0;case x.PATTERN110:return(S*L%2+S*L%3)%2==0;case x.PATTERN111:return(S*L%3+(S+L)%2)%2==0;default:throw new Error("bad maskPattern:"+I)}},getErrorCorrectPolynomial:function(I){for(var S=new i([1],0),L=0;L<I;L++)S=S.multiply(new i([1,T.gexp(L)],0));return S},getLengthInBits:function(I,S){if(1<=S&&S<10)switch(I){case A.MODE_NUMBER:return 10;case A.MODE_ALPHA_NUM:return 9;case A.MODE_8BIT_BYTE:case A.MODE_KANJI:return 8;default:throw new Error("mode:"+I)}else if(S<27)switch(I){case A.MODE_NUMBER:return 12;case A.MODE_ALPHA_NUM:return 11;case A.MODE_8BIT_BYTE:return 16;case A.MODE_KANJI:return 10;default:throw new Error("mode:"+I)}else{if(!(S<41))throw new Error("type:"+S);switch(I){case A.MODE_NUMBER:return 14;case A.MODE_ALPHA_NUM:return 13;case A.MODE_8BIT_BYTE:return 16;case A.MODE_KANJI:return 12;default:throw new Error("mode:"+I)}}},getLostPoint:function(I){for(var S=I.getModuleCount(),L=0,b=0;b<S;b++)for(var w=0;w<S;w++){for(var M=0,O=I.isDark(b,w),D=-1;D<=1;D++)if(!(b+D<0||S<=b+D))for(var F=-1;F<=1;F++)w+F<0||S<=w+F||D==0&&F==0||O==I.isDark(b+D,w+F)&&M++;M>5&&(L+=3+M-5)}for(var b=0;b<S-1;b++)for(var w=0;w<S-1;w++){var U=0;I.isDark(b,w)&&U++,I.isDark(b+1,w)&&U++,I.isDark(b,w+1)&&U++,I.isDark(b+1,w+1)&&U++,U!=0&&U!=4||(L+=3)}for(var b=0;b<S;b++)for(var w=0;w<S-6;w++)I.isDark(b,w)&&!I.isDark(b,w+1)&&I.isDark(b,w+2)&&I.isDark(b,w+3)&&I.isDark(b,w+4)&&!I.isDark(b,w+5)&&I.isDark(b,w+6)&&(L+=40);for(var w=0;w<S;w++)for(var b=0;b<S-6;b++)I.isDark(b,w)&&!I.isDark(b+1,w)&&I.isDark(b+2,w)&&I.isDark(b+3,w)&&I.isDark(b+4,w)&&!I.isDark(b+5,w)&&I.isDark(b+6,w)&&(L+=40);for(var K=0,w=0;w<S;w++)for(var b=0;b<S;b++)I.isDark(b,w)&&K++;return L+=Math.abs(100*K/S/S-50)/5*10}},T={glog:function(I){if(I<1)throw new Error("glog("+I+")");return T.LOG_TABLE[I]},gexp:function(I){for(;I<0;)I+=255;for(;I>=256;)I-=255;return T.EXP_TABLE[I]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},C=0;C<8;C++)T.EXP_TABLE[C]=1<<C;for(var C=8;C<256;C++)T.EXP_TABLE[C]=T.EXP_TABLE[C-4]^T.EXP_TABLE[C-5]^T.EXP_TABLE[C-6]^T.EXP_TABLE[C-8];for(var C=0;C<255;C++)T.LOG_TABLE[T.EXP_TABLE[C]]=C;i.prototype={get:function(I){return this.num[I]},getLength:function(){return this.num.length},multiply:function(I){for(var S=new Array(this.getLength()+I.getLength()-1),L=0;L<this.getLength();L++)for(var b=0;b<I.getLength();b++)S[L+b]^=T.gexp(T.glog(this.get(L))+T.glog(I.get(b)));return new i(S,0)},mod:function(I){if(this.getLength()-I.getLength()<0)return this;for(var S=T.glog(this.get(0))-T.glog(I.get(0)),L=new Array(this.getLength()),b=0;b<this.getLength();b++)L[b]=this.get(b);for(var b=0;b<I.getLength();b++)L[b]^=T.gexp(T.glog(I.get(b))+S);return new i(L,0).mod(I)}},s.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],s.getRSBlocks=function(R,I){var S=s.getRsBlockTable(R,I);if(S==d)throw new Error("bad rs block @ typeNumber:"+R+"/errorCorrectLevel:"+I);for(var L=S.length/3,b=[],w=0;w<L;w++)for(var M=S[3*w+0],O=S[3*w+1],D=S[3*w+2],F=0;F<M;F++)b.push(new s(O,D));return b},s.getRsBlockTable=function(R,I){switch(I){case _.L:return s.RS_BLOCK_TABLE[4*(R-1)+0];case _.M:return s.RS_BLOCK_TABLE[4*(R-1)+1];case _.Q:return s.RS_BLOCK_TABLE[4*(R-1)+2];case _.H:return s.RS_BLOCK_TABLE[4*(R-1)+3];default:return d}},o.prototype={get:function(I){var S=Math.floor(I/8);return(this.buffer[S]>>>7-I%8&1)==1},put:function(I,S){for(var L=0;L<S;L++)this.putBit((I>>>S-L-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(I){var S=Math.floor(this.length/8);this.buffer.length<=S&&this.buffer.push(0),I&&(this.buffer[S]|=128>>>this.length%8),this.length++}};var k=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],B=function(){return typeof CanvasRenderingContext2D<"u"}()?function(){function R(){if(this._htOption.drawer=="svg"){var w=this._oContext.getSerializedSvg(!0);this.dataURL=w,this._el.innerHTML=w}else try{var M=this._elCanvas.toDataURL("image/png");this.dataURL=M}catch(O){console.error(O)}this._htOption.onRenderingEnd&&(this.dataURL||console.error("Can not get base64 data, please check: 1. Published the page and image to the server 2. The image request support CORS 3. Configured `crossOrigin:'anonymous'` option"),this._htOption.onRenderingEnd(this._htOption,this.dataURL))}function I(w,M){var O=this;if(O._fFail=M,O._fSuccess=w,O._bSupportDataURI===null){var D=document.createElement("img"),F=function(){O._bSupportDataURI=!1,O._fFail&&O._fFail.call(O)},U=function(){O._bSupportDataURI=!0,O._fSuccess&&O._fSuccess.call(O)};return D.onabort=F,D.onerror=F,D.onload=U,void(D.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}O._bSupportDataURI===!0&&O._fSuccess?O._fSuccess.call(O):O._bSupportDataURI===!1&&O._fFail&&O._fFail.call(O)}if(p._android&&p._android<=2.1){var S=1/window.devicePixelRatio,L=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(w,M,O,D,F,U,K,N,G){if("nodeName"in w&&/img/i.test(w.nodeName))for(var H=arguments.length-1;H>=1;H--)arguments[H]=arguments[H]*S;else N===void 0&&(arguments[1]*=S,arguments[2]*=S,arguments[3]*=S,arguments[4]*=S);L.apply(this,arguments)}}var b=function(M,O){this._bIsPainted=!1,this._android=a(),this._el=M,this._htOption=O,this._htOption.drawer=="svg"?(this._oContext={},this._elCanvas={}):(this._elCanvas=document.createElement("canvas"),this._el.appendChild(this._elCanvas),this._oContext=this._elCanvas.getContext("2d")),this._bSupportDataURI=null,this.dataURL=null};return b.prototype.draw=function(w){function M(){D.quietZone>0&&D.quietZoneColor&&(N.lineWidth=0,N.fillStyle=D.quietZoneColor,N.fillRect(0,0,G._elCanvas.width,D.quietZone),N.fillRect(0,D.quietZone,D.quietZone,G._elCanvas.height-2*D.quietZone),N.fillRect(G._elCanvas.width-D.quietZone,D.quietZone,D.quietZone,G._elCanvas.height-2*D.quietZone),N.fillRect(0,G._elCanvas.height-D.quietZone,G._elCanvas.width,D.quietZone))}function O(Z){function J(we){var Ie=Math.round(D.width/3.5),ve=Math.round(D.height/3.5);Ie!==ve&&(Ie=ve),D.logoMaxWidth?Ie=Math.round(D.logoMaxWidth):D.logoWidth&&(Ie=Math.round(D.logoWidth)),D.logoMaxHeight?ve=Math.round(D.logoMaxHeight):D.logoHeight&&(ve=Math.round(D.logoHeight));var Ce,Re;we.naturalWidth===void 0?(Ce=we.width,Re=we.height):(Ce=we.naturalWidth,Re=we.naturalHeight),(D.logoMaxWidth||D.logoMaxHeight)&&(D.logoMaxWidth&&Ce<=Ie&&(Ie=Ce),D.logoMaxHeight&&Re<=ve&&(ve=Re),Ce<=Ie&&Re<=ve&&(Ie=Ce,ve=Re));var je=(D.width+2*D.quietZone-Ie)/2,z=(D.height+D.titleHeight+2*D.quietZone-ve)/2,Ae=Math.min(Ie/Ce,ve/Re),Me=Ce*Ae,Ze=Re*Ae;(D.logoMaxWidth||D.logoMaxHeight)&&(Ie=Me,ve=Ze,je=(D.width+2*D.quietZone-Ie)/2,z=(D.height+D.titleHeight+2*D.quietZone-ve)/2),D.logoBackgroundTransparent||(N.fillStyle=D.logoBackgroundColor,N.fillRect(je,z,Ie,ve)),N.drawImage(we,je+(Ie-Me)/2,z+(ve-Ze)/2,Me,Ze),M(),De._bIsPainted=!0,De.makeImage()}D.onRenderingStart&&D.onRenderingStart(D);for(var X=0;X<F;X++)for(var ne=0;ne<F;ne++){var ce=ne*U+D.quietZone,re=X*K+D.quietZone,Ee=Z.isDark(X,ne),se=Z.getEye(X,ne),ee=D.dotScale;N.lineWidth=0;var he,_e;se?(he=D[se.type]||D[se.type.substring(0,2)]||D.colorDark,_e=D.colorLight):D.backgroundImage?(_e="rgba(0,0,0,0)",X==6?D.autoColor?(he=D.timing_H||D.timing||D.autoColorDark,_e=D.timing_H||D.timing||D.autoColorLight):he=D.timing_H||D.timing||D.colorDark:ne==6?D.autoColor?(he=D.timing_V||D.timing||D.autoColorDark,_e=D.timing_V||D.timing||D.autoColorLight):he=D.timing_V||D.timing||D.colorDark:D.autoColor?(he=D.autoColorDark,_e=D.autoColorLight):he=D.colorDark):(he=X==6?D.timing_H||D.timing||D.colorDark:ne==6&&(D.timing_V||D.timing)||D.colorDark,_e=D.colorLight),N.strokeStyle=Ee?he:_e,N.fillStyle=Ee?he:_e,se?(ee=se.type=="AO"?D.dotScaleAO:se.type=="AI"?D.dotScaleAI:1,D.backgroundImage&&D.autoColor?(he=(se.type=="AO"?D.AI:D.AO)||D.autoColorDark,_e=D.autoColorLight):he=(se.type=="AO"?D.AI:D.AO)||he,Ee=se.isDark,N.fillRect(ce+U*(1-ee)/2,D.titleHeight+re+K*(1-ee)/2,U*ee,K*ee)):X==6?(ee=D.dotScaleTiming_H,N.fillRect(ce+U*(1-ee)/2,D.titleHeight+re+K*(1-ee)/2,U*ee,K*ee)):ne==6?(ee=D.dotScaleTiming_V,N.fillRect(ce+U*(1-ee)/2,D.titleHeight+re+K*(1-ee)/2,U*ee,K*ee)):(D.backgroundImage,N.fillRect(ce+U*(1-ee)/2,D.titleHeight+re+K*(1-ee)/2,U*ee,K*ee)),D.dotScale==1||se||(N.strokeStyle=D.colorLight)}if(D.title&&(N.fillStyle=D.titleBackgroundColor,N.fillRect(0,0,this._elCanvas.width,D.titleHeight+D.quietZone),N.font=D.titleFont,N.fillStyle=D.titleColor,N.textAlign="center",N.fillText(D.title,this._elCanvas.width/2,+D.quietZone+D.titleTop)),D.subTitle&&(N.font=D.subTitleFont,N.fillStyle=D.subTitleColor,N.fillText(D.subTitle,this._elCanvas.width/2,+D.quietZone+D.subTitleTop)),D.logo){var ke=new Image,De=this;ke.onload=function(){J(ke)},ke.onerror=function(we){console.error(we)},D.crossOrigin!=null&&(ke.crossOrigin=D.crossOrigin),ke.originalSrc=D.logo,ke.src=D.logo}else M(),this._bIsPainted=!0,this.makeImage()}console.log(this);var D=this._htOption;D.title||D.subTitle||(D.height-=D.titleHeight,D.titleHeight=0);var F=w.getModuleCount(),U=Math.round(D.width/F),K=Math.round((D.height-D.titleHeight)/F);U<=1&&(U=1),K<=1&&(K=1),D.width=U*F,D.height=K*F+D.titleHeight,D.quietZone=Math.round(D.quietZone),this._elCanvas.width=D.width+2*D.quietZone,this._elCanvas.height=D.height+2*D.quietZone,this._htOption.drawer!="canvas"&&(this._oContext=new C2S(this._elCanvas.width,this._elCanvas.height)),this.clear();var N=this._oContext;N.lineWidth=0,N.fillStyle=D.colorLight,N.fillRect(0,0,this._elCanvas.width,this._elCanvas.height);var G=this;if(D.backgroundImage){var H=new Image;H.onload=function(){N.globalAlpha=1,N.globalAlpha=D.backgroundImageAlpha,N.drawImage(H,0,D.titleHeight,D.width+2*D.quietZone,D.height+2*D.quietZone-D.titleHeight),N.globalAlpha=1,O.call(G,w)},D.crossOrigin!=null&&(H.crossOrigin=D.crossOrigin),H.originalSrc=D.backgroundImage,H.src=D.backgroundImage}else O.call(G,w)},b.prototype.makeImage=function(){this._bIsPainted&&I.call(this,R)},b.prototype.isPainted=function(){return this._bIsPainted},b.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},b.prototype.remove=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1,this._el.innerHTML=""},b.prototype.round=function(w){return w&&Math.floor(1e3*w)/1e3},b}():function(){var R=function(S,L){this._el=S,this._htOption=L};return R.prototype.draw=function(I){var S=this._htOption,L=this._el,b=I.getModuleCount(),w=Math.round(S.width/b),M=Math.round((S.height-S.titleHeight)/b);w<=1&&(w=1),M<=1&&(M=1),this._htOption.width=w*b,this._htOption.height=M*b+S.titleHeight,this._htOption.quietZone=Math.round(this._htOption.quietZone);var O=[],D="",F=Math.round(w*S.dotScale),U=Math.round(M*S.dotScale);F<4&&(F=4,U=4);var K=S.colorDark,N=S.colorLight;if(S.backgroundImage){S.autoColor?(S.colorDark="rgba(0, 0, 0, .6);filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#99000000', EndColorStr='#99000000');",S.colorLight="rgba(255, 255, 255, .7);filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#B2FFFFFF', EndColorStr='#B2FFFFFF');"):S.colorLight="rgba(0,0,0,0)";var G='<div style="display:inline-block; z-index:-10;position:absolute;"><img src="'+S.backgroundImage+'" widht="'+(S.width+2*S.quietZone)+'" height="'+(S.height+2*S.quietZone)+'" style="opacity:'+S.backgroundImageAlpha+";filter:alpha(opacity="+100*S.backgroundImageAlpha+'); "/></div>';O.push(G)}if(S.quietZone&&(D="display:inline-block; width:"+(S.width+2*S.quietZone)+"px; height:"+(S.width+2*S.quietZone)+"px;background:"+S.quietZoneColor+"; text-align:center;"),O.push('<div style="font-size:0;'+D+'">'),O.push('<table  style="font-size:0;border:0;border-collapse:collapse; margin-top:'+S.quietZone+'px;" border="0" cellspacing="0" cellspadding="0" align="center" valign="middle">'),O.push('<tr height="'+S.titleHeight+'" align="center"><td style="border:0;border-collapse:collapse;margin:0;padding:0" colspan="'+b+'">'),S.title){var H=S.titleColor,Z=S.titleFont;O.push('<div style="width:100%;margin-top:'+S.titleTop+"px;color:"+H+";font:"+Z+";background:"+S.titleBackgroundColor+'">'+S.title+"</div>")}S.subTitle&&O.push('<div style="width:100%;margin-top:'+(S.subTitleTop-S.titleTop)+"px;color:"+S.subTitleColor+"; font:"+S.subTitleFont+'">'+S.subTitle+"</div>"),O.push("</td></tr>");for(var J=0;J<b;J++){O.push('<tr style="border:0; padding:0; margin:0;" height="7">');for(var X=0;X<b;X++){var ne=I.isDark(J,X),ce=I.getEye(J,X);if(ce){ne=ce.isDark;var re=ce.type,Ee=S[re]||S[re.substring(0,2)]||K;O.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+w+"px;height:"+M+'px;"><span style="width:'+w+"px;height:"+M+"px;background-color:"+(ne?Ee:N)+';display:inline-block"></span></td>')}else{var se=S.colorDark;J==6?(se=S.timing_H||S.timing||K,O.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+w+"px;height:"+M+"px;background-color:"+(ne?se:N)+';"></td>')):X==6?(se=S.timing_V||S.timing||K,O.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+w+"px;height:"+M+"px;background-color:"+(ne?se:N)+';"></td>')):O.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+w+"px;height:"+M+'px;"><div style="display:inline-block;width:'+F+"px;height:"+U+"px;background-color:"+(ne?se:S.colorLight)+';"></div></td>')}}O.push("</tr>")}if(O.push("</table>"),O.push("</div>"),S.logo){var ee=new Image;S.crossOrigin!=null&&(ee.crossOrigin=S.crossOrigin),ee.src=S.logo;var he=S.width/3.5,_e=S.height/3.5;he!=_e&&(he=_e),S.logoWidth&&(he=S.logoWidth),S.logoHeight&&(_e=S.logoHeight);var ke="position:relative; z-index:1;display:table-cell;top:-"+((S.height-S.titleHeight)/2+_e/2+S.quietZone)+"px;text-align:center; width:"+he+"px; height:"+_e+"px;line-height:"+he+"px; vertical-align: middle;";S.logoBackgroundTransparent||(ke+="background:"+S.logoBackgroundColor),O.push('<div style="'+ke+'"><img  src="'+S.logo+'"  style="max-width: '+he+"px; max-height: "+_e+'px;" /> <div style=" display: none; width:1px;margin-left: -1px;"></div></div>')}S.onRenderingStart&&S.onRenderingStart(S),L.innerHTML=O.join("");var De=L.childNodes[0],we=(S.width-De.offsetWidth)/2,Ie=(S.height-De.offsetHeight)/2;we>0&&Ie>0&&(De.style.margin=Ie+"px "+we+"px"),this._htOption.onRenderingEnd&&this._htOption.onRenderingEnd(this._htOption,null)},R.prototype.clear=function(){this._el.innerHTML=""},R}();f=function(I,S){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:_.H,dotScale:1,dotScaleTiming:1,dotScaleTiming_H:d,dotScaleTiming_V:d,dotScaleA:1,dotScaleAO:d,dotScaleAI:d,quietZone:0,quietZoneColor:"rgba(0,0,0,0)",title:"",titleFont:"normal normal bold 16px Arial",titleColor:"#000000",titleBackgroundColor:"#ffffff",titleHeight:0,titleTop:30,subTitle:"",subTitleFont:"normal normal normal 14px Arial",subTitleColor:"#4F4F4F",subTitleTop:60,logo:d,logoWidth:d,logoHeight:d,logoMaxWidth:d,logoMaxHeight:d,logoBackgroundColor:"#ffffff",logoBackgroundTransparent:!1,PO:d,PI:d,PO_TL:d,PI_TL:d,PO_TR:d,PI_TR:d,PO_BL:d,PI_BL:d,AO:d,AI:d,timing:d,timing_H:d,timing_V:d,backgroundImage:d,backgroundImageAlpha:1,autoColor:!1,autoColorDark:"rgba(0, 0, 0, .6)",autoColorLight:"rgba(255, 255, 255, .7)",onRenderingStart:d,onRenderingEnd:d,version:0,tooltip:!1,binary:!1,drawer:"canvas",crossOrigin:null},typeof S=="string"&&(S={text:S}),S)for(var L in S)this._htOption[L]=S[L];(this._htOption.version<0||this._htOption.version>40)&&(console.warn("QR Code version '"+this._htOption.version+"' is invalidate, reset to 0"),this._htOption.version=0),(this._htOption.dotScale<0||this._htOption.dotScale>1)&&(console.warn(this._htOption.dotScale+" , is invalidate, dotScale must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScale=1),(this._htOption.dotScaleTiming<0||this._htOption.dotScaleTiming>1)&&(console.warn(this._htOption.dotScaleTiming+" , is invalidate, dotScaleTiming must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleTiming=1),this._htOption.dotScaleTiming_H?(this._htOption.dotScaleTiming_H<0||this._htOption.dotScaleTiming_H>1)&&(console.warn(this._htOption.dotScaleTiming_H+" , is invalidate, dotScaleTiming_H must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleTiming_H=1):this._htOption.dotScaleTiming_H=this._htOption.dotScaleTiming,this._htOption.dotScaleTiming_V?(this._htOption.dotScaleTiming_V<0||this._htOption.dotScaleTiming_V>1)&&(console.warn(this._htOption.dotScaleTiming_V+" , is invalidate, dotScaleTiming_V must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleTiming_V=1):this._htOption.dotScaleTiming_V=this._htOption.dotScaleTiming,(this._htOption.dotScaleA<0||this._htOption.dotScaleA>1)&&(console.warn(this._htOption.dotScaleA+" , is invalidate, dotScaleA must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleA=1),this._htOption.dotScaleAO?(this._htOption.dotScaleAO<0||this._htOption.dotScaleAO>1)&&(console.warn(this._htOption.dotScaleAO+" , is invalidate, dotScaleAO must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleAO=1):this._htOption.dotScaleAO=this._htOption.dotScaleA,this._htOption.dotScaleAI?(this._htOption.dotScaleAI<0||this._htOption.dotScaleAI>1)&&(console.warn(this._htOption.dotScaleAI+" , is invalidate, dotScaleAI must greater than 0, less than or equal to 1, now reset to 1. "),this._htOption.dotScaleAI=1):this._htOption.dotScaleAI=this._htOption.dotScaleA,(this._htOption.backgroundImageAlpha<0||this._htOption.backgroundImageAlpha>1)&&(console.warn(this._htOption.backgroundImageAlpha+" , is invalidate, backgroundImageAlpha must between 0 and 1, now reset to 1. "),this._htOption.backgroundImageAlpha=1),this._htOption.height=this._htOption.height+this._htOption.titleHeight,typeof I=="string"&&(I=document.getElementById(I)),(!this._htOption.drawer||this._htOption.drawer!="svg"&&this._htOption.drawer!="canvas")&&(this._htOption.drawer="canvas"),this._android=a(),this._el=I,this._oQRCode=null;var b={};for(var L in this._htOption)b[L]=this._htOption[L];this._oDrawing=new B(this._el,b),this._htOption.text&&this.makeCode(this._htOption.text)},f.prototype.makeCode=function(R){this._oQRCode=new n(l(R,this._htOption),this._htOption.correctLevel),this._oQRCode.addData(R,this._htOption.binary),this._oQRCode.make(),this._htOption.tooltip&&(this._el.title=R),this._oDrawing.draw(this._oQRCode)},f.prototype.makeImage=function(){typeof this._oDrawing.makeImage=="function"&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},f.prototype.clear=function(){this._oDrawing.remove()},f.prototype.resize=function(R,I){this._oDrawing._htOption.width=R,this._oDrawing._htOption.height=I,this._oDrawing.draw(this._oQRCode)},f.prototype.noConflict=function(){return p.QRCode===this&&(p.QRCode=E),f},f.CorrectLevel=_,y?((y.exports=f).QRCode=f,m.QRCode=f):p.QRCode=f}.call(gn)})(hi,hi.exports),hi.exports;var Jo;(function(r){r[r.Connecting=0]="Connecting",r[r.Open=1]="Open",r[r.Closing=2]="Closing",r[r.Closed=3]="Closed"})(Jo||(Jo={}));function Rg(r,e,t="modelValue",n){return u.computed({get:()=>r[t],set:i=>{e(`update:${t}`,n?n(i):i)}})}var pi=u.defineComponent({name:"vue3-danmaku",components:{},props:{danmus:{type:Array,required:!0,default:()=>[]},channels:{type:Number,default:0},autoplay:{type:Boolean,default:!0},loop:{type:Boolean,default:!1},useSlot:{type:Boolean,default:!1},debounce:{type:Number,default:100},speeds:{type:Number,default:200},randomChannel:{type:Boolean,default:!1},fontSize:{type:Number,default:18},top:{type:Number,default:4},right:{type:Number,default:0},isSuspend:{type:Boolean,default:!1},extraStyle:{type:String,default:""}},emits:["list-end","play-end","update:danmus"],setup(r,{emit:e,slots:t}){let n=u.ref(document.createElement("div")),i=u.ref(document.createElement("div"));const s=u.ref(0),o=u.ref(0);let a=0;const l=u.ref(0),c=u.ref(0),d=u.ref(0),f=u.ref(!1),h=u.ref(!1),g=u.ref({}),p=Rg(r,e,"danmus"),m=u.reactive({channels:u.computed(()=>r.channels||l.value),autoplay:u.computed(()=>r.autoplay),loop:u.computed(()=>r.loop),useSlot:u.computed(()=>r.useSlot),debounce:u.computed(()=>r.debounce),randomChannel:u.computed(()=>r.randomChannel)}),y=u.reactive({height:u.computed(()=>c.value),fontSize:u.computed(()=>r.fontSize),speeds:u.computed(()=>r.speeds),top:u.computed(()=>r.top),right:u.computed(()=>r.right)});u.onMounted(()=>{E()}),u.onBeforeUnmount(()=>{I()});function E(){A(),r.isSuspend&&R(),m.autoplay&&_()}function A(){s.value=n.value.offsetWidth,o.value=n.value.offsetHeight}function _(){h.value=!1,a||(a=setInterval(()=>x(),m.debounce))}function x(){if(!h.value&&p.value.length)if(d.value>p.value.length-1){const K=i.value.children.length;m.loop&&(K<d.value&&(e("list-end"),d.value=0),v())}else v()}function v(K){const N=m.loop?d.value%p.value.length:d.value,G=K||p.value[N];let H=document.createElement("div");m.useSlot?H=T(G,N).$el:(H.innerHTML=G,H.setAttribute("style",r.extraStyle),H.style.fontSize=`${y.fontSize}px`,H.style.lineHeight=`${y.fontSize}px`),H.classList.add("dm"),i.value.appendChild(H),H.style.opacity="0",u.nextTick(()=>{y.height||(c.value=H.offsetHeight),m.channels||(l.value=Math.floor(o.value/(y.height+y.top)));let Z=C(H);if(Z>=0){const J=H.offsetWidth,X=y.height;H.classList.add("move"),H.dataset.index=`${N}`,H.style.opacity="1",H.style.top=Z*(X+y.top)+"px",H.style.width=J+y.right+"px",H.style.setProperty("--dm-scroll-width",`-${s.value+J*2}px`),H.style.left=`${s.value}px`,H.style.animationDuration=`${s.value/y.speeds}s`,H.addEventListener("animationend",()=>{Number(H.dataset.index)===p.value.length-1&&!m.loop&&e("play-end",H.dataset.index),i.value&&i.value.removeChild(H)}),d.value++}else i.value.removeChild(H)})}function T(K,N){return u.createApp({render(){return u.h("div",{},[t.dm&&t.dm({danmu:K,index:N})])}}).mount(document.createElement("div"))}function C(K){let N=[...Array(m.channels).keys()];m.randomChannel&&(N=N.sort(()=>.5-Math.random()));for(let G of N){const H=g.value[G];if(H&&H.length)for(let Z=0;Z<H.length;Z++){const J=k(H[Z])-10;if(J<=(K.offsetWidth-H[Z].offsetWidth)*.88||J<=0)break;if(Z===H.length-1)return g.value[G].push(K),K.addEventListener("animationend",()=>g.value[G].splice(0,1)),G%m.channels}else return g.value[G]=[K],K.addEventListener("animationend",()=>g.value[G].splice(0,1)),G%m.channels}return-1}function k(K){const N=K.offsetWidth||parseInt(K.style.width),G=K.getBoundingClientRect().right||i.value.getBoundingClientRect().right+N;return i.value.getBoundingClientRect().right-G}function B(){clearInterval(a),a=0}function R(){let K=[];i.value.addEventListener("mousemove",N=>{let G=N.target;G.className.includes("dm")||(G=G.closest(".dm")||G),G.className.includes("dm")&&(G.classList.add("pause"),K.push(G))}),i.value.addEventListener("mouseout",N=>{let G=N.target;G.className.includes("dm")||(G=G.closest(".dm")||G),G.className.includes("dm")&&(G.classList.remove("pause"),K.forEach(H=>{H.classList.remove("pause")}),K=[])})}function I(){B(),d.value=0}function S(){c.value=0,E()}function L(){g.value={},i.value.innerHTML="",h.value=!0,f.value=!1,I()}function b(){h.value=!0}function w(K){if(d.value===p.value.length)return p.value.push(K),p.value.length-1;{const N=d.value%p.value.length;return p.value.splice(N,0,K),N+1}}function M(K){return p.value.push(K),p.value.length-1}function O(){return!h.value}function D(){f.value=!1}function F(){f.value=!0}function U(){A();const K=i.value.getElementsByClassName("dm");for(let N=0;N<K.length;N++){const G=K[N];G.style.setProperty("--dm-scroll-width",`-${s.value+G.offsetWidth*2}px`),G.style.left=`${s.value}px`,G.style.animationDuration=`${s.value/y.speeds}s`}}return{container:n,dmContainer:i,hidden:f,paused:h,danmuList:p,getPlayState:O,resize:U,play:_,pause:b,stop:L,show:D,hide:F,reset:S,add:w,push:M,insert:v}}});const wg={ref:"container",class:"vue-danmaku"};function kg(r,e,t,n,i,s){return u.openBlock(),u.createElementBlock("div",wg,[u.createElementVNode("div",{ref:"dmContainer",class:u.normalizeClass(["danmus",{show:!r.hidden},{paused:r.paused}])},null,2),u.renderSlot(r.$slots,"default")],512)}function Dg(r,e){e===void 0&&(e={});var t=e.insertAt;if(!(!r||typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=r:i.appendChild(document.createTextNode(r))}}var Og=`.vue-danmaku {
  position: relative;
  overflow: hidden;
}
.vue-danmaku .danmus {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  -webkit-transition: all 0.3s;
  transition: all 0.3s;
}
.vue-danmaku .danmus.show {
  opacity: 1;
}
.vue-danmaku .danmus.paused .dm.move {
  animation-play-state: paused;
}
.vue-danmaku .danmus .dm {
  position: absolute;
  font-size: 20px;
  color: #ddd;
  white-space: pre;
  transform: translateX(0);
  transform-style: preserve-3d;
}
.vue-danmaku .danmus .dm.move {
  will-change: transform;
  animation-name: moveLeft;
  animation-timing-function: linear;
  animation-play-state: running;
}
.vue-danmaku .danmus .dm.pause {
  animation-play-state: paused;
  z-index: 10;
}
@keyframes moveLeft {
  from {
    transform: translateX(0);
  }
  to {
    transform: translateX(var(--dm-scroll-width));
  }
}
@-webkit-keyframes moveLeft {
  from {
    -webkit-transform: translateX(0);
  }
  to {
    -webkit-transform: translateX(var(--dm-scroll-width));
  }
}`;Dg(Og),pi.render=kg,pi.__file="src/lib/Danmaku.vue";function Pg(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Yo={exports:{}};(function(r,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,c,d){if(d=d||{},l=l.trim(),c=c.trim(),!c){if(!d.alwaysNormalize)return l;var f=a.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");return f.path=a.normalizePath(f.path),a.buildURLFromParts(f)}var h=a.parseURL(c);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return d.alwaysNormalize?(h.path=a.normalizePath(h.path),a.buildURLFromParts(h)):c;var g=a.parseURL(l);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var p=i.exec(g.path);g.netLoc=p[1],g.path=p[2]}g.netLoc&&!g.path&&(g.path="/");var m={scheme:g.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(m.netLoc=g.netLoc,h.path[0]!=="/"))if(!h.path)m.path=g.path,h.params||(m.params=g.params,h.query||(m.query=g.query));else{var y=g.path,E=y.substring(0,y.lastIndexOf("/")+1)+h.path;m.path=a.normalizePath(E)}return m.path===null&&(m.path=d.alwaysNormalize?a.normalizePath(h.path):h.path),a.buildURLFromParts(m)},parseURL:function(l){var c=n.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};r.exports=a})()})(Yo);var gi=Yo.exports;function zo(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function nt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?zo(Object(t),!0).forEach(function(n){Bg(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):zo(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Bg(r,e,t){return e=Fg(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ke(){return Ke=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Ke.apply(this,arguments)}function Mg(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Fg(r){var e=Mg(r,"string");return typeof e=="symbol"?e:String(e)}const oe=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)};let P=function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r}({}),le=function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r}({}),W=function(r){return r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_PARSING_ERROR="levelParsingError",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.FRAG_GAP="fragGap",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.UNKNOWN="unknown",r}({});const Xt=function(){},mi={trace:Xt,debug:Xt,log:Xt,warn:Xt,info:Xt,error:Xt};let Vn=mi;function Ng(r){const e=self.console[r];return e?e.bind(self.console,`[${r}] >`):Xt}function Ug(r,...e){e.forEach(function(t){Vn[t]=r[t]?r[t].bind(r):Ng(t)})}function Vg(r,e){if(self.console&&r===!0||typeof r=="object"){Ug(r,"debug","log","info","warn","error");try{Vn.log(`Debug logs enabled for "${e}" in hls.js version 1.4.3`)}catch{Vn=mi}}else Vn=mi}const V=Vn,Kg=/^(\d+)x(\d+)$/,qo=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Pe{constructor(e){typeof e=="string"&&(e=Pe.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&(t.substring(0,2)==="X-"&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=Kg.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},i='"';for(qo.lastIndex=0;(t=qo.exec(e))!==null;){let s=t[2];s.indexOf(i)===0&&s.lastIndexOf(i)===s.length-1&&(s=s.slice(1,-1));const o=t[1].trim();n[o]=s}return n}}function Gg(r){return r!=="ID"&&r!=="CLASS"&&r!=="START-DATE"&&r!=="DURATION"&&r!=="END-DATE"&&r!=="END-ON-NEXT"}function jg(r){return r==="SCTE35-OUT"||r==="SCTE35-IN"}class Zo{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const i in n)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==n[i]){V.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=i;break}e=Ke(new Pe({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);oe(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(oe(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&oe(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class gr{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Le={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Xo{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Le.AUDIO]:null,[Le.VIDEO]:null,[Le.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2),i=[];n.length===1?i[0]=t?t.byteRangeEndOffset:0:i[0]=parseInt(n[1]),i[1]=parseInt(n[0])+i[0],this._byteRange=i}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=gi.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class yi extends Xo{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new gr,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!oe(this.programDateTime))return null;const e=oe(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,s,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:s,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,i),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Le.AUDIO]=null,e[Le.VIDEO]=null,e[Le.AUDIOVIDEO]=null}}class Hg extends Xo{constructor(e,t,n,i,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new gr,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const Wg=10;class Qg{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?oe(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Wg}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Ei(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0))}function Jg(r){const e=$o(r).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function Yg(r){const e=function(n,i,s){const o=n[i];n[i]=n[s],n[s]=o};e(r,0,3),e(r,1,2),e(r,4,5),e(r,6,7)}function zg(r){const e=r.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const s=i[0]==="base64",o=i[1];s?(n.splice(-1,1),t=Ei(o)):t=Jg(o)}}return t}function $o(r){return Uint8Array.from(unescape(encodeURIComponent(r)),e=>e.charCodeAt(0))}var Be={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},rt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function ea(r){switch(r){case rt.FAIRPLAY:return Be.FAIRPLAY;case rt.PLAYREADY:return Be.PLAYREADY;case rt.WIDEVINE:return Be.WIDEVINE;case rt.CLEARKEY:return Be.CLEARKEY}}var ta={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function qg(r){if(r===ta.WIDEVINE)return Be.WIDEVINE}function na(r){switch(r){case Be.FAIRPLAY:return rt.FAIRPLAY;case Be.PLAYREADY:return rt.PLAYREADY;case Be.WIDEVINE:return rt.WIDEVINE;case Be.CLEARKEY:return rt.CLEARKEY}}function vi(r){const{drmSystems:e,widevineLicenseUrl:t}=r,n=e?[Be.FAIRPLAY,Be.WIDEVINE,Be.PLAYREADY,Be.CLEARKEY].filter(i=>!!e[i]):[];return!n[Be.WIDEVINE]&&t&&n.push(Be.WIDEVINE),n}const ra=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Zg(r,e,t,n){let i;switch(r){case Be.FAIRPLAY:i=["cenc","sinf"];break;case Be.WIDEVINE:case Be.PLAYREADY:i=["cenc"];break;case Be.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${r}`)}return Xg(i,e,t,n)}function Xg(r,e,t,n){return[{initDataTypes:r,persistentState:n.persistentState||"not-allowed",distinctiveIdentifier:n.distinctiveIdentifier||"not-allowed",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function $t(r,e,t){return Uint8Array.prototype.slice?r.slice(e,t):new Uint8Array(Array.prototype.slice.call(r,e,t))}const Ai=(r,e)=>e+10<=r.length&&r[e]===73&&r[e+1]===68&&r[e+2]===51&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,ia=(r,e)=>e+10<=r.length&&r[e]===51&&r[e+1]===68&&r[e+2]===73&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,mr=(r,e)=>{const t=e;let n=0;for(;Ai(r,e);){n+=10;const i=yr(r,e+6);n+=i,ia(r,e+10)&&(n+=10),e+=n}if(n>0)return r.subarray(t,t+n)},yr=(r,e)=>{let t=0;return t=(r[e]&127)<<21,t|=(r[e+1]&127)<<14,t|=(r[e+2]&127)<<7,t|=r[e+3]&127,t},$g=(r,e)=>Ai(r,e)&&yr(r,e+6)+10<=r.length-e,em=r=>{const e=oa(r);for(let t=0;t<e.length;t++){const n=e[t];if(sa(n))return om(n)}},sa=r=>r&&r.key==="PRIV"&&r.info==="com.apple.streaming.transportStreamTimestamp",tm=r=>{const e=String.fromCharCode(r[0],r[1],r[2],r[3]),t=yr(r,4),n=10;return{type:e,size:t,data:r.subarray(n,n+t)}},oa=r=>{let e=0;const t=[];for(;Ai(r,e);){const n=yr(r,e+6);e+=10;const i=e+n;for(;e+8<i;){const s=tm(r.subarray(e)),o=nm(s);o&&t.push(o),e+=s.size+10}ia(r,e)&&(e+=10)}return t},nm=r=>r.type==="PRIV"?rm(r):r.type[0]==="W"?sm(r):im(r),rm=r=>{if(r.size<2)return;const e=Lt(r.data,!0),t=new Uint8Array(r.data.subarray(e.length+1));return{key:r.type,info:e,data:t.buffer}},im=r=>{if(r.size<2)return;if(r.type==="TXXX"){let t=1;const n=Lt(r.data.subarray(t),!0);t+=n.length+1;const i=Lt(r.data.subarray(t));return{key:r.type,info:n,data:i}}const e=Lt(r.data.subarray(1));return{key:r.type,data:e}},sm=r=>{if(r.type==="WXXX"){if(r.size<2)return;let t=1;const n=Lt(r.data.subarray(t),!0);t+=n.length+1;const i=Lt(r.data.subarray(t));return{key:r.type,info:n,data:i}}const e=Lt(r.data);return{key:r.type,data:e}},om=r=>{if(r.data.byteLength===8){const e=new Uint8Array(r.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},Lt=(r,e=!1)=>{const t=am();if(t){const c=t.decode(r);if(e){const d=c.indexOf("\0");return d!==-1?c.substring(0,d):c}return c.replace(/\0/g,"")}const n=r.length;let i,s,o,a="",l=0;for(;l<n;){if(i=r[l++],i===0&&e)return a;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:s=r[l++],a+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=r[l++],o=r[l++],a+=String.fromCharCode((i&15)<<12|(s&63)<<6|(o&63)<<0);break}}return a};let _i;function am(){return!_i&&typeof self.TextDecoder<"u"&&(_i=new self.TextDecoder("utf-8")),_i}const Rt={hexDump:function(r){let e="";for(let t=0;t<r.length;t++){let n=r[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},Er=Math.pow(2,32)-1,lm=[].push,aa={video:1,audio:2,id3:3,text:4};function Qe(r){return String.fromCharCode.apply(null,r)}function la(r,e){const t=r[e]<<8|r[e+1];return t<0?65536+t:t}function de(r,e){const t=ua(r,e);return t<0?4294967296+t:t}function ua(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}function xi(r,e,t){r[e]=t>>24,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t&255}function xe(r,e){const t=[];if(!e.length)return t;const n=r.byteLength;for(let i=0;i<n;){const s=de(r,i),o=Qe(r.subarray(i+4,i+8)),a=s>1?i+s:n;if(o===e[0])if(e.length===1)t.push(r.subarray(i+8,a));else{const l=xe(r.subarray(i+8,a),e.slice(1));l.length&&lm.apply(t,l)}i=a}return t}function um(r){const e=[],t=r[0];let n=8;const i=de(r,n);n+=4;const s=0,o=0;t===0?n+=8:n+=16,n+=2;let a=r.length+o;const l=la(r,n);n+=2;for(let c=0;c<l;c++){let d=n;const f=de(r,d);d+=4;const h=f&2147483647;if((f&2147483648)>>>31===1)return V.warn("SIDX has hierarchical references (not supported)"),null;const p=de(r,d);d+=4,e.push({referenceSize:h,subsegmentDuration:p,info:{duration:p/i,start:a,end:a+h-1}}),a+=h,d+=4,n=d}return{earliestPresentationTime:s,timescale:i,version:t,referencesCount:l,references:e}}function ca(r){const e=[],t=xe(r,["moov","trak"]);for(let i=0;i<t.length;i++){const s=t[i],o=xe(s,["tkhd"])[0];if(o){let a=o[0],l=a===0?12:20;const c=de(o,l),d=xe(s,["mdia","mdhd"])[0];if(d){a=d[0],l=a===0?12:20;const f=de(d,l),h=xe(s,["mdia","hdlr"])[0];if(h){const g=Qe(h.subarray(8,12)),p={soun:Le.AUDIO,vide:Le.VIDEO}[g];if(p){const m=xe(s,["mdia","minf","stbl","stsd"])[0];let y;m&&(y=Qe(m.subarray(12,16))),e[c]={timescale:f,type:p},e[p]={timescale:f,id:c,codec:y}}}}}}return xe(r,["moov","mvex","trex"]).forEach(i=>{const s=de(i,4),o=e[s];o&&(o.default={duration:de(i,12),flags:de(i,20)})}),e}function cm(r,e){if(!r||!e)return r;const t=e.keyId;return t&&e.isCommonEncryption&&xe(r,["moov","trak"]).forEach(i=>{const o=xe(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=xe(o,["enca"]);const l=a.length>0;l||(a=xe(o,["encv"])),a.forEach(c=>{const d=l?c.subarray(28):c.subarray(78);xe(d,["sinf"]).forEach(h=>{const g=da(h);if(g){const p=g.subarray(8,24);p.some(m=>m!==0)||(V.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${Rt.hexDump(p)} -> ${Rt.hexDump(t)}`),g.set(t,8))}})})}),r}function da(r){const e=xe(r,["schm"])[0];if(e){const t=Qe(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return xe(r,["schi","tenc"])[0]}return V.error("[eme] missing 'schm' box"),null}function dm(r,e){return xe(e,["moof","traf"]).reduce((t,n)=>{const i=xe(n,["tfdt"])[0],s=i[0],o=xe(n,["tfhd"]).reduce((a,l)=>{const c=de(l,4),d=r[c];if(d){let f=de(i,4);if(s===1){if(f===Er)return V.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;f*=Er+1,f+=de(i,8)}const h=d.timescale||9e4,g=f/h;if(isFinite(g)&&(a===null||g<a))return g}return a},null);return o!==null&&isFinite(o)&&(t===null||o<t)?o:t},null)}function fm(r,e){let t=0,n=0,i=0;const s=xe(r,["moof","traf"]);for(let o=0;o<s.length;o++){const a=s[o],l=xe(a,["tfhd"])[0],c=de(l,4),d=e[c];if(!d)continue;const f=d.default,h=de(l,0)|(f==null?void 0:f.flags);let g=f==null?void 0:f.duration;h&8&&(h&2?g=de(l,12):g=de(l,8));const p=d.timescale||9e4,m=xe(a,["trun"]);for(let y=0;y<m.length;y++){if(t=hm(m[y]),!t&&g){const E=de(m[y],4);t=g*E}d.type===Le.VIDEO?n+=t/p:d.type===Le.AUDIO&&(i+=t/p)}}if(n===0&&i===0){let o=0;const a=xe(r,["sidx"]);for(let l=0;l<a.length;l++){const c=um(a[l]);c!=null&&c.references&&(o+=c.references.reduce((d,f)=>d+f.info.duration||0,0))}return o}return n||i}function hm(r){const e=de(r,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const i=de(r,4);for(let s=0;s<i;s++){if(e&256){const o=de(r,t);n+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function pm(r,e,t){xe(e,["moof","traf"]).forEach(n=>{xe(n,["tfhd"]).forEach(i=>{const s=de(i,4),o=r[s];if(!o)return;const a=o.timescale||9e4;xe(n,["tfdt"]).forEach(l=>{const c=l[0];let d=de(l,4);if(c===0)d-=t*a,d=Math.max(d,0),xi(l,4,d);else{d*=Math.pow(2,32),d+=de(l,8),d-=t*a,d=Math.max(d,0);const f=Math.floor(d/(Er+1)),h=Math.floor(d%(Er+1));xi(l,4,f),xi(l,8,h)}})})})}function gm(r){const e={valid:null,remainder:null},t=xe(r,["moof"]);if(t){if(t.length<2)return e.remainder=r,e}else return e;const n=t[t.length-1];return e.valid=$t(r,0,n.byteOffset-8),e.remainder=$t(r,n.byteOffset-8),e}function en(r,e){const t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function fa(r,e){const t=[],n=e.samples,i=e.timescale,s=e.id;let o=!1;return xe(n,["moof"]).map(l=>{const c=l.byteOffset-8;xe(l,["traf"]).map(f=>{const h=xe(f,["tfdt"]).map(g=>{const p=g[0];let m=de(g,4);return p===1&&(m*=Math.pow(2,32),m+=de(g,8)),m/i})[0];return h!==void 0&&(r=h),xe(f,["tfhd"]).map(g=>{const p=de(g,4),m=de(g,0)&16777215,y=(m&1)!==0,E=(m&2)!==0,A=(m&8)!==0;let _=0;const x=(m&16)!==0;let v=0;const T=(m&32)!==0;let C=8;p===s&&(y&&(C+=8),E&&(C+=4),A&&(_=de(g,C),C+=4),x&&(v=de(g,C),C+=4),T&&(C+=4),e.type==="video"&&(o=mm(e.codec)),xe(f,["trun"]).map(k=>{const B=k[0],R=de(k,0)&16777215,I=(R&1)!==0;let S=0;const L=(R&4)!==0,b=(R&256)!==0;let w=0;const M=(R&512)!==0;let O=0;const D=(R&1024)!==0,F=(R&2048)!==0;let U=0;const K=de(k,4);let N=8;I&&(S=de(k,N),N+=4),L&&(N+=4);let G=S+c;for(let H=0;H<K;H++){if(b?(w=de(k,N),N+=4):w=_,M?(O=de(k,N),N+=4):O=v,D&&(N+=4),F&&(B===0?U=de(k,N):U=ua(k,N),N+=4),e.type===Le.VIDEO){let Z=0;for(;Z<O;){const J=de(n,G);if(G+=4,ym(o,n[G])){const X=n.subarray(G,G+J);ha(X,o?2:1,r+U/i,t)}G+=J,Z+=J+4}}r+=w/i}}))})})}),t}function mm(r){if(!r)return!1;const e=r.indexOf("."),t=e<0?r:r.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function ym(r,e){if(r){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function ha(r,e,t,n){const i=pa(r);let s=0;s+=e;let o=0,a=0,l=!1,c=0;for(;s<i.length;){o=0;do{if(s>=i.length)break;c=i[s++],o+=c}while(c===255);a=0;do{if(s>=i.length)break;c=i[s++],a+=c}while(c===255);const d=i.length-s;if(!l&&o===4&&s<i.length){if(l=!0,i[s++]===181){const h=la(i,s);if(s+=2,h===49){const g=de(i,s);if(s+=4,g===1195456820){const p=i[s++];if(p===3){const m=i[s++],y=31&m,E=64&m,A=E?2+y*3:0,_=new Uint8Array(A);if(E){_[0]=m;for(let x=1;x<A;x++)_[x]=i[s++]}n.push({type:p,payloadType:o,pts:t,bytes:_})}}}}}else if(o===5&&a<d){if(l=!0,a>16){const f=[];for(let p=0;p<16;p++){const m=i[s++].toString(16);f.push(m.length==1?"0"+m:m),(p===3||p===5||p===7||p===9)&&f.push("-")}const h=a-16,g=new Uint8Array(h);for(let p=0;p<h;p++)g[p]=i[s++];n.push({payloadType:o,pts:t,uuid:f.join(""),userData:Lt(g),userDataBytes:g})}}else if(a<d)s+=a;else if(a>d)break}}function pa(r){const e=r.byteLength,t=[];let n=1;for(;n<e-2;)r[n]===0&&r[n+1]===0&&r[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return r;const i=e-t.length,s=new Uint8Array(i);let o=0;for(n=0;n<i;o++,n++)o===t[0]&&(o++,t.shift()),s[n]=r[o];return s}function Em(r){const e=r[0];let t="",n="",i=0,s=0,o=0,a=0,l=0,c=0;if(e===0){for(;Qe(r.subarray(c,c+1))!=="\0";)t+=Qe(r.subarray(c,c+1)),c+=1;for(t+=Qe(r.subarray(c,c+1)),c+=1;Qe(r.subarray(c,c+1))!=="\0";)n+=Qe(r.subarray(c,c+1)),c+=1;n+=Qe(r.subarray(c,c+1)),c+=1,i=de(r,12),s=de(r,16),a=de(r,20),l=de(r,24),c=28}else if(e===1){c+=4,i=de(r,c),c+=4;const f=de(r,c);c+=4;const h=de(r,c);for(c+=4,o=2**32*f+h,Number.isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,V.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=de(r,c),c+=4,l=de(r,c),c+=4;Qe(r.subarray(c,c+1))!=="\0";)t+=Qe(r.subarray(c,c+1)),c+=1;for(t+=Qe(r.subarray(c,c+1)),c+=1;Qe(r.subarray(c,c+1))!=="\0";)n+=Qe(r.subarray(c,c+1)),c+=1;n+=Qe(r.subarray(c,c+1)),c+=1}const d=r.subarray(c,r.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:d}}function vm(r,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(r,4),i=0,n=8;i<t;i++)s.set(e[i],n),n+=e[i].byteLength;return s}function Am(r,e,t){if(r.byteLength!==16)throw new RangeError("Invalid system id");let n,i;if(e){n=1,i=new Uint8Array(e.length*16);for(let a=0;a<e.length;a++){const l=e[a];if(l.byteLength!==16)throw new RangeError("Invalid key");i.set(l,a*16)}}else n=0,i=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),vm([112,115,115,104],new Uint8Array([n,0,0,0]),r,s,i,o,t||new Uint8Array)}function _m(r){if(!(r instanceof ArrayBuffer)||r.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(r),n=t.getUint32(0);if(r.byteLength!==n&&n>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=Rt.hexDump(new Uint8Array(r,12,16));const s=t.getUint32(28);if(e.version===0){if(n-32<s)return null;e.data=new Uint8Array(r,32,s)}else if(e.version===1){e.kids=[];for(let o=0;o<s;o++)e.kids.push(new Uint8Array(r,32+o*16,16))}return e}let vr={};class Kn{static clearKeyUriToKeyIdMap(){vr={}}constructor(e,t,n,i=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case rt.FAIRPLAY:case rt.WIDEVINE:case rt.PLAYREADY:case rt.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&V.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=xm(e);return new Kn(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=zg(this.uri);if(t)switch(this.keyFormat){case rt.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case rt.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Am(n,null,t);const i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(i)),o=s.substring(s.indexOf("<"),s.length),c=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(c){const d=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(d){const f=Ei(d).subarray(0,16);Yg(f),this.keyId=f}}break}default:{let n=t.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=vr[this.uri];if(!n){const i=Object.keys(vr).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),vr[this.uri]=n}this.keyId=n}return this}}function xm(r){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=r>>8*(15-t)&255;return e}const ga=/\{\$([a-zA-Z0-9-_]+)\}/g;function ma(r){return ga.test(r)}function it(r,e,t){if(r.variableList!==null||r.hasVariableRefs)for(let n=t.length;n--;){const i=t[n],s=e[i];s&&(e[i]=Si(r,s))}}function Si(r,e){if(r.variableList!==null||r.hasVariableRefs){const t=r.variableList;return e.replace(ga,n=>{const i=n.substring(2,n.length-1),s=t==null?void 0:t[i];return s===void 0?(r.playlistParsingError||(r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):s})}return e}function ya(r,e,t){let n=r.variableList;n||(r.variableList=n={});let i,s;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(i))s=o.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(o){r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else i=e.NAME,s=e.VALUE;i in n?r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=s||""}function Sm(r,e,t){const n=e.IMPORT;if(t&&n in t){let i=r.variableList;i||(r.variableList=i={}),i[n]=t[n]}else r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function Ar(){if(!(typeof self>"u"))return self.MediaSource||self.WebKitMediaSource}const Tm={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},Ea=Ar();function Im(r,e){const t=Tm[e];return!!t&&t[r.slice(0,4)]===!0}function Ti(r,e){var t;return(t=Ea==null?void 0:Ea.isTypeSupported(`${e||"video"}/mp4;codecs="${r}"`))!=null?t:!1}const va=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Aa=/#EXT-X-MEDIA:(.*)/g,bm=/^#EXT(?:INF|-X-TARGETDURATION):/m,_a=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Cm=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class At{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let n=t.shift()+".";return n+=parseInt(t.shift()).toString(16),n+=("000"+parseInt(t.shift()).toString(16)).slice(-4),n}return e}static resolve(e,t){return gi.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return bm.test(e)}static parseMasterPlaylist(e,t){const n=ma(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];va.lastIndex=0;let o;for(;(o=va.exec(e))!=null;)if(o[1]){var a;const c=new Pe(o[1]);it(i,c,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const d=Si(i,o[2]),f={attrs:c,bitrate:c.decimalInteger("AVERAGE-BANDWIDTH")||c.decimalInteger("BANDWIDTH"),name:c.NAME,url:At.resolve(d,t)},h=c.decimalResolution("RESOLUTION");h&&(f.width=h.width,f.height=h.height),Lm((c.CODECS||"").split(/[ ,]+/).filter(g=>g),f),f.videoCodec&&f.videoCodec.indexOf("avc1")!==-1&&(f.videoCodec=At.convertAVC1ToAVCOTI(f.videoCodec)),(a=f.unknownCodecs)!=null&&a.length||s.push(f),i.levels.push(f)}else if(o[3]){const c=o[3],d=o[4];switch(c){case"SESSION-DATA":{const f=new Pe(d);it(i,f,["DATA-ID","LANGUAGE","VALUE","URI"]);const h=f["DATA-ID"];h&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[h]=f);break}case"SESSION-KEY":{const f=xa(d,t,i);f.encrypted&&f.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(f)):V.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${d}"`);break}case"DEFINE":{{const f=new Pe(d);it(i,f,["NAME","VALUE","QUERYPARAM"]),ya(i,f,t)}break}case"CONTENT-STEERING":{const f=new Pe(d);it(i,f,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:At.resolve(f["SERVER-URI"],t),pathwayId:f["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=Sa(d);break}}}const l=s.length>0&&s.length<i.levels.length;return i.levels=l?s:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const s={},o=n.levels,a={AUDIO:o.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:o.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(Aa.lastIndex=0;(i=Aa.exec(e))!==null;){const c=new Pe(i[1]),d=c.TYPE;if(d){const f=a[d],h=s[d]||[];s[d]=h,it(n,c,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const g={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",instreamId:c["INSTREAM-ID"],name:c.NAME||c.LANGUAGE||"",type:d,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:c.LANGUAGE,url:c.URI?At.resolve(c.URI,t):""};if(f!=null&&f.length){const p=At.findGroup(f,g.groupId)||f[0];Ta(g,p,"audioCodec"),Ta(g,p,"textCodec")}h.push(g)}}return s}static parseLevelPlaylist(e,t,n,i,s,o){const a=new Qg(t),l=a.fragments;let c=null,d=0,f=0,h=0,g=0,p=null,m=new yi(i,t),y,E,A,_=-1,x=!1;for(_a.lastIndex=0,a.m3u8=e,a.hasVariableRefs=ma(e);(y=_a.exec(e))!==null;){x&&(x=!1,m=new yi(i,t),m.start=h,m.sn=d,m.cc=g,m.level=n,c&&(m.initSegment=c,m.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null));const k=y[1];if(k){m.duration=parseFloat(k);const B=(" "+y[2]).slice(1);m.title=B||null,m.tagList.push(B?["INF",k,B]:["INF",k])}else if(y[3]){if(oe(m.duration)){m.start=h,A&&Ca(m,A,a),m.sn=d,m.level=n,m.cc=g,m.urlId=s,l.push(m);const B=(" "+y[3]).slice(1);m.relurl=Si(a,B),Ia(m,p),p=m,h+=m.duration,d++,f=0,x=!0}}else if(y[4]){const B=(" "+y[4]).slice(1);p?m.setByteRange(B,p):m.setByteRange(B)}else if(y[5])m.rawProgramDateTime=(" "+y[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]),_===-1&&(_=l.length);else{if(y=y[0].match(Cm),!y){V.warn("No matches on slow regex match for level playlist!");continue}for(E=1;E<y.length&&!(typeof y[E]<"u");E++);const B=(" "+y[E]).slice(1),R=(" "+y[E+1]).slice(1),I=y[E+2]?(" "+y[E+2]).slice(1):"";switch(B){case"PLAYLIST-TYPE":a.type=R.toUpperCase();break;case"MEDIA-SEQUENCE":d=a.startSN=parseInt(R);break;case"SKIP":{const S=new Pe(R);it(a,S,["RECENTLY-REMOVED-DATERANGES"]);const L=S.decimalInteger("SKIPPED-SEGMENTS");if(oe(L)){a.skippedSegments=L;for(let w=L;w--;)l.unshift(null);d+=L}const b=S.enumeratedString("RECENTLY-REMOVED-DATERANGES");b&&(a.recentlyRemovedDateranges=b.split("	"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(R),1);break;case"VERSION":a.version=parseInt(R);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(R||I)&&m.tagList.push(I?[R,I]:[R]);break;case"DISCONTINUITY":g++,m.tagList.push(["DIS"]);break;case"GAP":m.gap=!0,m.tagList.push([B]);break;case"BITRATE":m.tagList.push([B,R]);break;case"DATERANGE":{const S=new Pe(R);it(a,S,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),it(a,S,S.clientAttrs);const L=new Zo(S,a.dateRanges[S.ID]);L.isValid||a.skippedSegments?a.dateRanges[L.id]=L:V.warn(`Ignoring invalid DATERANGE tag: "${R}"`),m.tagList.push(["EXT-X-DATERANGE",R]);break}case"DEFINE":{{const S=new Pe(R);it(a,S,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in S?Sm(a,S,o):ya(a,S,t)}break}case"DISCONTINUITY-SEQUENCE":g=parseInt(R);break;case"KEY":{const S=xa(R,t,a);if(S.isSupported()){if(S.method==="NONE"){A=void 0;break}A||(A={}),A[S.keyFormat]&&(A=Ke({},A)),A[S.keyFormat]=S}else V.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${R}"`);break}case"START":a.startTimeOffset=Sa(R);break;case"MAP":{const S=new Pe(R);if(it(a,S,["BYTERANGE","URI"]),m.duration){const L=new yi(i,t);ba(L,S,n,A),c=L,m.initSegment=c,c.rawProgramDateTime&&!m.rawProgramDateTime&&(m.rawProgramDateTime=c.rawProgramDateTime)}else ba(m,S,n,A),c=m,x=!0;break}case"SERVER-CONTROL":{const S=new Pe(R);a.canBlockReload=S.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=S.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&S.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=S.optionalFloat("PART-HOLD-BACK",0),a.holdBack=S.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const S=new Pe(R);a.partTarget=S.decimalFloatingPoint("PART-TARGET");break}case"PART":{let S=a.partList;S||(S=a.partList=[]);const L=f>0?S[S.length-1]:void 0,b=f++,w=new Pe(R);it(a,w,["BYTERANGE","URI"]);const M=new Hg(w,m,t,b,L);S.push(M),m.duration+=M.duration;break}case"PRELOAD-HINT":{const S=new Pe(R);it(a,S,["URI"]),a.preloadHint=S;break}case"RENDITION-REPORT":{const S=new Pe(R);it(a,S,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(S);break}default:V.warn(`line parsed but not handled: ${y}`);break}}}p&&!p.relurl?(l.pop(),h-=p.duration,a.partList&&(a.fragmentHint=p)):a.partList&&(Ia(m,p),m.cc=g,a.fragmentHint=m,A&&Ca(m,A,a));const v=l.length,T=l[0],C=l[v-1];if(h+=a.skippedSegments*a.targetduration,h>0&&v&&C){a.averagetargetduration=h/v;const k=C.sn;a.endSN=k!=="initSegment"?k:0,a.live||(C.endList=!0),T&&(a.startCC=T.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(h+=a.fragmentHint.duration),a.totalduration=h,a.endCC=g,_>0&&Rm(l,_),a}}function xa(r,e,t){var n,i;const s=new Pe(r);it(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=(n=s.METHOD)!=null?n:"",a=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,d=(i=s.KEYFORMAT)!=null?i:"identity";a&&s.IV&&!l&&V.error(`Invalid IV: ${s.IV}`);const f=a?At.resolve(a,e):"",h=(c||"1").split("/").map(Number).filter(Number.isFinite);return new Kn(o,f,d,h,l)}function Sa(r){const t=new Pe(r).decimalFloatingPoint("TIME-OFFSET");return oe(t)?t:null}function Lm(r,e){["video","audio","text"].forEach(t=>{const n=r.filter(i=>Im(i,t));if(n.length){const i=n.filter(s=>s.lastIndexOf("avc1",0)===0||s.lastIndexOf("mp4a",0)===0);e[`${t}Codec`]=i.length>0?i[0]:n[0],r=r.filter(s=>n.indexOf(s)===-1)}}),e.unknownCodecs=r}function Ta(r,e,t){const n=e[t];n&&(r[t]=n)}function Rm(r,e){let t=r[e];for(let n=e;n--;){const i=r[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function Ia(r,e){r.rawProgramDateTime?r.programDateTime=Date.parse(r.rawProgramDateTime):e!=null&&e.programDateTime&&(r.programDateTime=e.endProgramDateTime),oe(r.programDateTime)||(r.programDateTime=null,r.rawProgramDateTime=null)}function ba(r,e,t,n){r.relurl=e.URI,e.BYTERANGE&&r.setByteRange(e.BYTERANGE),r.level=t,r.sn="initSegment",n&&(r.levelkeys=n),r.initSegment=null}function Ca(r,e,t){r.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(r)}var Te={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ue={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function La(r){const{type:e}=r;switch(e){case Te.AUDIO_TRACK:return ue.AUDIO;case Te.SUBTITLE_TRACK:return ue.SUBTITLE;default:return ue.MAIN}}function Ii(r,e){let t=r.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class wm{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.LEVEL_LOADING,this.onLevelLoading,this),e.on(P.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(P.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.LEVEL_LOADING,this.onLevelLoading,this),e.off(P.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(P.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,s=n||i,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Te.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,url:s,deliveryDirectives:o}=t;this.load({id:n,level:i,responseType:"text",type:Te.LEVEL,url:s,deliveryDirectives:o})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Te.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Te.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const c=i.context;if(c&&c.url===e.url){V.trace("[playlist-loader]: playlist request ongoing");return}V.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let s;if(e.type===Te.MANIFEST?s=n.manifestLoadPolicy.default:s=Ke({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),(t=e.deliveryDirectives)!=null&&t.part){let c;if(e.type===Te.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===Te.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===Te.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){const d=c.partTarget,f=c.targetduration;if(d&&f){const h=Math.max(d*3,f*.8)*1e3;s=Ke({},s,{maxTimeToFirstByteMs:Math.min(h,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(h,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(c,d,f,h)=>{const g=this.getInternalLoader(f);this.resetInternalLoader(f.type);const p=c.data;if(p.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,f,new Error("no EXTM3U delimiter"),h||null,d);return}d.parsing.start=performance.now(),At.isMediaPlaylist(p)?this.handleTrackOrLevelPlaylist(c,d,f,h||null,g):this.handleMasterPlaylist(c,d,f,h)},onError:(c,d,f,h)=>{this.handleNetworkError(d,f,!1,c,h)},onTimeout:(c,d,f)=>{this.handleNetworkError(d,f,!0,void 0,c)}};i.load(e,a,l)}handleMasterPlaylist(e,t,n,i){const s=this.hls,o=e.data,a=Ii(e,n),l=At.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,i,t);return}const{contentSteering:c,levels:d,sessionData:f,sessionKeys:h,startTimeOffset:g,variableList:p}=l;this.variableList=p;const{AUDIO:m=[],SUBTITLES:y,"CLOSED-CAPTIONS":E}=At.parseMasterPlaylistMedia(o,a,l);m.length&&!m.some(_=>!_.url)&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(V.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Pe({}),bitrate:0,url:""})),s.trigger(P.MANIFEST_LOADED,{levels:d,audioTracks:m,subtitles:y,captions:E,contentSteering:c,url:a,stats:t,networkDetails:i,sessionData:f,sessionKeys:h,startTimeOffset:g,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,i,s){const o=this.hls,{id:a,level:l,type:c}=n,d=Ii(e,n),f=oe(a)?a:0,h=oe(l)?l:f,g=La(n),p=At.parseLevelPlaylist(e.data,d,h,g,f,this.variableList);if(c===Te.MANIFEST){const m={attrs:new Pe({}),bitrate:0,details:p,name:"",url:d};o.trigger(P.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:d,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,i,s)}handleManifestParsingError(e,t,n,i,s){this.hls.trigger(P.ERROR,{type:le.NETWORK_ERROR,details:W.MANIFEST_PARSING_ERROR,fatal:t.type===Te.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:s})}handleNetworkError(e,t,n=!1,i,s){let o=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===Te.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===Te.AUDIO_TRACK||e.type===Te.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);V.warn(`[playlist-loader]: ${o}`);let l=W.UNKNOWN,c=!1;const d=this.getInternalLoader(e);switch(e.type){case Te.MANIFEST:l=n?W.MANIFEST_LOAD_TIMEOUT:W.MANIFEST_LOAD_ERROR,c=!0;break;case Te.LEVEL:l=n?W.LEVEL_LOAD_TIMEOUT:W.LEVEL_LOAD_ERROR,c=!1;break;case Te.AUDIO_TRACK:l=n?W.AUDIO_TRACK_LOAD_TIMEOUT:W.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case Te.SUBTITLE_TRACK:l=n?W.SUBTITLE_TRACK_LOAD_TIMEOUT:W.SUBTITLE_LOAD_ERROR,c=!1;break}d&&this.resetInternalLoader(e.type);const f={type:le.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:d,context:e,error:a,networkDetails:t,stats:s};if(i){const h=(t==null?void 0:t.url)||e.url;f.response=nt({url:h,data:void 0},i)}this.hls.trigger(P.ERROR,f)}handlePlaylistLoaded(e,t,n,i,s,o){const a=this.hls,{type:l,level:c,id:d,groupId:f,deliveryDirectives:h}=i,g=Ii(t,i),p=La(i),m=typeof i.level=="number"&&p===ue.MAIN?c:void 0;if(!e.fragments.length){const E=new Error("No Segments found in Playlist");a.trigger(P.ERROR,{type:le.NETWORK_ERROR,details:W.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:E,reason:E.message,response:t,context:i,level:m,parent:p,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const y=e.playlistParsingError;if(y){a.trigger(P.ERROR,{type:le.NETWORK_ERROR,details:W.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:y,reason:y.message,response:t,context:i,level:m,parent:p,networkDetails:s,stats:n});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case Te.MANIFEST:case Te.LEVEL:a.trigger(P.LEVEL_LOADED,{details:e,level:m||0,id:d||0,stats:n,networkDetails:s,deliveryDirectives:h});break;case Te.AUDIO_TRACK:a.trigger(P.AUDIO_TRACK_LOADED,{details:e,id:d||0,groupId:f||"",stats:n,networkDetails:s,deliveryDirectives:h});break;case Te.SUBTITLE_TRACK:a.trigger(P.SUBTITLE_TRACK_LOADED,{details:e,id:d||0,groupId:f||"",stats:n,networkDetails:s,deliveryDirectives:h});break}}}function Ra(r,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=r,e.dispatchEvent(t)}function wa(r,e){const t=r.mode;if(t==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(e.id))try{if(r.addCue(e),!r.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){V.debug(`[texttrack-utils]: ${n}`);const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,r.addCue(i)}t==="disabled"&&(r.mode=t)}function mn(r){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues)for(let t=r.cues.length;t--;)r.removeCue(r.cues[t]);e==="disabled"&&(r.mode=e)}function bi(r,e,t,n){const i=r.mode;if(i==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){const s=Dm(r.cues,e,t);for(let o=0;o<s.length;o++)(!n||n(s[o]))&&r.removeCue(s[o])}i==="disabled"&&(r.mode=i)}function km(r,e){if(e<r[0].startTime)return 0;const t=r.length-1;if(e>r[t].endTime)return-1;let n=0,i=t;for(;n<=i;){const s=Math.floor((i+n)/2);if(e<r[s].startTime)i=s-1;else if(e>r[s].startTime&&n<t)n=s+1;else return s}return r[n].startTime-e<e-r[i].startTime?n:i}function Dm(r,e,t){const n=[],i=km(r,e);if(i>-1)for(let s=i,o=r.length;s<o;s++){const a=r[s];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}var _t={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const Om=.25;function Ci(){if(!(typeof self>"u"))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const _r=(()=>{const r=Ci();try{new r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Li(r,e){return r.getTime()/1e3-e}function Pm(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Bm{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(P.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(P.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(mn(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return Ra(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Ci();for(let a=0;a<s.length;a++){const l=s[a].type;if(l===_t.emsg&&!n||!i)continue;const c=oa(s[a].data);if(c){const d=s[a].pts;let f=d+s[a].duration;f>_r&&(f=_r),f-d<=0&&(f=d+Om);for(let g=0;g<c.length;g++){const p=c[g];if(!sa(p)){this.updateId3CueEnds(d);const m=new o(d,f,"");m.value=p,l&&(m.type=l),this.id3Track.addCue(m)}}}}}updateId3CueEnds(e){var t;const n=(t=this.id3Track)==null?void 0:t.cues;if(n)for(let i=n.length;i--;){const s=n[i];s.startTime<e&&s.endTime===_r&&(s.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(s&&(a||l)){let c;i==="audio"?c=d=>d.type===_t.audioId3&&l:i==="video"?c=d=>d.type===_t.emsg&&a:c=d=>d.type===_t.audioId3&&l||d.type===_t.emsg&&a,bi(s,t,n,c)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:s}=t,o=Object.keys(s);if(i){const d=Object.keys(n).filter(f=>!o.includes(f));for(let f=d.length;f--;){const h=d[f];Object.keys(n[h].cues).forEach(g=>{i.removeCue(n[h].cues[g])}),delete n[h]}}const a=t.fragments[t.fragments.length-1];if(o.length===0||!oe(a==null?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=a.programDateTime/1e3-a.start,c=Ci();for(let d=0;d<o.length;d++){const f=o[d],h=s[f],g=n[f],p=(g==null?void 0:g.cues)||{};let m=(g==null?void 0:g.durationKnown)||!1;const y=Li(h.startDate,l);let E=_r;const A=h.endDate;if(A)E=Li(A,l),m=!0;else if(h.endOnNext&&!m){const x=o.reduce((v,T)=>{const C=s[T];return C.class===h.class&&C.id!==T&&C.startDate>h.startDate&&v.push(C),v},[]).sort((v,T)=>v.startDate.getTime()-T.startDate.getTime())[0];x&&(E=Li(x.startDate,l),m=!0)}const _=Object.keys(h.attr);for(let x=0;x<_.length;x++){const v=_[x];if(!Gg(v))continue;let T=p[v];if(T)m&&!g.durationKnown&&(T.endTime=E);else{let C=h.attr[v];T=new c(y,E,""),jg(v)&&(C=Pm(C)),T.value={key:v,data:C},T.type=_t.dateRange,T.id=f,this.id3Track.addCue(T),p[v]=T}}n[f]={cues:p,dateRange:h,durationKnown:m}}}}class Mm{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let c=a&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=s!==void 0?s:o*i);const d=i,f=1;return c+Math.min(this.stallCount*f,d)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const i=n.edge,s=e-t-this.edgeStalled,o=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,s),a)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(P.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(P.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(P.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(P.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(P.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(P.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===W.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&V.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:s}=this.config;if(!i||s===1)return;const o=this.targetLatency;if(o===null)return;const a=n-o,l=Math.min(this.maxLatency,o+t.targetduration),c=a<l;if(t.live&&c&&a>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,s)),f=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(d,Math.max(1,f))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const Ri=["NONE","TYPE-0","TYPE-1",null];var Gn={No:"",Yes:"YES",v2:"v2"};function Fm(r,e){const{canSkipUntil:t,canSkipDateRanges:n,endSN:i}=r,s=e!==void 0?e-i:0;return t&&s<t?n?Gn.v2:Gn.Yes:Gn.No}class ka{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class jn{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return(e=this.audioGroupIds)==null?void 0:e[this.urlId]}get textGroupId(){var e;return(e=this.textGroupIds)==null?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function wi(r,e){const t=e.startPTS;if(oe(t)){let n=0,i;e.sn>r.sn?(n=t-r.start,i=r):(n=r.start-t,i=e),i.duration!==n&&(i.duration=n)}else e.sn>r.sn?r.cc===e.cc&&r.minEndPTS?e.start=r.start+(r.minEndPTS-r.start):e.start=r.start+r.duration:e.start=Math.max(r.start-e.duration,0)}function Da(r,e,t,n,i,s){n-t<=0&&(V.warn("Fragment should have a positive duration",e),n=t+e.duration,s=i+e.duration);let a=t,l=n;const c=e.startPTS,d=e.endPTS;if(oe(c)){const y=Math.abs(c-t);oe(e.deltaPTS)?e.deltaPTS=Math.max(y,e.deltaPTS):e.deltaPTS=y,a=Math.max(t,c),t=Math.min(t,c),i=Math.min(i,e.startDTS),l=Math.min(n,d),n=Math.max(n,d),s=Math.max(s,e.endDTS)}const f=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=a,e.startDTS=i,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;const h=e.sn;if(!r||h<r.startSN||h>r.endSN)return 0;let g;const p=h-r.startSN,m=r.fragments;for(m[p]=e,g=p;g>0;g--)wi(m[g],m[g-1]);for(g=p;g<m.length-1;g++)wi(m[g],m[g+1]);return r.fragmentHint&&wi(m[m.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,f}function Nm(r,e){let t=null;const n=r.fragments;for(let l=n.length-1;l>=0;l--){const c=n[l].initSegment;if(c){t=c;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let i=0,s;if(Km(r,e,(l,c)=>{l.relurl&&(i=l.cc-c.cc),oe(l.startPTS)&&oe(l.endPTS)&&(c.start=c.startPTS=l.startPTS,c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.duration=l.endPTS-l.startPTS,c.duration&&(s=c),e.PTSKnown=e.alignedSliding=!0),c.elementaryStreams=l.elementaryStreams,c.loader=l.loader,c.stats=l.stats,c.urlId=l.urlId,l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(c=>{var d;(!c.initSegment||c.initSegment.relurl===((d=t)==null?void 0:d.relurl))&&(c.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){V.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=Um(r.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const o=e.fragments;if(i){V.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<o.length;l++)o[l].cc+=i}e.skippedSegments&&(e.startCC=e.fragments[0].cc),Vm(r.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),s?Da(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):Oa(r,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=r.driftStartTime,e.driftStart=r.driftStart;const a=e.advancedDateTime;if(e.advanced&&a){const l=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=l),e.driftEndTime=a,e.driftEnd=l}else e.driftEndTime=r.driftEndTime,e.driftEnd=r.driftEnd,e.advancedDateTime=r.advancedDateTime}function Um(r,e,t){const n=Ke({},r);return t&&t.forEach(i=>{delete n[i]}),Object.keys(e).forEach(i=>{const s=new Zo(e[i].attr,n[i]);s.isValid?n[i]=s:V.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),n}function Vm(r,e,t){if(r&&e){let n=0;for(let i=0,s=r.length;i<=s;i++){const o=r[i],a=e[i+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function Km(r,e,t){const n=e.skippedSegments,i=Math.max(r.startSN,e.startSN)-e.startSN,s=(r.fragmentHint?1:0)+(n?e.endSN:Math.min(r.endSN,e.endSN))-e.startSN,o=e.startSN-r.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let c=i;c<=s;c++){const d=l[o+c];let f=a[c];n&&!f&&c<n&&(f=e.fragments[c]=d),d&&f&&t(d,f)}}function Oa(r,e){const t=e.startSN+e.skippedSegments-r.startSN,n=r.fragments;t<0||t>=n.length||ki(e,n[t].start)}function ki(r,e){if(e){const t=r.fragments;for(let n=r.skippedSegments;n<t.length;n++)t[n].start+=e;r.fragmentHint&&(r.fragmentHint.start+=e)}}function Gm(r,e=1/0){let t=1e3*r.targetduration;if(r.updated){const n=r.fragments,i=4;if(n.length&&t*i>e){const s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function jm(r,e,t){if(!(r!=null&&r.details))return null;const n=r.details;let i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&t&&t.sn===e?t:null}function Pa(r,e,t){var n;return r!=null&&r.details?Ba((n=r.details)==null?void 0:n.partList,e,t):null}function Ba(r,e,t){if(r)for(let n=r.length;n--;){const i=r[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function xr(r){switch(r.details){case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_TIMEOUT:case W.LEVEL_LOAD_TIMEOUT:case W.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Ma(r,e){const t=xr(e);return r.default[`${t?"timeout":"error"}Retry`]}function Di(r,e){const t=r.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*r.retryDelayMs,r.maxRetryDelayMs)}function Fa(r){return nt(nt({},r),{errorRetry:null,timeoutRetry:null})}function Sr(r,e,t,n){return!!r&&e<r.maxNumRetry&&(Hm(n)||!!t)}function Hm(r){return r===0&&navigator.onLine===!1||!!r&&(r<400||r>499)}const Na={search:function(r,e){let t=0,n=r.length-1,i=null,s=null;for(;t<=n;){i=(t+n)/2|0,s=r[i];const o=e(s);if(o>0)t=i+1;else if(o<0)n=i-1;else return s}return null}};function Wm(r,e,t){if(e===null||!Array.isArray(r)||!r.length||!oe(e))return null;const n=r[0].programDateTime;if(e<(n||0))return null;const i=r[r.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let s=0;s<r.length;++s){const o=r[s];if(Qm(e,t,o))return o}return null}function Hn(r,e,t=0,n=0){let i=null;if(r?i=e[r.sn-e[0].sn+1]||null:t===0&&e[0].start===0&&(i=e[0]),i&&Oi(t,n,i)===0)return i;const s=Na.search(e,Oi.bind(null,t,n));return s&&(s!==r||!i)?s:i}function Oi(r=0,e=0,t){if(t.start<=r&&t.start+t.duration>r)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=r?1:t.start-n>r&&t.start?-1:0}function Qm(r,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>r}function Jm(r,e){return Na.search(r,t=>t.cc<e?1:t.cc>e?-1:0)}const Ym=3e5;var st={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},xt={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class zm{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=V.log.bind(V,"[info]:"),this.warn=V.warn.bind(V,"[warning]:"),this.error=V.error.bind(V,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(P.ERROR,this.onError,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this)}unregisterListeners(){const e=this.hls;e&&(e.off(P.ERROR,this.onError,this),e.off(P.ERROR,this.onErrorOut,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(e==null?void 0:e.type)===ue.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onError(e,t){var n;if(t.fatal)return;const i=this.hls,s=t.context;switch(t.details){case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case W.FRAG_GAP:case W.FRAG_PARSING_ERROR:case W.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=st.SendAlternateToPenaltyBox;return}case W.LEVEL_EMPTY_ERROR:case W.LEVEL_PARSING_ERROR:{var o,a;const l=t.parent===ue.MAIN?t.level:i.loadLevel;t.details===W.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(a=o.levelDetails)!=null&&a.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l))}return;case W.LEVEL_LOAD_ERROR:case W.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case W.AUDIO_TRACK_LOAD_ERROR:case W.AUDIO_TRACK_LOAD_TIMEOUT:case W.SUBTITLE_LOAD_ERROR:case W.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const l=i.levels[i.loadLevel];if(l&&(s.type===Te.AUDIO_TRACK&&s.groupId===l.audioGroupId||s.type===Te.SUBTITLE_TRACK&&s.groupId===l.textGroupId)){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=st.SendAlternateToPenaltyBox,t.errorAction.flags=xt.MoveAllAlternatesMatchingHost;return}}return;case W.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const l=i.levels[i.loadLevel],c=l==null?void 0:l.attrs["HDCP-LEVEL"];c&&(t.errorAction={action:st.SendAlternateToPenaltyBox,flags:xt.MoveAllAlternatesMatchingHDCP,hdcpLevel:c})}return;case W.BUFFER_ADD_CODEC_ERROR:case W.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,(n=t.level)!=null?n:i.loadLevel);return;case W.INTERNAL_EXCEPTION:case W.BUFFER_APPENDING_ERROR:case W.BUFFER_APPEND_ERROR:case W.BUFFER_FULL_ERROR:case W.LEVEL_SWITCH_ERROR:case W.BUFFER_STALLED_ERROR:case W.BUFFER_SEEK_OVER_HOLE:case W.BUFFER_NUDGE_ON_STALL:t.errorAction={action:st.DoNothing,flags:xt.None};return}if(t.type===le.KEY_SYSTEM_ERROR){const l=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l);return}}getPlaylistRetryOrSwitchAction(e,t){var n;const i=this.hls,s=Ma(i.config.playlistLoadPolicy,e),o=this.playlistError++,a=(n=e.response)==null?void 0:n.code;if(Sr(s,o,xr(e),a))return{action:st.RetryRequest,flags:xt.None,retryConfig:s,retryCount:o};const c=this.getLevelSwitchAction(e,t);return s&&(c.retryConfig=s,c.retryCount=o),c}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,a=Ma(e.details.startsWith("key")?o:s,e),l=t.levels.reduce((f,h)=>f+h.fragmentError,0);if(i){var c;e.details!==W.FRAG_GAP&&i.fragmentError++;const f=(c=e.response)==null?void 0:c.code;if(Sr(a,l,xr(e),f))return{action:st.RetryRequest,flags:xt.None,retryConfig:a,retryCount:l}}const d=this.getLevelSwitchAction(e,n);return a&&(d.retryConfig=a,d.retryCount=l),d}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i&&(i.loadError++,n.autoLevelEnabled)){var s,o;let a=-1;const l=n.levels,c=(s=e.frag)==null?void 0:s.type,{type:d,groupId:f}=(o=e.context)!=null?o:{};for(let h=l.length;h--;){const g=(h+n.loadLevel)%l.length;if(g!==n.loadLevel&&l[g].loadError===0){const p=l[g];if(e.details===W.FRAG_GAP&&e.frag){const m=l[g].details;if(m){const y=Hn(e.frag,m.fragments,e.frag.start);if(y!=null&&y.gap)continue}}else{if(d===Te.AUDIO_TRACK&&f===p.audioGroupId||d===Te.SUBTITLE_TRACK&&f===p.textGroupId)continue;if(c===ue.AUDIO&&i.audioGroupId===p.audioGroupId||c===ue.SUBTITLE&&i.textGroupId===p.textGroupId)continue}a=g;break}}if(a>-1&&n.loadLevel!==a)return e.levelRetry=!0,{action:st.SendAlternateToPenaltyBox,flags:xt.None,nextAutoLevel:a}}return{action:st.SendAlternateToPenaltyBox,flags:xt.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case st.DoNothing:break;case st.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==W.FRAG_GAP&&(t.fatal=!0);break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:s,nextAutoLevel:o}=n;switch(i){case xt.None:this.switchLevel(e,o);break;case xt.MoveAllAlternatesMatchingHost:n.resolved||(n.resolved=this.redundantFailover(e));break;case xt.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=Ri[Ri.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:n}=this,i=e.parent===ue.MAIN?e.level:t.loadLevel,s=t.levels[i],o=s.url.length,a=e.frag?e.frag.urlId:s.urlId;s.urlId===a&&(!e.frag||s.details)&&this.penalizeRendition(s,e);for(let l=1;l<o;l++){const c=(a+l)%o,d=n[c];if(!d||qm(d,e,n[a]))return this.warn(`Switching to Redundant Stream ${c+1}/${o}: "${s.url[c]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(f=>{f.urlId=c}),t.nextLoadLevel=i,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:n}=this,i=n[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};i.lastErrorPerfMs=performance.now(),i.errors.push(t),i.details=e.details,n[e.urlId]=i}}function qm(r,e,t){if(performance.now()-r.lastErrorPerfMs>Ym)return!0;const n=r.details;if(e.details===W.FRAG_GAP&&n&&e.frag){const i=e.frag.start,s=Hn(null,n.fragments,i);if(s&&!s.gap)return!0}if(t&&r.errors.length<t.errors.length){const i=r.errors[r.errors.length-1];if(n&&i.frag&&e.frag&&Math.abs(i.frag.start-e.frag.start)>n.targetduration*3)return!0}return!1}class Pi{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=V.log.bind(V,`${t}:`),this.warn=V.warn.bind(V,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const n=t==null?void 0:t.renditionReports;if(n){let i=-1;for(let s=0;s<n.length;s++){const o=n[s];let a;try{a=new self.URL(o.URI,t.url).href}catch(l){V.warn(`Could not construct new URL for Rendition Report: ${l}`),a=o.URI||""}if(a===e){i=s;break}else a===e.substring(0,a.length)&&(i=s)}if(i!==-1){const s=n[i],o=parseInt(s["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let a=parseInt(s["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const l=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&l>t.partTarget&&(a+=1)}return new ka(o,a>=0?a:void 0,Gn.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:s}=t,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;if(i.advancedDateTime=Date.now()-a,i.live||n!=null&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED"}`),n&&i.fragments.length>0&&Nm(n,i),!this.canLoad||!i.live)return;let l,c,d;if(i.canBlockReload&&i.endSN&&i.advanced){const y=this.hls.config.lowLatencyMode,E=i.lastPartSn,A=i.endSN,_=i.lastPartIndex,x=_!==-1,v=E===A,T=y?0:_;x?(c=v?A+1:E,d=v?T:_+1):c=A+1;const C=i.age,k=C+i.ageHeader;let B=Math.min(k-i.partTarget,i.targetduration*1.5);if(B>0){if(n&&B>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${B} with playlist age: ${i.age}`),B=0;else{const R=Math.floor(B/i.targetduration);if(c+=R,d!==void 0){const I=Math.round(B%i.targetduration/i.partTarget);d+=I}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${C.toFixed(2)}s goal: ${B} skip sn ${R} to part ${d}`)}i.tuneInGoal=B}if(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,d),y||!v){this.loadPlaylist(l);return}}else i.canBlockReload&&(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,d));const f=this.hls.mainForwardBufferInfo,h=f?f.end-f.len:0,g=(i.edge-h)*1e3,p=Gm(i,g);i.updated&&o>this.requestScheduled+p&&(this.requestScheduled=s.loading.start),c!==void 0&&i.canBlockReload?this.requestScheduled=s.loading.first+p-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+p<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=p);let m=this.requestScheduled-o;m=Math.max(0,m),this.log(`reload live playlist ${e} in ${Math.round(m)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),m)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let s=Fm(e,n);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,s=Gn.No),new ka(n,i,s)}checkRetry(e){const t=e.details,n=xr(e),i=e.errorAction,{action:s,retryCount:o=0,retryConfig:a}=i||{},l=!!i&&!!a&&(s===st.RetryRequest||!i.resolved&&s===st.SendAlternateToPenaltyBox);if(l){var c;if(this.requestScheduled=-1,n&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const d=Di(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),d),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${d}ms`)}e.levelRetry=!0,i.resolved=!0}return l}}let Bi;class Zm extends Pi{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(P.LEVEL_LOADED,this.onLevelLoaded,this),e.on(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(P.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(P.FRAG_LOADED,this.onFragLoaded,this),e.on(P.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(P.LEVEL_LOADED,this.onLevelLoaded,this),e.off(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(P.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(P.FRAG_LOADED,this.onFragLoaded,this),e.off(P.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=[],i={};let s;t.levels.forEach(o=>{var a;const l=o.attrs;((a=o.audioCodec)==null?void 0:a.indexOf("mp4a.40.34"))!==-1&&(Bi||(Bi=/chrome|firefox/i.test(navigator.userAgent)),Bi&&(o.audioCodec=void 0));const{AUDIO:c,CODECS:d,"FRAME-RATE":f,"PATHWAY-ID":h,RESOLUTION:g,SUBTITLES:p}=l,y=`${`${h||"."}-`}${o.bitrate}-${g}-${f}-${d}`;s=i[y],s?s.addFallback(o):(s=new jn(o),i[y]=s,n.push(s)),Tr(s,"audio",c),Tr(s,"text",p)}),this.filterAndSortMediaOptions(n,t)}filterAndSortMediaOptions(e,t){let n=[],i=[],s=!1,o=!1,a=!1,l=e.filter(({audioCodec:g,videoCodec:p,width:m,height:y,unknownCodecs:E})=>(s||(s=!!(m&&y)),o||(o=!!p),a||(a=!!g),!(E!=null&&E.length)&&(!g||Ti(g,"audio"))&&(!p||Ti(p,"video"))));if((s||o)&&a&&(l=l.filter(({videoCodec:g,width:p,height:m})=>!!g||!!(p&&m))),l.length===0){Promise.resolve().then(()=>{if(this.hls){const g=new Error("no level with compatible codecs found in manifest");this.hls.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:g,reason:g.message})}});return}t.audioTracks&&(n=t.audioTracks.filter(g=>!g.audioCodec||Ti(g.audioCodec,"audio")),Ua(n)),t.subtitles&&(i=t.subtitles,Ua(i));const c=l.slice(0);l.sort((g,p)=>g.attrs["HDCP-LEVEL"]!==p.attrs["HDCP-LEVEL"]?(g.attrs["HDCP-LEVEL"]||"")>(p.attrs["HDCP-LEVEL"]||"")?1:-1:g.bitrate!==p.bitrate?g.bitrate-p.bitrate:g.attrs["FRAME-RATE"]!==p.attrs["FRAME-RATE"]?g.attrs.decimalFloatingPoint("FRAME-RATE")-p.attrs.decimalFloatingPoint("FRAME-RATE"):g.attrs.SCORE!==p.attrs.SCORE?g.attrs.decimalFloatingPoint("SCORE")-p.attrs.decimalFloatingPoint("SCORE"):s&&g.height!==p.height?g.height-p.height:0);let d=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let g=0;g<c.length;g++)if(c[g].pathwayId===l[0].pathwayId){d=c[g];break}}this._levels=l;for(let g=0;g<l.length;g++)if(l[g]===d){this._firstLevel=g,this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${d.bitrate}`);break}const f=a&&!o,h={levels:l,audioTracks:n,subtitleTracks:i,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:o,altAudio:!f&&n.some(g=>!!g.url)};this.hls.trigger(P.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const d=new Error("invalid level idx"),f=e<0;if(this.hls.trigger(P.ERROR,{type:le.OTHER_ERROR,details:W.LEVEL_SWITCH_ERROR,level:e,fatal:f,error:d,reason:d.message}),f)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,s=i?i.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&i&&s===a)return;this.log(`Switching to level ${e}${a?" with Pathway "+a:""} from level ${n}${s?" with Pathway "+s:""}`);const l=Ke({},o,{level:e,maxBitrate:o.maxBitrate,attrs:o.attrs,uri:o.uri,urlId:o.urlId});delete l._attrs,delete l._urlId,this.hls.trigger(P.LEVEL_SWITCHING,l);const c=o.details;if(!c||c.live){const d=this.switchParams(o.uri,i==null?void 0:i.details);this.loadPlaylist(d)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this._firstLevel}else return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Te.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(t!==void 0&&t.type===ue.MAIN){const n=this._levels[t.level];n!==void 0&&(n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:s}=t,o=this._levels[i];if(!o){var a;this.warn(`Invalid level index ${i}`),(a=t.deliveryDirectives)!=null&&a.skip&&(s.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(i,t,o.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const n=this.currentLevel;if(!n)return;const i=this.hls.audioTracks[t.id].groupId;if(n.audioGroupIds&&n.audioGroupId!==i){let s=-1;for(let o=0;o<n.audioGroupIds.length;o++)if(n.audioGroupIds[o]===i){s=o;break}s!==-1&&s!==n.urlId&&(n.urlId=s,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){const i=n.urlId;let s=n.uri;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}const o=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${o?" Pathway "+o:""} URI ${i+1}/${n.url.length} ${s}`),this.clearTimer(),this.hls.trigger(P.LEVEL_LOADING,{url:s,level:t,id:i,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const n=(s,o)=>o!==t,i=this._levels.filter((s,o)=>o!==e?!0:s.url.length>1&&t!==void 0?(s.url=s.url.filter(n),s.audioGroupIds&&(s.audioGroupIds=s.audioGroupIds.filter(n)),s.textGroupIds&&(s.textGroupIds=s.textGroupIds.filter(n)),s.urlId=0,!0):(this.steering&&this.steering.removeLevel(s),!1));this.hls.trigger(P.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){t.forEach((n,i)=>{const{details:s}=n;s!=null&&s.fragments&&s.fragments.forEach(o=>{o.level=i})}),this._levels=t}}function Tr(r,e,t){t&&(e==="audio"?(r.audioGroupIds||(r.audioGroupIds=[]),r.audioGroupIds[r.url.length-1]=t):e==="text"&&(r.textGroupIds||(r.textGroupIds=[]),r.textGroupIds[r.url.length-1]=t))}function Ua(r){const e={};r.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}var Je={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Xm{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(P.BUFFER_APPENDED,this.onBufferAppended,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this),e.on(P.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(P.BUFFER_APPENDED,this.onBufferAppended,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this),e.off(P.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const s=n[i];if(!s)break;const o=s.end;if(s.start<=e&&o!==null&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let s=i.length;s--;){const o=n[i[s]];if((o==null?void 0:o.body.type)===t&&o.buffered){const a=o.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const s=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a||s>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===n&&this.removeFragment(a.body);return}const l=a.range[e];l&&l.time.some(c=>{const d=!this.isTimeBuffered(c.startPTS,c.endPTS,t);return d&&this.removeFragment(a.body),d})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||n.sn==="initSegment")return;const s=yn(n),o=this.fragments[s];if(!o)return;const a=!n.relurl;Object.keys(t).forEach(l=>{const c=n.elementaryStreams[l];if(!c)return;const d=t[l],f=a||c.partial===!0;o.range[l]=this.getBufferedTimes(n,i,f,d)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,o.body.endList&&(this.endListFragments[o.body.type]=o),Ir(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=yn(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const s={time:[],partial:n},o=e.start,a=e.end,l=e.minEndPTS||a,c=e.maxStartPTS||o;for(let d=0;d<i.length;d++){const f=i.start(d)-this.bufferPadding,h=i.end(d)+this.bufferPadding;if(c>=f&&l<=h){s.time.push({startPTS:Math.max(o,i.start(d)),endPTS:Math.min(a,i.end(d))});break}else if(o<h&&a>f)s.partial=!0,s.time.push({startPTS:Math.max(o,i.start(d)),endPTS:Math.min(a,i.end(d))});else if(a<=f)break}return s}getPartialFragment(e){let t=null,n,i,s,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(c=>{const d=l[c];d&&Ir(d)&&(i=d.body.start-a,s=d.body.end+a,e>=i&&e<=s&&(n=Math.min(e-i,s-e),o<=n&&(t=d.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ir(t))}getState(e){const t=yn(e),n=this.fragments[t];return n?n.buffered?Ir(n)?Je.PARTIAL:Je.OK:Je.APPENDING:Je.NOT_LOADED}isTimeBuffered(e,t,n){let i,s;for(let o=0;o<n.length;o++){if(i=n.start(o)-this.bufferPadding,s=n.end(o)+this.bufferPadding,e>=i&&t<=s)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const s=i?null:t,o=yn(n);this.fragments[o]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:s}=t;if(n.sn==="initSegment")return;const o=n.type;if(i){let a=this.activePartLists[o];a||(this.activePartLists[o]=a=[]),a.push(i)}this.timeRanges=s,Object.keys(s).forEach(a=>{const l=s[a];this.detectEvictedFragments(a,l,o,i)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=yn(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,s){i&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==n||i&&!l.gap||l.start<t&&l.end>e&&(a.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=yn(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Ir(r){var e,t,n;return r.buffered&&(r.body.gap||((e=r.range.video)==null?void 0:e.partial)||((t=r.range.audio)==null?void 0:t.partial)||((n=r.range.audiovideo)==null?void 0:n.partial))}function yn(r){return`${r.type}_${r.level}_${r.urlId}_${r.sn}`}const Va=Math.pow(2,17);class $m{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Pt({type:le.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,s=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap){l(Ga(e));return}const c=this.loader=e.loader=s?new s(i):new o(i),d=Ka(e),f=Fa(i.fragLoadPolicy.default),h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Va};e.stats=c.stats,c.load(d,h,{onSuccess:(g,p,m,y)=>{this.resetLoader(e,c);let E=g.data;m.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(E.slice(0,16)),E=E.slice(16)),a({frag:e,part:null,payload:E,networkDetails:y})},onError:(g,p,m,y)=>{this.resetLoader(e,c),l(new Pt({type:le.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:nt({url:n,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:m,stats:y}))},onAbort:(g,p,m)=>{this.resetLoader(e,c),l(new Pt({type:le.NETWORK_ERROR,details:W.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:m,stats:g}))},onTimeout:(g,p,m)=>{this.resetLoader(e,c),l(new Pt({type:le.NETWORK_ERROR,details:W.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:m,stats:g}))},onProgress:(g,p,m,y)=>{t&&t({frag:e,part:null,payload:m,networkDetails:y})}})})}loadPart(e,t,n){this.abort();const i=this.config,s=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(Ga(e,t));return}const c=this.loader=e.loader=s?new s(i):new o(i),d=Ka(e,t),f=Fa(i.fragLoadPolicy.default),h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Va};t.stats=c.stats,c.load(d,h,{onSuccess:(g,p,m,y)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const E={frag:e,part:t,payload:g.data,networkDetails:y};n(E),a(E)},onError:(g,p,m,y)=>{this.resetLoader(e,c),l(new Pt({type:le.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:nt({url:d.url,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:m,stats:y}))},onAbort:(g,p,m)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new Pt({type:le.NETWORK_ERROR,details:W.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:m,stats:g}))},onTimeout:(g,p,m)=>{this.resetLoader(e,c),l(new Pt({type:le.NETWORK_ERROR,details:W.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:m,stats:g}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,s=i.total;if(n.loaded+=i.loaded,s){const l=Math.round(e.duration/t.duration),c=Math.min(Math.round(n.loaded/s),l),f=(l-c)*Math.round(n.loaded/c);n.total=n.loaded+f}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=i.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Ka(r,e=null){const t=e||r,n={frag:r,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(oe(i)&&oe(s)){var o;let a=i,l=s;if(r.sn==="initSegment"&&((o=r.decryptdata)==null?void 0:o.method)==="AES-128"){const c=s-i;c%16&&(l=s+(16-c%16)),i!==0&&(n.resetIV=!0,a=i-16)}n.rangeStart=a,n.rangeEnd=l}return n}function Ga(r,e){const t=new Error(`GAP ${r.gap?"tag":"attribute"} found`),n={type:le.MEDIA_ERROR,details:W.FRAG_GAP,fatal:!1,frag:r,error:t,networkDetails:null};return e&&(n.part=e),(e||r).stats.aborted=!0,new Pt(n)}class Pt extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class ey{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;if(n){if(e&&e!==n.context.frag.type)return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=W.KEY_LOAD_ERROR,n,i,s){return new Pt({type:le.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let s=0;s<t.length;s++){const o=t[s];if(i<=o.cc&&(n==="initSegment"||o.sn==="initSegment"||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,c))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((n=a)!=null&&n.decryptdata.key)return s.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((i=a)!=null&&i.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(c=>(s.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,s=new i(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=n.keyLoadPolicy.default,d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(h,g,p,m)=>{const{frag:y,keyInfo:E,url:A}=p;if(!y.decryptdata||E!==this.keyUriToKeyInfo[A])return a(this.createKeyLoadError(y,W.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),m));E.decryptdata.key=y.decryptdata.key=new Uint8Array(h.data),y.keyLoader=null,E.loader=null,o({frag:y,keyInfo:E})},onError:(h,g,p,m)=>{this.resetLoader(g),a(this.createKeyLoadError(t,W.KEY_LOAD_ERROR,new Error(`HTTP Error ${h.code} loading key ${h.text}`),p,nt({url:l.url,data:void 0},h)))},onTimeout:(h,g,p)=>{this.resetLoader(g),a(this.createKeyLoadError(t,W.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),p))},onAbort:(h,g,p)=>{this.resetLoader(g),a(this.createKeyLoadError(t,W.INTERNAL_ABORTED,new Error("key loading aborted"),p))}};s.load(l,d,f)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],s&&s.destroy()}}class ty{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const ny={length:0,start:()=>0,end:()=>0};class Oe{static isBuffered(e,t){try{if(e){const n=Oe.getBuffered(e);for(let i=0;i<n.length;i++)if(t>=n.start(i)&&t<=n.end(i))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const i=Oe.getBuffered(e),s=[];let o;for(o=0;o<i.length;o++)s.push({start:i.start(o),end:i.end(o)});return this.bufferedInfo(s,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(c,d){const f=c.start-d.start;return f||d.end-c.end});let i=[];if(n)for(let c=0;c<e.length;c++){const d=i.length;if(d){const f=i[d-1].end;e[c].start-f<n?e[c].end>f&&(i[d-1].end=e[c].end):i.push(e[c])}else i.push(e[c])}else i=e;let s=0,o,a=t,l=t;for(let c=0;c<i.length;c++){const d=i[c].start,f=i[c].end;if(t+n>=d&&t<f)a=d,l=f,s=l-t;else if(t+n<d){o=d;break}}return{len:s,start:a||0,end:l||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return V.log("failed to get media.buffered",t),ny}}}class Mi{constructor(e,t,n,i=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=br(),this.buffering={audio:br(),video:br(),audiovideo:br()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=s,this.partial=o}}function br(){return{start:0,executeStart:0,executeEnd:0,end:0}}function ja(r,e){let t=null;for(let n=0,i=r.length;n<i;n++){const s=r[n];if(s&&s.cc===e){t=s;break}}return t}function ry(r,e,t){return!!(e.details&&(t.endCC>t.startCC||r&&r.cc<t.startCC))}function iy(r,e,t=0){const n=r.fragments,i=e.fragments;if(!i.length||!n.length){V.log("No fragments to align");return}const s=ja(n,i[0].cc);if(!s||s&&!s.startPTS){V.log("No frag in previous level to align on");return}return s}function Ha(r,e){if(r){const t=r.start+e;r.start=r.startPTS=t,r.endPTS=t+r.duration}}function Fi(r,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)Ha(t[n],r);e.fragmentHint&&Ha(e.fragmentHint,r),e.alignedSliding=!0}function sy(r,e,t){e&&(oy(r,t,e),!t.alignedSliding&&e.details&&ay(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&Oa(e.details,t))}function oy(r,e,t){if(ry(r,t,e)){const n=iy(t.details,e);n&&oe(n.start)&&(V.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),Fi(n.start,e))}}function ay(r,e){if(!e.fragments.length||!r.hasProgramDateTime||!e.hasProgramDateTime)return;const t=e.fragments[0].programDateTime,n=r.fragments[0].programDateTime,i=(n-t)/1e3+e.fragments[0].start;i&&oe(i)&&(V.log(`Adjusting PTS using programDateTime delta ${n-t}ms, sliding:${i.toFixed(3)} ${r.url} `),Fi(i,r))}function Wa(r,e){if(!r.hasProgramDateTime||!e.hasProgramDateTime)return;const t=r.fragments,n=e.fragments;if(!t.length||!n.length)return;const i=Math.round(n.length/2)-1,s=n[i],o=ja(t,s.cc)||t[Math.round(t.length/2)-1],a=s.programDateTime,l=o.programDateTime;if(a===null||l===null)return;const c=(l-a)/1e3-(o.start-s.start);Fi(c,r)}class ly{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class uy{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function cy(r){const e=r.byteLength,t=e&&new DataView(r.buffer).getUint8(e-1);return t?$t(r,0,e-t):r}class dy{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],s=n[1],o=n[2],a=n[3],l=this.invSubMix,c=l[0],d=l[1],f=l[2],h=l[3],g=new Uint32Array(256);let p=0,m=0,y=0;for(y=0;y<256;y++)y<128?g[y]=y<<1:g[y]=y<<1^283;for(y=0;y<256;y++){let E=m^m<<1^m<<2^m<<3^m<<4;E=E>>>8^E&255^99,e[p]=E,t[E]=p;const A=g[p],_=g[A],x=g[_];let v=g[E]*257^E*16843008;i[p]=v<<24|v>>>8,s[p]=v<<16|v>>>16,o[p]=v<<8|v>>>24,a[p]=v,v=x*16843009^_*65537^A*257^p*16843008,c[E]=v<<24|v>>>8,d[E]=v<<16|v>>>16,f[E]=v<<8|v>>>24,h[E]=v,p?(p=A^g[g[g[x^A]]],m^=g[g[m]]):p=m=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const o=this.ksRows=(s+6+1)*4;let a,l;const c=this.keySchedule=new Uint32Array(o),d=this.invKeySchedule=new Uint32Array(o),f=this.sBox,h=this.rcon,g=this.invSubMix,p=g[0],m=g[1],y=g[2],E=g[3];let A,_;for(a=0;a<o;a++){if(a<s){A=c[a]=t[a];continue}_=A,a%s===0?(_=_<<8|_>>>24,_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255],_^=h[a/s|0]<<24):s>6&&a%s===4&&(_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255]),c[a]=A=(c[a-s]^_)>>>0}for(l=0;l<o;l++)a=o-l,l&3?_=c[a]:_=c[a-4],l<4||a<=4?d[l]=_:d[l]=p[f[_>>>24]]^m[f[_>>>16&255]]^y[f[_>>>8&255]]^E[f[_&255]],d[l]=d[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],c=a[1],d=a[2],f=a[3],h=this.uint8ArrayToUint32Array_(n);let g=h[0],p=h[1],m=h[2],y=h[3];const E=new Int32Array(e),A=new Int32Array(E.length);let _,x,v,T,C,k,B,R,I,S,L,b,w,M;const O=this.networkToHostOrderSwap;for(;t<E.length;){for(I=O(E[t]),S=O(E[t+1]),L=O(E[t+2]),b=O(E[t+3]),C=I^s[0],k=b^s[1],B=L^s[2],R=S^s[3],w=4,M=1;M<i;M++)_=l[C>>>24]^c[k>>16&255]^d[B>>8&255]^f[R&255]^s[w],x=l[k>>>24]^c[B>>16&255]^d[R>>8&255]^f[C&255]^s[w+1],v=l[B>>>24]^c[R>>16&255]^d[C>>8&255]^f[k&255]^s[w+2],T=l[R>>>24]^c[C>>16&255]^d[k>>8&255]^f[B&255]^s[w+3],C=_,k=x,B=v,R=T,w=w+4;_=o[C>>>24]<<24^o[k>>16&255]<<16^o[B>>8&255]<<8^o[R&255]^s[w],x=o[k>>>24]<<24^o[B>>16&255]<<16^o[R>>8&255]<<8^o[C&255]^s[w+1],v=o[B>>>24]<<24^o[R>>16&255]<<16^o[C>>8&255]<<8^o[k&255]^s[w+2],T=o[R>>>24]<<24^o[C>>16&255]<<16^o[k>>8&255]<<8^o[B&255]^s[w+3],A[t]=O(_^g),A[t+1]=O(T^p),A[t+2]=O(v^m),A[t+3]=O(x^y),g=I,p=S,m=L,y=b,t=t+4}return A.buffer}}const fy=16;class Ni{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?cy(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((i,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?i(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=en(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;i&&(n=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new dy),l.expandKey(t);const c=s;return this.currentResult=l.decrypt(a.buffer,0,n),this.currentIV=$t(a,-16).buffer,c||null}webCryptoDecrypt(e,t,n){const i=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new uy(i,t)),this.fastAesKey.expandKey().then(s=>i?(this.logOnce("WebCrypto AES decrypt"),new ly(i,new Uint8Array(n)).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(V.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%fy;return n!==e.length&&(t=$t(e,0,n),this.remainderData=$t(e,n)),t}logOnce(e){this.logEnabled&&(V.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const hy={toString:function(r){let e="";const t=r.length;for(let n=0;n<t;n++)e+=`[${r.start(n).toFixed(3)}-${r.end(n).toFixed(3)}]`;return e}},Y={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ui extends ty{constructor(e,t,n,i,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Y.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=i,this.log=V.log.bind(V,`${i}:`),this.warn=V.warn.bind(V,`${i}:`),this.hls=e,this.fragmentLoader=new $m(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Ni(e.config),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Y.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const s=n[n.length-1];return Oe.isBuffered(this.media,s.start+s.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levels[this.levelLastLoaded])==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Y.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:s}=this,o=n?n.currentTime:0,a=Oe.bufferInfo(i||n,o,e.maxBufferHole);if(this.log(`media seeking to ${oe(o)?o.toFixed(3):o}, state: ${s}`),this.state===Y.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,c=t.start-l,d=t.start+t.duration+l;if(!a.len||d<a.start||c>a.end){const f=o>d;(o<c||f)&&(f&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!a.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=Y.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,i).then(s=>{if(!s)return;const o=this.state;if(this.fragContextChanged(e)){(o===Y.FRAG_LOADING||!this.fragCurrent&&o===Y.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=Y.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(P.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===Y.STOPPED||this.state===Y.ERROR||(this.warn(s),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Je.APPENDING){const s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength);this.reduceMaxBufferLength(a)&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Je.PARTIAL&&n.removeFragment(e))}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(P.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{payload:s}=n,o=e.decryptdata;if(s&&s.byteLength>0&&o&&o.key&&o.iv&&o.method==="AES-128"){const a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(l=>{throw i.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const c=self.performance.now();return i.trigger(P.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:a,tdecrypt:c}}),n.payload=l,n})}return n}).then(n=>{const{fragCurrent:i,hls:s,levels:o}=this;if(!o)throw new Error("init load aborted, missing levels");const a=e.stats;this.state=Y.IDLE,t.fragmentError=0,e.data=new Uint8Array(n.payload),a.parsing.start=a.buffering.start=self.performance.now(),a.parsing.end=a.buffering.end=self.performance.now(),n.frag===i&&s.trigger(P.FRAG_BUFFERED,{stats:a,frag:i,part:null,id:e.type}),this.tick()}).catch(n=>{this.state===Y.STOPPED||this.state===Y.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var n,i,s,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===ue.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${a?hy.toString(Oe.getBuffered(a)):"(detached)"})`),this.state=Y.IDLE,a&&(!this.loadedmetadata&&e.type==ue.MAIN&&a.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:s}=e,o=!s||s.length===0||s.some(l=>!l),a=new Mi(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var s;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=Y.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(P.KEY_LOADED,d),this.state===Y.KEY_LOADING&&(this.state=Y.IDLE),d}),this.hls.trigger(P.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const d=o.partList;if(d&&i){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const f=this.getNextPart(d,e,n);if(f>-1){const h=d[f];this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${f}-${d.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=h.start+h.duration,this.state=Y.FRAG_LOADING;let g;return a?g=a.then(p=>!p||this.fragContextChanged(p.frag)?null:this.doFragPartsLoad(e,h,t,i)).catch(p=>this.handleFragLoadError(p)):g=this.doFragPartsLoad(e,h,t,i).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(P.FRAG_LOADING,{frag:e,part:h,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):g}else if(!e.url||this.loadedEndOfParts(d,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),oe(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Y.FRAG_LOADING;const l=this.config.progressive;let c;return l&&a?c=a.then(d=>!d||this.fragContextChanged(d==null?void 0:d.frag)?null:this.fragmentLoader.load(e,i)).catch(d=>this.handleFragLoadError(d)):c=Promise.all([this.fragmentLoader.load(e,l?i:void 0),a]).then(([d])=>(!l&&d&&i&&i(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(P.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(e,t,n,i){return new Promise((s,o)=>{var a;const l=[],c=(a=n.details)==null?void 0:a.partList,d=f=>{this.fragmentLoader.loadPart(e,f,i).then(h=>{l[f.index]=h;const g=h.part;this.hls.trigger(P.FRAG_LOADED,h);const p=Pa(n,e.sn,f.index+1)||Ba(c,e.sn,f.index+1);if(p)d(p);else return s({frag:e,part:g,partsLoaded:l})}).catch(o)};d(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===W.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(P.ERROR,t)}else this.hls.trigger(P.ERROR,{type:le.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Y.PARSING){!this.fragCurrent&&this.state!==Y.STOPPED&&this.state!==Y.ERROR&&(this.state=Y.IDLE);return}const{frag:n,part:i,level:s}=t,o=self.performance.now();n.stats.parsing.end=o,i&&(i.stats.parsing.end=o),this.updateLevelTiming(n,i,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:s,part:o}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${i}. The current chunk will not be buffered.`),null;const a=t[i],l=o>-1?Pa(a,s,o):null,c=l?l.fragment:jm(a,s,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(e,t,n,i){var s;if(!e||this.state!==Y.PARSING)return;const{data1:o,data2:a}=e;let l=o;if(o&&a&&(l=en(o,a)),!((s=l)!=null&&s.length))return;const c={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};this.hls.trigger(P.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n&&this.flushBufferGap(t)}flushBufferGap(e){const t=this.media;if(!t)return;if(!Oe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=Oe.bufferInfo(t,n,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),a=Math.max(Math.min(e.start-o,i.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return oe(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,s=Oe.bufferInfo(e,t,i);if(s.len===0&&s.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&s.nextStart<o.end)return Oe.bufferInfo(e,t,Math.max(s.nextStart,i))}return s}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(e,t=ue.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,ue.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:s}=this,o=n[0].start;let a;if(t.live){const l=s.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(a=this.getInitialLiveFragment(t,n),this.startPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){const l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Je.OK||n===Je.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,s){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(a===null)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,s=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const c=e[a];if(o=o&&!c.independent,i>-1&&n<c.start)break;const d=c.loaded;d?i=-1:(s||c.independent||o)&&c.fragment===t&&(i=a),s=d}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=Wm(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];n.cc===o.cc&&(i=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Jm(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:s}=this,{fragments:o,endSN:a}=n;const{fragmentHint:l}=n,c=i.maxFragLookUpTolerance,d=n.partList,f=!!(i.lowLatencyMode&&d!=null&&d.length&&l);f&&l&&!this.bitrateTest&&(o=o.concat(l),a=l.sn);let h;if(e<t){const g=e>t-c?0:c;h=Hn(s,o,e,g)}else h=o[o.length-1];if(h){const g=h.sn-n.startSN,p=this.fragmentTracker.getState(h);if((p===Je.OK||p===Je.PARTIAL&&h.gap)&&(s=h),s&&h.sn===s.sn&&(!f||d[0].fragment.sn>h.sn)&&s&&h.level===s.level){const y=o[g+1];h.sn<a&&this.fragmentTracker.getState(y)!==Je.OK?h=y:h=null}}return h}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,s=n.currentTime,o=e.fragments[0].start,a=e.edge,l=s>=o-t.maxFragLookUpTolerance&&s<=a;if(i!==null&&n.duration>i&&(s<i||!l)){const c=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<a-c)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t){const{levels:n,levelLastLoaded:i,fragPrevious:s}=this,o=i!==null?n[i]:null,a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;const l=e.fragments[0].start,c=!t,d=e.alignedSliding&&oe(l);if(c||!d&&!l){sy(s,o,e);const f=e.fragments[0].start;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${s?s.sn:"na"} fragments: ${a}`),f}return l}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const i=this.startTimeOffset!==null,s=i?this.startTimeOffset:e.startTimeOffset;s!==null&&oe(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==Y.FRAG_LOADING_WAITING_RETRY)&&(this.state=Y.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const d=this.getCurrentContext(t.chunkMeta);d&&(t.frag=d.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const s=t.details===W.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,retryCount:l=0,retryConfig:c}=o||{};if(o&&a===st.RetryRequest&&c){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);const d=Di(c,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${d}ms`),o.resolved=!0,this.retryDate=self.performance.now()+d,this.state=Y.FRAG_LOADING_WAITING_RETRY}else c&&o?(this.resetFragmentErrors(e),l<c.maxNumRetry?s||(o.resolved=!0):V.warn(`${t.details} reached or exceeded max retry (${l})`)):this.state=Y.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Y.PARSING||this.state===Y.PARSED){const t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),i=n&&n.len>.5;i&&this.reduceMaxBufferLength(n.len);const s=!i;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===ue.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Y.STOPPED&&(this.state=Y.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=Oe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Y.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Y.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var s;const o=n.details;if(!o){this.warn("level.details undefined");return}if(Object.keys(e.elementaryStreams).reduce((l,c)=>{const d=e.elementaryStreams[c];if(d){const f=d.endPTS-d.startPTS;if(f<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${f})`),l||!1;const h=i?0:Da(o,e,d.startPTS,d.endPTS,d.startDTS,d.endDTS);return this.hls.trigger(P.LEVEL_PTS_UPDATED,{details:o,level:n,drift:h,type:c,frag:e,start:d.startPTS,end:d.endPTS}),!0}return l},!1))n.fragmentError=0;else if(((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${n.id} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Y.PARSED,this.hls.trigger(P.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.resetTransmuxer(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Qa(){return self.SourceBuffer||self.WebKitSourceBuffer}function py(){const r=Ar();if(!r)return!1;const e=Qa(),t=r&&typeof r.isTypeSupported=="function"&&r.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function";return!!t&&!!n}function gy(){var r;const e=Qa();return typeof(e==null||(r=e.prototype)==null?void 0:r.changeType)=="function"}function my(){return typeof __HLS_WORKER_BUNDLE__=="function"}function yy(){const r=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(r);return{worker:new self.Worker(e),objectURL:e}}function Ey(r){const e=new self.URL(r,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function wt(r="",e=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Ja{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=en(this.cachedData,e),this.cachedData=null);let n=mr(e,0),i=n?n.length:0,s;const o=this._audioTrack,a=this._id3Track,l=n?em(n):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&oe(l))&&(this.basePTS=vy(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:_t.audioId3,duration:Number.POSITIVE_INFINITY});i<c;){if(this.canParse(e,i)){const d=this.appendFrame(o,e,i);d?(this.frameIndex++,this.lastPTS=d.sample.pts,i+=d.length,s=i):i=c}else $g(e,i)?(n=mr(e,i),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:_t.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,s=i):i++;if(i===c&&s!==c){const d=$t(e,s);this.cachedData?this.cachedData=en(this.cachedData,d):this.cachedData=d}}return{audioTrack:o,videoTrack:wt(),id3Track:a,textTrack:wt()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:wt(),id3Track:this._id3Track,textTrack:wt()}}destroy(){}}const vy=(r,e,t)=>{if(oe(r))return r*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function Ay(r,e,t,n){let i,s,o,a;const l=navigator.userAgent.toLowerCase(),c=n,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[t+2]&192)>>>6)+1;const f=(e[t+2]&60)>>>2;if(f>d.length-1){r.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${f}`});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,V.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${f}`),/firefox/i.test(l)?f>=6?(i=5,a=new Array(4),s=f-3):(i=2,a=new Array(2),s=f):l.indexOf("android")!==-1?(i=2,a=new Array(2),s=f):(i=5,a=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&f>=6?s=f-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(f>=6&&o===1||/vivaldi/i.test(l))||!n&&o===1)&&(i=2,a=new Array(2)),s=f)),a[0]=i<<3,a[0]|=(f&14)>>1,a[1]|=(f&1)<<7,a[1]|=o<<3,i===5&&(a[1]|=(s&14)>>1,a[2]=(s&1)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:d[f],channelCount:o,codec:"mp4a.40."+i,manifestCodec:c}}function Ya(r,e){return r[e]===255&&(r[e+1]&246)===240}function za(r,e){return r[e+1]&1?7:9}function Vi(r,e){return(r[e+3]&3)<<11|r[e+4]<<3|(r[e+5]&224)>>>5}function _y(r,e){return e+5<r.length}function Cr(r,e){return e+1<r.length&&Ya(r,e)}function xy(r,e){return _y(r,e)&&Ya(r,e)&&Vi(r,e)<=r.length-e}function Sy(r,e){if(Cr(r,e)){const t=za(r,e);if(e+t>=r.length)return!1;const n=Vi(r,e);if(n<=t)return!1;const i=e+n;return i===r.length||Cr(r,i)}return!1}function qa(r,e,t,n,i){if(!r.samplerate){const s=Ay(e,t,n,i);if(!s)return;r.config=s.config,r.samplerate=s.samplerate,r.channelCount=s.channelCount,r.codec=s.codec,r.manifestCodec=s.manifestCodec,V.log(`parsed codec:${r.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function Za(r){return 1024*9e4/r}function Ty(r,e){const t=za(r,e);if(e+t<=r.length){const n=Vi(r,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function Xa(r,e,t,n,i){const s=Za(r.samplerate),o=n+i*s,a=Ty(e,t);let l;if(a){const{frameLength:f,headerLength:h}=a,g=h+f,p=Math.max(0,t+g-e.length);p?(l=new Uint8Array(g-h),l.set(e.subarray(t+h,e.length),0)):l=e.subarray(t+h,t+g);const m={unit:l,pts:o};return p||r.samples.push(m),{sample:m,length:g,missing:p}}const c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:c,missing:-1}}class Iy extends Ja{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(mr(e,0)||[]).length;for(let i=e.length;n<i;n++)if(Sy(e,n))return V.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return xy(e,t)}appendFrame(e,t,n){qa(e,this.observer,t,n,e.manifestCodec);const i=Xa(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const by=/\/emsg[-/]ID3/i;class Cy{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const s=this.videoTrack=wt("video",1),o=this.audioTrack=wt("audio",1),a=this.txtTrack=wt("text",1);if(this.id3Track=wt("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=ca(e);if(l.video){const{id:c,timescale:d,codec:f}=l.video;s.id=c,s.timescale=a.timescale=d,s.codec=f}if(l.audio){const{id:c,timescale:d,codec:f}=l.audio;o.id=c,o.timescale=d,o.codec=f}a.id=aa.text,s.sampleDuration=0,s.duration=o.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return e=e.length>16384?e.subarray(0,16384):e,xe(e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=en(this.remainderData,e));const a=gm(n);this.remainderData=a.remainder,i.samples=a.valid||new Uint8Array}else i.samples=n;const o=this.extractID3Track(i,t);return s.samples=fa(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=fa(e,t),{videoTrack:t,audioTrack:wt(),id3Track:i,textTrack:wt()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=xe(e.samples,["emsg"]);i&&i.forEach(s=>{const o=Em(s);if(by.test(o.schemeIdUri)){const a=oe(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=o.payload;n.samples.push({data:c,len:c.byteLength,dts:a,pts:a,type:_t.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}let Lr=null;const Ly=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Ry=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],wy=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ky=[0,1,1,4];function $a(r,e,t,n,i){if(t+24>e.length)return;const s=el(e,t);if(s&&t+s.frameLength<=e.length){const o=s.samplesPerFrame*9e4/s.sampleRate,a=n+i*o,l={unit:e.subarray(t,t+s.frameLength),pts:a,dts:a};return r.config=[],r.channelCount=s.channelCount,r.samplerate=s.sampleRate,r.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function el(r,e){const t=r[e+1]>>3&3,n=r[e+1]>>1&3,i=r[e+2]>>4&15,s=r[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&s!==3){const o=r[e+2]>>1&1,a=r[e+3]>>6,l=t===3?3-n:n===3?3:4,c=Ly[l*14+i-1]*1e3,f=Ry[(t===3?0:t===2?1:2)*3+s],h=a===3?1:2,g=wy[t][n],p=ky[n],m=g*8*p,y=Math.floor(g*c/f+o)*p;if(Lr===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Lr=_?parseInt(_[1]):0}return!!Lr&&Lr<=87&&n===2&&c>=224e3&&a===0&&(r[e+3]=r[e+3]|128),{sampleRate:f,channelCount:h,frameLength:y,samplesPerFrame:m}}}function Ki(r,e){return r[e]===255&&(r[e+1]&224)===224&&(r[e+1]&6)!==0}function tl(r,e){return e+1<r.length&&Ki(r,e)}function Dy(r,e){return Ki(r,e)&&4<=r.length-e}function Oy(r,e){if(e+1<r.length&&Ki(r,e)){const n=el(r,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const s=e+i;return s===r.length||tl(r,s)}return!1}class nl{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");i.set(e.subarray(n,n+s)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&V.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,i;for(let s=0;s<e;s++)n!==0&&(i=this.readEG(),n=(t+i+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,i=0,s,o,a;const l=this.readUByte.bind(this),c=this.readBits.bind(this),d=this.readUEG.bind(this),f=this.readBoolean.bind(this),h=this.skipBits.bind(this),g=this.skipEG.bind(this),p=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);l();const y=l();if(c(5),h(3),l(),p(),y===100||y===110||y===122||y===244||y===44||y===83||y===86||y===118||y===128){const T=d();if(T===3&&h(1),p(),p(),h(1),f())for(o=T!==3?8:12,a=0;a<o;a++)f()&&(a<6?m(16):m(64))}p();const E=d();if(E===0)d();else if(E===1)for(h(1),g(),g(),s=d(),a=0;a<s;a++)g();p(),h(1);const A=d(),_=d(),x=c(1);x===0&&h(1),h(1),f()&&(e=d(),t=d(),n=d(),i=d());let v=[1,1];if(f()&&f())switch(l()){case 1:v=[1,1];break;case 2:v=[12,11];break;case 3:v=[10,11];break;case 4:v=[16,11];break;case 5:v=[40,33];break;case 6:v=[24,11];break;case 7:v=[20,11];break;case 8:v=[32,11];break;case 9:v=[80,33];break;case 10:v=[18,11];break;case 11:v=[15,11];break;case 12:v=[64,33];break;case 13:v=[160,99];break;case 14:v=[4,3];break;case 15:v=[3,2];break;case 16:v=[2,1];break;case 255:{v=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((A+1)*16-e*2-t*2),height:(2-x)*(_+1)*16-(x?2:4)*(n+i),pixelRatio:v}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Py{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Ni(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const s=i.subarray(16,i.length-i.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)n.set(e.subarray(s,s+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)e.set(n.subarray(i,i+16),s);return e}decryptAvcSample(e,t,n,i,s){const o=pa(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const s=e[t].units;for(;!(n>=s.length);n++){const o=s[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,i,o),!this.decrypter.isSync()))return}}}}const ot=188;class jt{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}static probe(e){const t=jt.syncOffset(e);return t>0&&V.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length,n=Math.min(ot*5,e.length-ot)+1;let i=0;for(;i<n;){let s=!1;for(let o=i;o<t&&e[o]===71;o+=ot)if(!s&&Gi(e,o)===0&&(s=!0),s&&o+ot>n)return i;i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:aa[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=jt.createTrack("video"),this._audioTrack=jt.createTrack("audio",i),this._id3Track=jt.createTrack("id3"),this._txtTrack=jt.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let s;const o=this._avcTrack,a=this._audioTrack,l=this._id3Track,c=this._txtTrack;let d=o.pid,f=o.pesData,h=a.pid,g=l.pid,p=a.pesData,m=l.pesData,y=null,E=this.pmtParsed,A=this._pmtId,_=e.length;if(this.remainderData&&(e=en(this.remainderData,e),_=e.length,this.remainderData=null),_<ot&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};const x=Math.max(0,jt.syncOffset(e));_-=(_-x)%ot,_<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,_,e.buffer.byteLength-_));let v=0;for(let C=x;C<_;C+=ot)if(e[C]===71){const k=!!(e[C+1]&64),B=Gi(e,C),R=(e[C+3]&48)>>4;let I;if(R>1){if(I=C+5+e[C+4],I===C+ot)continue}else I=C+4;switch(B){case d:k&&(f&&(s=En(f))&&this.parseAVCPES(o,c,s,!1),f={data:[],size:0}),f&&(f.data.push(e.subarray(I,C+ot)),f.size+=C+ot-I);break;case h:if(k){if(p&&(s=En(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break}p={data:[],size:0}}p&&(p.data.push(e.subarray(I,C+ot)),p.size+=C+ot-I);break;case g:k&&(m&&(s=En(m))&&this.parseID3PES(l,s),m={data:[],size:0}),m&&(m.data.push(e.subarray(I,C+ot)),m.size+=C+ot-I);break;case 0:k&&(I+=e[I]+1),A=this._pmtId=By(e,I);break;case A:{k&&(I+=e[I]+1);const S=My(e,I,this.typeSupported,n);d=S.avc,d>0&&(o.pid=d),h=S.audio,h>0&&(a.pid=h,a.segmentCodec=S.segmentCodec),g=S.id3,g>0&&(l.pid=g),y!==null&&!E&&(V.warn(`MPEG-TS PMT found at ${C} after unknown PID '${y}'. Backtracking to sync byte @${x} to parse all TS packets.`),y=null,C=x-188),E=this.pmtParsed=!0;break}case 17:case 8191:break;default:y=B;break}}else v++;if(v>0){const C=new Error(`Found ${v} TS packet/s that do not start with 0x47`);this.observer.emit(P.ERROR,P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,error:C,reason:C.message})}o.pesData=f,a.pesData=p,l.pesData=m;const T={audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};return i&&this.extractRemainingSamples(T),T}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:s}=e,o=n.pesData,a=t.pesData,l=i.pesData;let c;if(o&&(c=En(o))?(this.parseAVCPES(n,s,c,!0),n.pesData=null):n.pesData=o,a&&(c=En(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break}t.pesData=null}else a!=null&&a.size&&V.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(c=En(l))?(this.parseID3PES(i,c),i.pesData=null):i.pesData=l}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new Py(this.observer,this.config,t);return this.decrypt(i,s)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:s}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,n,i){const s=this.parseAVCNALu(e,n.data);let o=this.avcSample,a,l=!1;n.data=null,o&&s.length&&!e.audFound&&(ji(o,e),o=this.avcSample=Rr(!1,n.pts,n.dts,"")),s.forEach(c=>{switch(c.type){case 1:{a=!0,o||(o=this.avcSample=Rr(!0,n.pts,n.dts,"")),o.frame=!0;const d=c.data;if(l&&d.length>4){const f=new nl(d).readSliceType();(f===2||f===4||f===7||f===9)&&(o.key=!0)}break}case 5:a=!0,o||(o=this.avcSample=Rr(!0,n.pts,n.dts,"")),o.key=!0,o.frame=!0;break;case 6:{a=!0,ha(c.data,1,n.pts,t.samples);break}case 7:if(a=!0,l=!0,!e.sps){const d=c.data,h=new nl(d).readSPS();e.width=h.width,e.height=h.height,e.pixelRatio=h.pixelRatio,e.sps=[d],e.duration=this._duration;const g=d.subarray(1,4);let p="avc1.";for(let m=0;m<3;m++){let y=g[m].toString(16);y.length<2&&(y="0"+y),p+=y}e.codec=p}break;case 8:a=!0,e.pps||(e.pps=[c.data]);break;case 9:a=!1,e.audFound=!0,o&&ji(o,e),o=this.avcSample=Rr(!1,n.pts,n.dts,"");break;case 12:a=!0;break;default:a=!1,o&&(o.debug+="unknown NAL "+c.type+" ");break}o&&a&&o.units.push(c)}),i&&o&&(ji(o,e),this.avcSample=null)}getLastNalUnit(e){var t;let n=this.avcSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const s=n.units;i=s[s.length-1]}return i}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const s=i,o=[];let a=0,l,c,d,f=-1,h=0;for(i===-1&&(f=0,h=t[0]&31,i=0,a=1);a<n;){if(l=t[a++],!i){i=l?0:1;continue}if(i===1){i=l?0:2;continue}if(!l)i=3;else if(l===1){if(f>=0){const g={data:t.subarray(f,a-i-1),type:h};o.push(g)}else{const g=this.getLastNalUnit(e.samples);if(g&&(s&&a<=4-s&&g.state&&(g.data=g.data.subarray(0,g.data.byteLength-s)),c=a-i-1,c>0)){const p=new Uint8Array(g.data.byteLength+c);p.set(g.data,0),p.set(t.subarray(0,c),g.data.byteLength),g.data=p,g.state=0}}a<n?(d=t[a]&31,f=a,h=d,i=0):i=-1}else i=0}if(f>=0&&i>=0){const g={data:t.subarray(f,n),type:h,state:i};o.push(g)}if(o.length===0){const g=this.getLastNalUnit(e.samples);if(g){const p=new Uint8Array(g.data.byteLength+t.byteLength);p.set(g.data,0),p.set(t,g.data.byteLength),g.data=p}}return e.naluState=i,o}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let s=t.data;if(i){this.aacOverFlow=null;const f=i.missing,h=i.sample.unit.byteLength;if(f===-1){const g=new Uint8Array(h+s.byteLength);g.set(i.sample.unit,0),g.set(s,h),s=g}else{const g=h-f;i.sample.unit.set(s.subarray(0,f),g),e.samples.push(i.sample),n=i.missing}}let o,a;for(o=n,a=s.length;o<a-1&&!Cr(s,o);o++);if(o!==n){let f;const h=o<a-1;h?f=`AAC PES did not start with ADTS header,offset:${o}`:f="No ADTS header found in AAC PES";const g=new Error(f);if(V.warn(`parsing error: ${f}`),this.observer.emit(P.ERROR,P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,levelRetry:h,error:g,reason:f}),!h)return}qa(e,this.observer,s,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(i){const f=Za(e.samplerate);l=i.sample.pts+f}else{V.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,d;for(;o<a;)if(d=Xa(e,s,o,l,c),o+=d.length,d.missing){this.aacOverFlow=d;break}else for(c++;o<a-1&&!Cr(s,o);o++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let s=0,o=0;const a=t.pts;if(a===void 0){V.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<i;)if(tl(n,o)){const l=$a(e,n,o,a,s);if(l)o+=l.length,s++;else break}else o++}parseID3PES(e,t){if(t.pts===void 0){V.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=Ke({},t,{type:this._avcTrack?_t.emsg:_t.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Rr(r,e,t,n){return{key:r,frame:!1,pts:e,dts:t,units:[],debug:n,length:0}}function Gi(r,e){return((r[e+1]&31)<<8)+r[e+2]}function By(r,e){return(r[e+10]&31)<<8|r[e+11]}function My(r,e,t,n){const i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},s=(r[e+1]&15)<<8|r[e+2],o=e+3+s-4,a=(r[e+10]&15)<<8|r[e+11];for(e+=12+a;e<o;){const l=Gi(r,e);switch(r[e]){case 207:if(!n){V.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:i.audio===-1&&(i.audio=l);break;case 21:i.id3===-1&&(i.id3=l);break;case 219:if(!n){V.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:i.avc===-1&&(i.avc=l);break;case 3:case 4:t.mpeg!==!0&&t.mp3!==!0?V.log("MPEG audio found, not supported in this browser"):i.audio===-1&&(i.audio=l,i.segmentCodec="mp3");break;case 36:V.warn("Unsupported HEVC stream type found");break}e+=((r[e+3]&15)<<8|r[e+4])+5}return i}function En(r){let e=0,t,n,i,s,o;const a=r.data;if(!r||r.size===0)return null;for(;a[0].length<19&&a.length>1;){const c=new Uint8Array(a[0].length+a[1].length);c.set(a[0]),c.set(a[1],a[0].length),a[0]=c,a.splice(1,1)}if(t=a[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>r.size-6)return null;const c=t[7];c&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,c&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-o>60*9e4&&(V.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),i=t[8];let d=i+9;if(r.size<=d)return null;r.size-=d;const f=new Uint8Array(r.size);for(let h=0,g=a.length;h<g;h++){t=a[h];let p=t.byteLength;if(d)if(d>p){d-=p;continue}else t=t.subarray(d),p-=d,d=0;f.set(t,e),e+=p}return n&&(n-=i+3),{data:f,pts:s,dts:o,len:n}}return null}function ji(r,e){if(r.units.length&&r.frame){if(r.pts===void 0){const t=e.samples,n=t.length;if(n){const i=t[n-1];r.pts=i.pts,r.dts=i.dts}else{e.dropped++;return}}e.samples.push(r)}r.debug.length&&V.log(r.pts+"/"+r.dts+":"+r.debug)}class Fy extends Ja{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(mr(e,0)||[]).length;for(let i=e.length;n<i;n++)if(Oy(e,n))return V.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Dy(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return $a(e,t,n,this.basePTS,this.frameIndex)}}class rl{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ht=Math.pow(2,32)-1;class j{static init(){j.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in j.types)j.types.hasOwnProperty(e)&&(j.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);j.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);j.STTS=j.STSC=j.STCO=s,j.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),j.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),j.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),j.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);j.FTYP=j.box(j.types.ftyp,o,l,o,a),j.DINF=j.box(j.types.dinf,j.box(j.types.dref,i))}static box(e,...t){let n=8,i=t.length;const s=i;for(;i--;)n+=t[i].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),i=0,n=8;i<s;i++)o.set(t[i],n),n+=t[i].byteLength;return o}static hdlr(e){return j.box(j.types.hdlr,j.HDLR_TYPES[e])}static mdat(e){return j.box(j.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Ht+1)),i=Math.floor(t%(Ht+1));return j.box(j.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return j.box(j.types.mdia,j.mdhd(e.timescale,e.duration),j.hdlr(e.type),j.minf(e))}static mfhd(e){return j.box(j.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?j.box(j.types.minf,j.box(j.types.smhd,j.SMHD),j.DINF,j.stbl(e)):j.box(j.types.minf,j.box(j.types.vmhd,j.VMHD),j.DINF,j.stbl(e))}static moof(e,t,n){return j.box(j.types.moof,j.mfhd(e),j.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=j.trak(e[t]);return j.box.apply(null,[j.types.moov,j.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(j.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=j.trex(e[t]);return j.box.apply(null,[j.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Ht+1)),i=Math.floor(t%(Ht+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return j.box(j.types.mvhd,s)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,s;for(i=0;i<t.length;i++)s=t[i].flags,n[i+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return j.box(j.types.sdtp,n)}static stbl(e){return j.box(j.types.stbl,j.stsd(e),j.box(j.types.stts,j.STTS),j.box(j.types.stsc,j.STSC),j.box(j.types.stsz,j.STSZ),j.box(j.types.stco,j.STCO))}static avc1(e){let t=[],n=[],i,s,o;for(i=0;i<e.sps.length;i++)s=e.sps[i],o=s.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(s));for(i=0;i<e.pps.length;i++)s=e.pps[i],o=s.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(s));const a=j.box(j.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,c=e.height,d=e.pixelRatio[0],f=e.pixelRatio[1];return j.box(j.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,j.box(j.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),j.box(j.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,f>>24,f>>16&255,f>>8&255,f&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return j.box(j.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]),j.box(j.types.esds,j.esds(e)))}static mp3(e){const t=e.samplerate;return j.box(j.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?j.box(j.types.stsd,j.STSD,j.mp3(e)):j.box(j.types.stsd,j.STSD,j.mp4a(e)):j.box(j.types.stsd,j.STSD,j.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,s=e.height,o=Math.floor(n/(Ht+1)),a=Math.floor(n%(Ht+1));return j.box(j.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const n=j.sdtp(e),i=e.id,s=Math.floor(t/(Ht+1)),o=Math.floor(t%(Ht+1));return j.box(j.types.traf,j.box(j.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),j.box(j.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),j.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,j.box(j.types.trak,j.tkhd(e),j.mdia(e))}static trex(e){const t=e.id;return j.box(j.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,s=12+16*i,o=new Uint8Array(s);let a,l,c,d,f,h;for(t+=8+s,o.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<i;a++)l=n[a],c=l.duration,d=l.size,f=l.flags,h=l.cts,o.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,f.degradPrio&61440,f.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*a);return j.box(j.types.trun,o)}static initSegment(e){j.types||j.init();const t=j.moov(e),n=new Uint8Array(j.FTYP.byteLength+t.byteLength);return n.set(j.FTYP),n.set(t,j.FTYP.byteLength),n}}j.types=void 0,j.HDLR_TYPES=void 0,j.STTS=void 0,j.STSC=void 0,j.STCO=void 0,j.STSZ=void 0,j.VMHD=void 0,j.SMHD=void 0,j.STSD=void 0,j.FTYP=void 0,j.DINF=void 0;const il=9e4;function Hi(r,e,t=1,n=!1){const i=r*e*t;return n?Math.round(i):i}function Ny(r,e,t=1,n=!1){return Hi(r,e,1/t,n)}function Wn(r,e=!1){return Hi(r,1e3,1/il,e)}function Uy(r,e=1){return Hi(r,il,1/e)}const Vy=10*1e3,sl=1024,Ky=1152;let wr=null,Wi=null;class Qi{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,wr===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);wr=o?parseInt(o[1]):0}if(Wi===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);Wi=s?parseInt(s[1]):0}}destroy(){}resetTimeStamp(e){V.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){V.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){V.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const n=e.reduce((i,s)=>{const o=s.pts-i;return o<-4294967296?(t=!0,gt(i,s.pts)):o>0?i:s.pts},e[0].pts);return t&&V.debug("PTS rollover detected"),n}remux(e,t,n,i,s,o,a,l){let c,d,f,h,g,p,m=s,y=s;const E=e.pid>-1,A=t.pid>-1,_=t.samples.length,x=e.samples.length>0,v=a&&_>0||_>1;if((!E||x)&&(!A||v)||this.ISGenerated||a){this.ISGenerated||(f=this.generateIS(e,t,s,o));const C=this.isVideoContiguous;let k=-1,B;if(v&&(k=Gy(t.samples),!C&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,k>0){V.warn(`[mp4-remuxer]: Dropped ${k} out of ${_} video samples due to a missing keyframe`);const R=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(k),t.dropped+=k,y+=(t.samples[0].pts-R)/t.inputTimeScale,B=y}else k===-1&&(V.warn(`[mp4-remuxer]: No keyframe found out of ${_} video samples`),p=!1);if(this.ISGenerated){if(x&&v){const R=this.getVideoStartPts(t.samples),S=(gt(e.samples[0].pts,R)-R)/t.inputTimeScale;m+=Math.max(0,S),y+=Math.max(0,-S)}if(x){if(e.samplerate||(V.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),f=this.generateIS(e,t,s,o)),d=this.remuxAudio(e,m,this.isAudioContiguous,o,A||v||l===ue.AUDIO?y:void 0),v){const R=d?d.endPTS-d.startPTS:0;t.inputTimeScale||(V.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),f=this.generateIS(e,t,s,o)),c=this.remuxVideo(t,y,C,R)}}else v&&(c=this.remuxVideo(t,y,C,0));c&&(c.firstKeyFrame=k,c.independent=k!==-1,c.firstKeyFramePTS=B)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(g=ol(n,s,this._initPTS,this._initDTS)),i.samples.length&&(h=al(i,s,this._initPTS))),{audio:d,video:c,initSegment:f,independent:p,text:h,id3:g}}generateIS(e,t,n,i){const s=e.samples,o=t.samples,a=this.typeSupported,l={},c=this._initPTS;let d=!c||i,f="audio/mp4",h,g,p;if(d&&(h=g=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break}l.audio={id:"audio",container:f,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):j.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(p=e.inputTimeScale,!c||p!==c.timescale?h=g=s[0].pts-Math.round(p*n):d=!1)}if(t.sps&&t.pps&&o.length&&(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:j.initSegment([t]),metadata:{width:t.width,height:t.height}},d))if(p=t.inputTimeScale,!c||p!==c.timescale){const m=this.getVideoStartPts(o),y=Math.round(p*n);g=Math.min(g,gt(o[0].dts,m)-y),h=Math.min(h,m-y)}else d=!1;if(Object.keys(l).length)return this.ISGenerated=!0,d?(this._initPTS={baseTime:h,timescale:p},this._initDTS={baseTime:g,timescale:p}):h=p=void 0,{tracks:l,initPTS:h,timescale:p}}remuxVideo(e,t,n,i){const s=e.inputTimeScale,o=e.samples,a=[],l=o.length,c=this._initPTS;let d=this.nextAvcDts,f=8,h=this.videoSampleDuration,g,p,m=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,E=!1;if(!n||d===null){const D=t*s,F=o[0].pts-gt(o[0].dts,o[0].pts);d=D-F}const A=c.baseTime*s/c.timescale;for(let D=0;D<l;D++){const F=o[D];F.pts=gt(F.pts-A,d),F.dts=gt(F.dts-A,d),F.dts<o[D>0?D-1:D].dts&&(E=!0)}E&&o.sort(function(D,F){const U=D.dts-F.dts,K=D.pts-F.pts;return U||K}),g=o[0].dts,p=o[o.length-1].dts;const _=p-g,x=_?Math.round(_/(l-1)):h||e.inputTimeScale/30;if(n){const D=g-d,F=D>x,U=D<-1;if((F||U)&&(F?V.warn(`AVC: ${Wn(D,!0)} ms (${D}dts) hole between fragments detected, filling it`):V.warn(`AVC: ${Wn(-D,!0)} ms (${D}dts) overlapping between fragments detected`),!U||d>o[0].pts)){g=d;const K=o[0].pts-D;o[0].dts=g,o[0].pts=K,V.log(`Video: First PTS/DTS adjusted: ${Wn(K,!0)}/${Wn(g,!0)}, delta: ${Wn(D,!0)} ms`)}}g=Math.max(0,g);let v=0,T=0;for(let D=0;D<l;D++){const F=o[D],U=F.units,K=U.length;let N=0;for(let G=0;G<K;G++)N+=U[G].data.length;T+=N,v+=K,F.length=N,F.dts=Math.max(F.dts,g),m=Math.min(F.pts,m),y=Math.max(F.pts,y)}p=o[l-1].dts;const C=T+4*v+8;let k;try{k=new Uint8Array(C)}catch(D){this.observer.emit(P.ERROR,P.ERROR,{type:le.MUX_ERROR,details:W.REMUX_ALLOC_ERROR,fatal:!1,error:D,bytes:C,reason:`fail allocating video mdat ${C}`});return}const B=new DataView(k.buffer);B.setUint32(0,C),k.set(j.types.mdat,4);let R=!1,I=Number.POSITIVE_INFINITY,S=Number.POSITIVE_INFINITY,L=Number.NEGATIVE_INFINITY,b=Number.NEGATIVE_INFINITY;for(let D=0;D<l;D++){const F=o[D],U=F.units;let K=0;for(let H=0,Z=U.length;H<Z;H++){const J=U[H],X=J.data,ne=J.data.byteLength;B.setUint32(f,ne),f+=4,k.set(X,f),f+=ne,K+=4+ne}let N;if(D<l-1)h=o[D+1].dts-F.dts,N=o[D+1].pts-F.pts;else{const H=this.config,Z=D>0?F.dts-o[D-1].dts:x;if(N=D>0?F.pts-o[D-1].pts:x,H.stretchShortVideoTrack&&this.nextAudioPts!==null){const J=Math.floor(H.maxBufferHole*s),X=(i?m+i*s:this.nextAudioPts)-F.pts;X>J?(h=X-Z,h<0?h=Z:R=!0,V.log(`[mp4-remuxer]: It is approximately ${X/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=Z}else h=Z}const G=Math.round(F.pts-F.dts);I=Math.min(I,h),L=Math.max(L,h),S=Math.min(S,N),b=Math.max(b,N),a.push(new ll(F.key,h,K,G))}if(a.length){if(wr){if(wr<70){const D=a[0].flags;D.dependsOn=2,D.isNonSync=0}}else if(Wi&&b-S<L-I&&x/L<.025&&a[0].cts===0){V.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let D=g;for(let F=0,U=a.length;F<U;F++){const K=D+a[F].duration,N=D+a[F].cts;if(F<U-1){const G=K+a[F+1].cts;a[F].duration=G-N}else a[F].duration=F?a[F-1].duration:x;a[F].cts=0,D=K}}}h=R||!h?x:h,this.nextAvcDts=d=p+h,this.videoSampleDuration=h,this.isVideoContiguous=!0;const w=j.moof(e.sequenceNumber++,g,Ke({},e,{samples:a})),M="video",O={data1:w,data2:k,startPTS:m/s,endPTS:(y+h)/s,startDTS:g/s,endDTS:d/s,type:M,hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,O}remuxAudio(e,t,n,i,s){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,c=e.segmentCodec==="aac"?sl:Ky,d=c*l,f=this._initPTS,h=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,g=[],p=s!==void 0;let m=e.samples,y=h?0:8,E=this.nextAudioPts||-1;const A=t*o,_=f.baseTime*o/f.timescale;if(this.isAudioContiguous=n=n||m.length&&E>0&&(i&&Math.abs(A-E)<9e3||Math.abs(gt(m[0].pts-_,A)-E)<20*d),m.forEach(function(M){M.pts=gt(M.pts-_,A)}),!n||E<0){if(m=m.filter(M=>M.pts>=0),!m.length)return;s===0?E=0:i&&!p?E=Math.max(0,A):E=m[0].pts}if(e.segmentCodec==="aac"){const M=this.config.maxAudioFramesDrift;for(let O=0,D=E;O<m.length;O++){const F=m[O],U=F.pts,K=U-D,N=Math.abs(1e3*K/o);if(K<=-M*d&&p)O===0&&(V.warn(`Audio frame @ ${(U/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*K/o)} ms.`),this.nextAudioPts=E=D=U);else if(K>=M*d&&N<Vy&&p){let G=Math.round(K/d);D=U-G*d,D<0&&(G--,D+=d),O===0&&(this.nextAudioPts=E=D),V.warn(`[mp4-remuxer]: Injecting ${G} audio frame @ ${(D/o).toFixed(3)}s due to ${Math.round(1e3*K/o)} ms gap.`);for(let H=0;H<G;H++){const Z=Math.max(D,0);let J=rl.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);J||(V.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),J=F.unit.subarray()),m.splice(O,0,{unit:J,pts:Z}),D+=d,O++}}F.pts=D,D+=d}}let x=null,v=null,T,C=0,k=m.length;for(;k--;)C+=m[k].unit.byteLength;for(let M=0,O=m.length;M<O;M++){const D=m[M],F=D.unit;let U=D.pts;if(v!==null){const N=g[M-1];N.duration=Math.round((U-v)/l)}else if(n&&e.segmentCodec==="aac"&&(U=E),x=U,C>0){C+=y;try{T=new Uint8Array(C)}catch(N){this.observer.emit(P.ERROR,P.ERROR,{type:le.MUX_ERROR,details:W.REMUX_ALLOC_ERROR,fatal:!1,error:N,bytes:C,reason:`fail allocating audio mdat ${C}`});return}h||(new DataView(T.buffer).setUint32(0,C),T.set(j.types.mdat,4))}else return;T.set(F,y);const K=F.byteLength;y+=K,g.push(new ll(!0,c,K,0)),v=U}const B=g.length;if(!B)return;const R=g[g.length-1];this.nextAudioPts=E=v+l*R.duration;const I=h?new Uint8Array(0):j.moof(e.sequenceNumber++,x/l,Ke({},e,{samples:g}));e.samples=[];const S=x/o,L=E/o,w={data1:I,data2:T,startPTS:S,endPTS:L,startDTS:S,endDTS:L,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,w}remuxEmptyAudio(e,t,n,i){const s=e.inputTimeScale,o=e.samplerate?e.samplerate:s,a=s/o,l=this.nextAudioPts,c=this._initDTS,d=c.baseTime*9e4/c.timescale,f=(l!==null?l:i.startDTS*s)+d,h=i.endDTS*s+d,g=a*sl,p=Math.ceil((h-f)/g),m=rl.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(V.warn("[mp4-remuxer]: remux empty Audio"),!m){V.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const y=[];for(let E=0;E<p;E++){const A=f+E*g;y.push({unit:m,pts:A,dts:A})}return e.samples=y,this.remuxAudio(e,t,n,!1)}}function gt(r,e){let t;if(e===null)return r;for(e<r?t=-8589934592:t=8589934592;Math.abs(r-e)>4294967296;)r+=t;return r}function Gy(r){for(let e=0;e<r.length;e++)if(r[e].key)return e;return-1}function ol(r,e,t,n){const i=r.samples.length;if(!i)return;const s=r.inputTimeScale;for(let a=0;a<i;a++){const l=r.samples[a];l.pts=gt(l.pts-t.baseTime*9e4/t.timescale,e*s)/s,l.dts=gt(l.dts-n.baseTime*9e4/n.timescale,e*s)/s}const o=r.samples;return r.samples=[],{samples:o}}function al(r,e,t){const n=r.samples.length;if(!n)return;const i=r.inputTimeScale;for(let o=0;o<n;o++){const a=r.samples[o];a.pts=gt(a.pts-t.baseTime*9e4/t.timescale,e*i)/i}r.samples.sort((o,a)=>o.pts-a.pts);const s=r.samples;return r.samples=[],{samples:s}}class ll{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags=new jy(e)}}class jy{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}class Hy{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(cm(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=ca(e);t||(t=ul(i.audio,Le.AUDIO)),n||(n=ul(i.video,Le.VIDEO));const s={};i.audio&&i.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:V.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,i,s,o){var a,l;let{initPTS:c,lastEndTime:d}=this;const f={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};oe(d)||(d=this.lastEndTime=s||0);const h=t.samples;if(!(h!=null&&h.length))return f;const g={initPTS:void 0,timescale:1};let p=this.initData;if((a=p)!=null&&a.length||(this.generateInitSegment(h),p=this.initData),!((l=p)!=null&&l.length))return V.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),f;this.emitInitSegment&&(g.tracks=this.initTracks,this.emitInitSegment=!1);const m=fm(h,p),y=dm(p,h),E=y===null?s:y;(Wy(c,E,s,m)||g.timescale!==c.timescale&&o)&&(g.initPTS=E-s,c&&c.timescale===1&&V.warn(`Adjusting initPTS by ${g.initPTS-c.baseTime}`),this.initPTS=c={baseTime:g.initPTS,timescale:1});const A=e?E-c.baseTime/c.timescale:d,_=A+m;pm(p,h,c.baseTime/c.timescale),m>0?this.lastEndTime=_:(V.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const x=!!p.audio,v=!!p.video;let T="";x&&(T+="audio"),v&&(T+="video");const C={data1:h,startPTS:A,startDTS:A,endPTS:_,endDTS:_,type:T,hasAudio:x,hasVideo:v,nb:1,dropped:0};return f.audio=C.type==="audio"?C:void 0,f.video=C.type!=="audio"?C:void 0,f.initSegment=g,f.id3=ol(n,s,c,c),i.samples.length&&(f.text=al(i,s,c)),f}}function Wy(r,e,t,n){if(r===null)return!0;const i=Math.max(n,1),s=e-r.baseTime/r.timescale;return Math.abs(s-t)>i}function ul(r,e){const t=r==null?void 0:r.codec;return t&&t.length>4?t:t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":t==="avc1"||e===Le.VIDEO?"avc1.42e01e":"mp4a.40.5"}let Bt;try{Bt=self.performance.now.bind(self.performance)}catch{V.debug("Unable to use Performance API on this environment"),Bt=typeof self<"u"&&self.Date.now}const Ji=[{demux:Cy,remux:Hy},{demux:jt,remux:Qi},{demux:Iy,remux:Qi},{demux:Fy,remux:Qi}];class cl{constructor(e,t,n,i,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const s=n.transmuxing;s.executeStart=Bt();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);const{contiguous:c,discontinuity:d,trackSwitch:f,accurateTimeOffset:h,timeOffset:g,initSegmentChange:p}=i||a,{audioCodec:m,videoCodec:y,defaultInitPts:E,duration:A,initSegmentData:_}=l,x=Qy(o,t);if(x&&x.method==="AES-128"){const k=this.getDecrypter();if(k.isSync()){let B=k.softwareDecrypt(o,x.key.buffer,x.iv.buffer);if(n.part>-1&&(B=k.flush()),!B)return s.executeEnd=Bt(),Yi(n);o=new Uint8Array(B)}else return this.decryptionPromise=k.webCryptoDecrypt(o,x.key.buffer,x.iv.buffer).then(B=>{const R=this.push(B,null,n);return this.decryptionPromise=null,R}),this.decryptionPromise}const v=this.needsProbing(d,f);if(v){const k=this.configureTransmuxer(o);if(k)return V.warn(`[transmuxer] ${k.message}`),this.observer.emit(P.ERROR,P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,error:k,reason:k.message}),s.executeEnd=Bt(),Yi(n)}(d||f||p||v)&&this.resetInitSegment(_,m,y,A,t),(d||p||v)&&this.resetInitialTimestamp(E),c||this.resetContiguity();const T=this.transmux(o,x,g,h,n),C=this.currentTransmuxState;return C.contiguous=!0,C.discontinuity=!1,C.trackSwitch=!1,s.executeEnd=Bt(),T}flush(e){const t=e.transmuxing;t.executeStart=Bt();const{decrypter:n,currentTransmuxState:i,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const o=[],{timeOffset:a}=i;if(n){const f=n.flush();f&&o.push(this.push(f,null,e))}const{demuxer:l,remuxer:c}=this;if(!l||!c)return t.executeEnd=Bt(),[Yi(e)];const d=l.flush(a);return kr(d)?d.then(f=>(this.flushRemux(o,f,e),o)):(this.flushRemux(o,d,e),o)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:s,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;V.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const d=this.remuxer.remux(i,s,o,a,c,l,!0,this.id);e.push({remuxResult:d,chunkMeta:n}),n.transmuxing.executeEnd=Bt()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,s){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,i,s):o=this.transmuxUnencrypted(e,n,i,s),o}transmuxUnencrypted(e,t,n,i){const{audioTrack:s,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,l,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,s){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,i,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:s}=this;let o;for(let f=0,h=Ji.length;f<h;f++)if(Ji[f].demux.probe(e)){o=Ji[f];break}if(!o)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,l=this.remuxer,c=o.remux,d=o.demux;(!l||!(l instanceof c))&&(this.remuxer=new c(n,t,i,s)),(!a||!(a instanceof d))&&(this.demuxer=new d(n,t,i),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Ni(this.config)),e}}function Qy(r,e){let t=null;return r.byteLength>0&&e!=null&&e.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Yi=r=>({remuxResult:{},chunkMeta:r});function kr(r){return"then"in r&&r.then instanceof Function}class Jy{constructor(e,t,n,i,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=s||null}}class Yy{constructor(e,t,n,i,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=s,this.initSegmentChange=o}}var dl={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,c,d){this.fn=l,this.context=c,this.once=d||!1}function s(l,c,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new i(d,f||l,h),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],g]:l._events[p].push(g):(l._events[p]=g,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],d,f;if(this._eventsCount===0)return c;for(f in d=this._events)e.call(d,f)&&c.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},a.prototype.listeners=function(c){var d=t?t+c:c,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,g=f.length,p=new Array(g);h<g;h++)p[h]=f[h].fn;return p},a.prototype.listenerCount=function(c){var d=t?t+c:c,f=this._events[d];return f?f.fn?1:f.length:0},a.prototype.emit=function(c,d,f,h,g,p){var m=t?t+c:c;if(!this._events[m])return!1;var y=this._events[m],E=arguments.length,A,_;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),E){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,h),!0;case 5:return y.fn.call(y.context,d,f,h,g),!0;case 6:return y.fn.call(y.context,d,f,h,g,p),!0}for(_=1,A=new Array(E-1);_<E;_++)A[_-1]=arguments[_];y.fn.apply(y.context,A)}else{var x=y.length,v;for(_=0;_<x;_++)switch(y[_].once&&this.removeListener(c,y[_].fn,void 0,!0),E){case 1:y[_].fn.call(y[_].context);break;case 2:y[_].fn.call(y[_].context,d);break;case 3:y[_].fn.call(y[_].context,d,f);break;case 4:y[_].fn.call(y[_].context,d,f,h);break;default:if(!A)for(v=1,A=new Array(E-1);v<E;v++)A[v-1]=arguments[v];y[_].fn.apply(y[_].context,A)}}return!0},a.prototype.on=function(c,d,f){return s(this,c,d,f,!1)},a.prototype.once=function(c,d,f){return s(this,c,d,f,!0)},a.prototype.removeListener=function(c,d,f,h){var g=t?t+c:c;if(!this._events[g])return this;if(!d)return o(this,g),this;var p=this._events[g];if(p.fn)p.fn===d&&(!h||p.once)&&(!f||p.context===f)&&o(this,g);else{for(var m=0,y=[],E=p.length;m<E;m++)(p[m].fn!==d||h&&!p[m].once||f&&p[m].context!==f)&&y.push(p[m]);y.length?this._events[g]=y.length===1?y[0]:y:o(this,g)}return this},a.prototype.removeAllListeners=function(c){var d;return c?(d=t?t+c:c,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,r.exports=a})(dl);var zy=dl.exports,zi=Pg(zy);const qi=Ar()||{isTypeSupported:()=>!1};class fl{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const o=(c,d)=>{d=d||{},d.frag=this.frag,d.id=this.id,c===P.ERROR&&(this.error=d.error),this.hls.trigger(c,d)};this.observer=new zi,this.observer.on(P.FRAG_DECRYPTED,o),this.observer.on(P.ERROR,o);const a={mp4:qi.isTypeSupported("video/mp4"),mpeg:qi.isTypeSupported("audio/mpeg"),mp3:qi.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||my())){try{s.workerPath?(V.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=Ey(s.workerPath)):(V.log(`injecting Web Worker for "${t}"`),this.workerContext=yy()),this.onwmsg=f=>this.onWorkerMessage(f);const{worker:d}=this.workerContext;d.addEventListener("message",this.onwmsg),d.onerror=f=>{const h=new Error(`${f.message}  (${f.filename}:${f.lineno})`);s.enableWorker=!1,V.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(P.ERROR,{type:le.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})},d.postMessage({cmd:"init",typeSupported:a,vendor:l,id:t,config:JSON.stringify(s)})}catch(d){V.warn(`Error setting up "${t}" Web Worker, fallback to inline`,d),this.resetWorker(),this.error=null,this.transmuxer=new cl(this.observer,a,s,l,t)}return}this.transmuxer=new cl(this.observer,a,s,l,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,s,o,a,l,c,d){var f,h;c.transmuxing.start=self.performance.now();const{transmuxer:g}=this,p=o?o.start:s.start,m=s.decryptdata,y=this.frag,E=!(y&&s.cc===y.cc),A=!(y&&c.level===y.level),_=y?c.sn-y.sn:-1,x=this.part?c.part-this.part.index:-1,v=_===0&&c.id>1&&c.id===(y==null?void 0:y.stats.chunkCount),T=!A&&(_===1||_===0&&(x===1||v&&x<=0)),C=self.performance.now();(A||_||s.stats.parsing.start===0)&&(s.stats.parsing.start=C),o&&(x||!T)&&(o.stats.parsing.start=C);const k=!(y&&((f=s.initSegment)==null?void 0:f.url)===((h=y.initSegment)==null?void 0:h.url)),B=new Yy(E,T,l,A,p,k);if(!T||E||k){V.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${c.sn} p: ${c.part} level: ${c.level} id: ${c.id}
        discontinuity: ${E}
        trackSwitch: ${A}
        contiguous: ${T}
        accurateTimeOffset: ${l}
        timeOffset: ${p}
        initSegmentChange: ${k}`);const R=new Jy(n,i,t,a,d);this.configureTransmuxer(R)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:m,chunkMeta:c,state:B},e instanceof ArrayBuffer?[e]:[]);else if(g){const R=g.push(e,m,c,B);kr(R)?(g.async=!0,R.then(I=>{this.handleTransmuxComplete(I)}).catch(I=>{this.transmuxerError(I,c,"transmuxer-interface push error")})):(g.async=!1,this.handleTransmuxComplete(R))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);kr(n)||t.async?(kr(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,n=this.hls;switch(t.event){case"init":{var i;const s=(i=this.workerContext)==null?void 0:i.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":V[t.data.logType]&&V[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const qy=250,Zi=2,Zy=.1,Xy=.05;class $y{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:s}=this;if(i===null)return;const{currentTime:o,seeking:a}=i,l=this.seeking&&!a,c=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,s!==null){if(this.stallReported){const E=self.performance.now()-s;V.warn(`playback not stuck anymore @${o}, after ${Math.round(E)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(c||l){this.stalled=null;return}if(i.paused&&!a||i.ended||i.playbackRate===0||!Oe.getBuffered(i).length)return;const d=Oe.bufferInfo(i,o,0),f=d.len>0,h=d.nextStart||0;if(!f&&!h)return;if(a){const E=d.len>Zi,A=!h||t&&t.start<=o||h-o>Zi&&!this.fragmentTracker.getPartialFragment(o);if(E||A)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var g;const E=Math.max(h,d.start||0)-o,A=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,x=(A==null||(g=A.details)==null?void 0:g.live)?A.details.targetduration*2:Zi,v=this.fragmentTracker.getPartialFragment(o);if(E>0&&(E<=x||v)){this._trySkipBufferHole(v);return}}const p=self.performance.now();if(s===null){this.stalled=p;return}const m=p-s;if(!a&&m>=qy&&(this._reportStall(d),!this.media))return;const y=Oe.bufferInfo(i,o,n.maxBufferHole);this._tryFixBufferStall(y,m)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:s}=this;if(s===null)return;const o=s.currentTime,a=i.getPartialFragment(o);a&&(this._trySkipBufferHole(a)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(V.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);V.warn(s.message),t.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(i===null)return 0;const s=i.currentTime,o=Oe.bufferInfo(i,s,0),a=s<o.start?o.start:o.nextStart;if(a){const l=o.len<=t.maxBufferHole,c=o.len>0&&o.len<1&&i.readyState<3,d=a-s;if(d>0&&(l||c)){if(d>t.maxBufferHole){const{fragmentTracker:h}=this;let g=!1;if(s===0){const p=h.getAppendedFrag(0,ue.MAIN);p&&a<p.end&&(g=!0)}if(!g){const p=e||h.getAppendedFrag(s,ue.MAIN);if(p){let m=!1,y=p.end;for(;y<a;){const E=h.getPartialFragment(y);if(E)y+=E.duration;else{m=!0;break}}if(m)return 0}}}const f=Math.max(a+Xy,s+Zy);if(V.warn(`skipping hole, adjusting currentTime from ${s} to ${f}`),this.moved=!0,this.stalled=null,i.currentTime=f,e&&!e.gap){const h=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${f}`);n.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:e})}return f}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(n===null)return;const s=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const o=s+(i+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${s} to ${o}`);V.warn(a.message),n.currentTime=o,t.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);V.error(o.message),t.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}const eE=100;class tE extends Ui{constructor(e,t,n){super(e,t,n,"[stream-controller]",ue.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.LEVEL_LOADING,this.onLevelLoading,this),e.on(P.LEVEL_LOADED,this.onLevelLoaded,this),e.on(P.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(P.ERROR,this.onError,this),e.on(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(P.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(P.BUFFER_CREATED,this.onBufferCreated,this),e.on(P.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.LEVEL_LOADED,this.onLevelLoaded,this),e.off(P.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(P.ERROR,this.onError,this),e.off(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(P.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(P.BUFFER_CREATED,this.onBufferCreated,this),e.off(P.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(eE),this.level=-1,!this.startFragRequested){let i=n.startLevel;i===-1&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.nextAutoLevel),this.level=n.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=Y.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Y.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Y.WAITING_LEVEL:{var e;const{levels:n,level:i}=this,s=n==null||(e=n[i])==null?void 0:e.details;if(s&&(!s.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(s))break;this.state=Y.IDLE;break}break}case Y.FRAG_LOADING_WAITING_RETRY:{var t;const n=self.performance.now(),i=this.retryDate;(!i||n>=i||(t=this.media)!=null&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=Y.IDLE)}break}this.state===Y.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this,{config:s,nextLoadLevel:o}=e;if(t===null||!i&&(this.startFragRequested||!s.startFragPrefetch)||this.altAudio&&this.audioOnly||!(n!=null&&n[o]))return;const a=n[o],l=this.getMainFwdBufferInfo();if(l===null)return;const c=this.getLevelDetails();if(c&&this._streamEnded(l,c)){const y={};this.altAudio&&(y.type="video"),this.hls.trigger(P.BUFFER_EOS,y),this.state=Y.ENDED;return}e.loadLevel!==o&&e.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const d=a.details;if(!d||this.state===Y.WAITING_LEVEL||d.live&&this.levelLastLoaded!==o){this.level=o,this.state=Y.WAITING_LEVEL;return}const f=l.len,h=this.getMaxBufferLength(a.maxBitrate);if(f>=h)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const g=this.backtrackFragment?this.backtrackFragment.start:l.end;let p=this.getNextFragment(g,d);if(this.couldBacktrack&&!this.fragPrevious&&p&&p.sn!=="initSegment"&&this.fragmentTracker.getState(p)!==Je.OK){var m;const E=((m=this.backtrackFragment)!=null?m:p).sn-d.startSN,A=d.fragments[E-1];A&&p.cc===A.cc&&(p=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,g)){if(!p.gap){const E=this.audioOnly&&!this.altAudio?Le.AUDIO:Le.VIDEO,A=(E===Le.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,E,ue.MAIN)}p=this.getNextFragmentLoopLoading(p,d,l,ue.MAIN,h)}p&&(p.initSegment&&!p.initSegment.data&&!this.bitrateTest&&(p=p.initSegment),this.loadFragment(p,a,g))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===Je.NOT_LOADED||i===Je.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ue.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<s.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],c=this.fragLastKbps;c&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,c=a.duration,d=Math.max(o.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*.5),c*.75));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Y.KEY_LOADING:case Y.FRAG_LOADING:case Y.FRAG_LOADING_WAITING_RETRY:case Y.PARSING:case Y.PARSED:this.state=Y.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new $y(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;oe(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(P.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1,s;t.levels.forEach(o=>{s=o.audioCodec,s&&(s.indexOf("mp4a.40.2")!==-1&&(n=!0),s.indexOf("mp4a.40.5")!==-1&&(i=!0))}),this.audioCodecSwitch=n&&i&&!gy(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Y.IDLE)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(i.details))&&(this.state=Y.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i}=this,s=t.level,o=t.details,a=o.totalduration;if(!i){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const l=i[s],c=this.fragCurrent;c&&(this.state===Y.FRAG_LOADING||this.state===Y.FRAG_LOADING_WAITING_RETRY)&&(c.level!==t.level||c.urlId!==l.urlId)&&c.loader&&this.abortCurrentFrag();let d=0;if(o.live||(n=l.details)!=null&&n.live){if(o.fragments[0]||(o.deltaUpdateFailed=!0),o.deltaUpdateFailed)return;d=this.alignPlaylists(o,l.details)}if(l.details=o,this.levelLastLoaded=s,this.hls.trigger(P.LEVEL_UPDATED,{details:o,level:s}),this.state===Y.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=Y.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,d),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const a=o[n.level],l=a.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const c=a.videoCodec,d=l.PTSKnown||!l.live,f=(t=n.initSegment)==null?void 0:t.data,h=this._getAudioCodec(a),g=this.transmuxer=this.transmuxer||new fl(this.hls,ue.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=i?i.index:-1,m=p!==-1,y=new Mi(n.level,n.sn,n.stats.chunkCount,s.byteLength,p,m),E=this.initPTS[n.cc];g.push(s,f,h,c,n,i,l.totalduration,d,y,E)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;n&&(s.trigger(P.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(P.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,s,o=!1;for(const a in n){const l=n[a];if(l.id==="main"){if(s=a,i=l,a==="video"){const c=n[a];c&&(this.videoBuffer=c.buffer)}}else o=!0}o&&i?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==ue.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===Y.PARSED&&(this.state=Y.IDLE);return}const s=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=Y.ERROR;return}switch(t.details){case W.FRAG_GAP:case W.FRAG_PARSING_ERROR:case W.FRAG_DECRYPT_ERROR:case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ue.MAIN,t);break;case W.LEVEL_LOAD_ERROR:case W.LEVEL_LOAD_TIMEOUT:case W.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Y.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===Te.LEVEL&&(this.state=Y.IDLE);break;case W.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case W.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Oe.getBuffered(e).length){const n=this.state!==Y.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Y.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Le.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===Le.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,ue.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=Oe.getBuffered(e),o=(i.length?i.start(0):0)-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=Y.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),i.trigger(P.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:d}=a,{video:f,text:h,id3:g,initSegment:p}=s,{details:m}=d,y=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=Y.PARSING,p){if(p!=null&&p.tracks){const _=l.initSegment||l;this._bufferInitSegment(d,p.tracks,_,o),i.trigger(P.FRAG_PARSING_INIT_SEGMENT,{frag:_,id:n,tracks:p.tracks})}const E=p.initPTS,A=p.timescale;oe(E)&&(this.initPTS[l.cc]={baseTime:E,timescale:A},i.trigger(P.INIT_PTS_FOUND,{frag:l,id:n,initPTS:E,timescale:A}))}if(f&&s.independent!==!1){if(m){const{startPTS:E,endPTS:A,startDTS:_,endDTS:x}=f;if(c)c.elementaryStreams[f.type]={startPTS:E,endPTS:A,startDTS:_,endDTS:x};else if(f.firstKeyFrame&&f.independent&&o.id===1&&(this.couldBacktrack=!0),f.dropped&&f.independent){const v=this.getMainFwdBufferInfo(),T=(v?v.end:this.getLoadPosition())+this.config.maxBufferHole,C=f.firstKeyFramePTS?f.firstKeyFramePTS:E;if(T<C-this.config.maxBufferHole){this.backtrack(l);return}l.setElementaryStreamInfo(f.type,l.start,A,l.start,x,!0)}l.setElementaryStreamInfo(f.type,E,A,_,x),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(f,l,c,o)}}else if(s.independent===!1){this.backtrack(l);return}if(y){const{startPTS:E,endPTS:A,startDTS:_,endDTS:x}=y;c&&(c.elementaryStreams[Le.AUDIO]={startPTS:E,endPTS:A,startDTS:_,endDTS:x}),l.setElementaryStreamInfo(Le.AUDIO,E,A,_,x),this.bufferFragmentData(y,l,c,o)}if(m&&g!=null&&(t=g.samples)!=null&&t.length){const E={id:n,frag:l,details:m,samples:g.samples};i.trigger(P.FRAG_PARSING_METADATA,E)}if(m&&h){const E={id:n,frag:l,details:m,samples:h.samples};i.trigger(P.FRAG_PARSING_USERDATA,E)}}_bufferInitSegment(e,t,n,i){if(this.state!==Y.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:a}=t;if(s){let l=e.audioCodec;const c=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5"),s.metadata.channelCount!==1&&c.indexOf("firefox")===-1&&(l="mp4a.40.5")),c.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${a.codec}]`),this.hls.trigger(P.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const d=t[l].initSegment;d!=null&&d.byteLength&&this.hls.trigger(P.BUFFER_APPENDING,{type:l,data:d,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ue.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Y.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Oe.isBuffered(e,n)?t=this.getAppendedFrag(n):Oe.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,s=t.level;(!i||t.sn!==i.sn||i.level!==s||t.urlId!==i.urlId)&&(this.fragPlaying=t,this.hls.trigger(P.FRAG_CHANGED,{frag:t}),(!i||i.level!==s)&&this.hls.trigger(P.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&oe(t)&&oe(n.programDateTime)){const i=n.programDateTime+(t-n.start)*1e3;return new Date(i)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class vn{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class nE{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new vn(e),this.fast_=new vn(t),this.defaultTTFB_=i,this.ttfb_=new vn(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new vn(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new vn(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new vn(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,s=n/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class rE{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new nE(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(P.FRAG_LOADING,this.onFragLoading,this),e.on(P.FRAG_LOADED,this.onFragLoaded,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this),e.on(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(P.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(P.FRAG_LOADING,this.onFragLoading,this),e.off(P.FRAG_LOADED,this.onFragLoaded,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this),e.off(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(P.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var n;const i=t.frag;this.ignoreFragment(i)||(this.fragCurrent=i,this.partCurrent=(n=t.part)!=null?n:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,n,i){const s=e+n/t,o=i?this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){const n=this.hls.config,{total:i,bwEstimate:s}=t.stats;oe(i)&&oe(s)&&(this.lastLevelLoadSec=8*i/s),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:i,media:s}=n;if(!e||!s)return;const o=performance.now(),a=t?t.stats:e.stats,l=t?t.duration:e.duration,c=o-a.loading.start;if(a.aborted||a.loaded&&a.loaded===a.total||e.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!i||s.paused||!s.playbackRate||!s.readyState)return;const d=n.mainForwardBufferInfo;if(d===null)return;const f=this.bwEstimator.getEstimateTTFB(),h=Math.abs(s.playbackRate);if(c<=Math.max(f,1e3*(l/(h*2))))return;const g=d.len/h;if(g>=2*l/h)return;const p=a.loading.first?a.loading.first-a.loading.start:-1,m=a.loaded&&p>-1,y=this.bwEstimator.getEstimate(),{levels:E,minAutoLevel:A}=n,_=E[e.level],x=a.total||Math.max(a.loaded,Math.round(l*_.maxBitrate/8));let v=c-p;v<1&&m&&(v=Math.min(c,a.loaded*8/y));const T=m?a.loaded*1e3/v:0,C=T?(x-a.loaded)/T:x*8/y+f/1e3;if(C<=g)return;const k=T?T*8:y;let B=Number.POSITIVE_INFINITY,R;for(R=e.level-1;R>A;R--){const I=E[R].maxBitrate;if(B=this.getTimeToLoadFrag(f/1e3,k,l*I,!E[R].details),B<g)break}B>=C||B>l*10||(n.nextLoadLevel=R,m?this.bwEstimator.sample(c-Math.min(f,p),a.loaded):this.bwEstimator.sampleTTFB(c),this.clearTimer(),V.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;
      Time to underbuffer: ${g.toFixed(3)} s
      Estimated load time for current fragment: ${C.toFixed(3)} s
      Estimated load time for down switch fragment: ${B.toFixed(3)} s
      TTFB estimate: ${p}
      Current BW estimate: ${oe(y)?(y/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${R}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),n.trigger(P.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:a}))}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===ue.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+i.loaded,l=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const s={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(P.FRAG_BUFFERED,s),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:n,part:i}=t,s=i!=null&&i.stats.loaded?i.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ue.MAIN||e.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(e!==-1&&!t.canEstimate())return e;let n=this.getNextABRAutoLevel();if(e!==-1){const i=this.hls.levels;if(i.length>Math.max(e,n)&&i[e].loadError<=i[n].loadError)return e}return e!==-1&&(n=Math.min(e,n)),n}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:s,minAutoLevel:o,media:a}=n,l=t?t.duration:e?e.duration:0,c=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,d=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,f=n.mainForwardBufferInfo,h=(f?f.len:0)/c;let g=this.findBestLevel(d,o,i,h,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(g>=0)return g;V.trace(`[abr] ${h?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let p=l?Math.min(l,s.maxStarvationDelay):s.maxStarvationDelay,m=s.abrBandWidthFactor,y=s.abrBandWidthUpFactor;if(!h){const E=this.bitrateTestDelay;E&&(p=(l?Math.min(l,s.maxLoadingDelay):s.maxLoadingDelay)-E,V.trace(`[abr] bitrate test took ${Math.round(1e3*E)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),m=y=1)}return g=this.findBestLevel(d,o,i,h+p,m,y),Math.max(g,0)}findBestLevel(e,t,n,i,s,o){var a;const{fragCurrent:l,partCurrent:c,lastLoadedFragLevel:d}=this,{levels:f}=this.hls,h=f[d],g=!!(h!=null&&(a=h.details)!=null&&a.live),p=h==null?void 0:h.codecSet,m=c?c.duration:l?l.duration:0,y=this.bwEstimator.getEstimateTTFB()/1e3;let E=t,A=-1;for(let _=n;_>=t;_--){const x=f[_];if(!x||p&&x.codecSet!==p){x&&(E=Math.min(_,E),A=Math.max(_,A));continue}A!==-1&&V.trace(`[abr] Skipped level(s) ${E}-${A} with CODECS:"${f[A].attrs.CODECS}"; not compatible with "${h.attrs.CODECS}"`);const v=x.details,T=(c?v==null?void 0:v.partTarget:v==null?void 0:v.averagetargetduration)||m;let C;_<=d?C=s*e:C=o*e;const k=f[_].maxBitrate,B=this.getTimeToLoadFrag(y,C,k*T,v===void 0);if(V.trace(`[abr] level:${_} adjustedbw-bitrate:${Math.round(C-k)} avgDuration:${T.toFixed(1)} maxFetchDuration:${i.toFixed(1)} fetchDuration:${B.toFixed(1)}`),C>k&&(B===0||!oe(B)||g&&!this.bitrateTestDelay||B<i))return _}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}}class hl{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=iE(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function iE(r,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<r.length;i++){const s=r[i];t.set(s,n),n+=s.length}return t}const pl=100;class sE extends Ui{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",ue.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.LEVEL_LOADED,this.onLevelLoaded,this),e.on(P.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(P.ERROR,this.onError,this),e.on(P.BUFFER_RESET,this.onBufferReset,this),e.on(P.BUFFER_CREATED,this.onBufferCreated,this),e.on(P.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(P.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.LEVEL_LOADED,this.onLevelLoaded,this),e.off(P.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(P.ERROR,this.onError,this),e.off(P.BUFFER_RESET,this.onBufferReset,this),e.off(P.BUFFER_CREATED,this.onBufferCreated,this),e.off(P.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(P.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){if(n==="main"){const o=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${i}`),this.videoTrackCC=o,this.state===Y.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=Y.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(pl),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=Y.IDLE):(this.loadedmetadata=!1,this.state=Y.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Y.IDLE:this.doTickIdle();break;case Y.WAITING_TRACK:{var e;const{levels:n,trackId:i}=this,s=n==null||(e=n[i])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=Y.WAITING_INIT_PTS}break}case Y.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),i=this.retryDate;(!i||n>=i||(t=this.media)!=null&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=Y.IDLE);break}case Y.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:i,part:s,cache:o,complete:a}=n;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Y.FRAG_LOADING;const l=o.flush(),c={frag:i,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),a&&super._handleFragmentLoadComplete(c)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),c=Oe.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);Oi(c.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${c.end} is needed`),this.clearWaitingFragment())}}else this.state=Y.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Y.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,s=e.config;if(!(t!=null&&t[i])||!n&&(this.startFragRequested||!s.startFragPrefetch))return;const o=t[i],a=o.details;if(!a||a.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(a)){this.state=Y.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,Le.AUDIO,ue.AUDIO));const c=this.getFwdBufferInfo(l,ue.AUDIO);if(c===null)return;const{bufferedTrack:d,switchingTrack:f}=this;if(!f&&this._streamEnded(c,a)){e.trigger(P.BUFFER_EOS,{type:"audio"}),this.state=Y.ENDED;return}const h=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ue.MAIN),g=c.len,p=this.getMaxBufferLength(h==null?void 0:h.len);if(g>=p&&!f)return;const y=a.fragments[0].start;let E=c.end;if(f&&n){const v=this.getLoadPosition();d&&f.attrs!==d.attrs&&(E=v),a.PTSKnown&&v<y&&(c.end>y||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=y+.05)}let A=this.getNextFragment(E,a),_=!1;if(A&&this.isLoopLoading(A,E)&&(_=!!A.gap,A=this.getNextFragmentLoopLoading(A,a,c,ue.MAIN,p)),!A){this.bufferFlushed=!0;return}const x=h&&A.start>h.end+a.targetduration;if(x||!(h!=null&&h.len)&&c.len){const v=this.getAppendedFrag(A.start,ue.MAIN);if(v===null||(_||(_=!!v.gap||!!x&&h.len===0),x&&!_||_&&c.nextStart&&c.nextStart<v.end))return}this.loadFragment(A,o,E)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new jn(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(pl):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=Y.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Y.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(P.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:i}=this,{details:s,id:o}=t;if(!i){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const a=i[o];let l=0;if(s.live||(n=a.details)!=null&&n.live){const c=this.mainDetails;if(s.fragments[0]||(s.deltaUpdateFailed=!0),s.deltaUpdateFailed||!c)return;!a.details&&s.hasProgramDateTime&&c.hasProgramDateTime?(Wa(s,c),l=s.fragments[0].start):l=this.alignPlaylists(s,a.details)}a.details=s,this.levelLastLoaded=o,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(a.details,l),this.state===Y.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=Y.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:s}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const c=l[a];if(!c){this.warn("Audio track is undefined on fragment load progress");return}const d=c.details;if(!d){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const f=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new fl(this.hls,ue.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const g=this.initPTS[n.cc],p=(t=n.initSegment)==null?void 0:t.data;if(g!==void 0){const y=i?i.index:-1,E=y!==-1,A=new Mi(n.level,n.sn,n.stats.chunkCount,s.byteLength,y,E);h.push(s,p,f,"",n,i,d.totalduration,!1,A,g)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${d.startSN} ,${d.endSN}],track ${a}`);const{cache:m}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new hl,complete:!1};m.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=Y.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==ue.AUDIO){if(!this.loadedmetadata&&n.type===ue.MAIN){var s;(s=this.videoBuffer||this.media)!=null&&s.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(P.AUDIO_TRACK_SWITCHED,nt({},o)))}this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=Y.ERROR;return}switch(t.details){case W.FRAG_GAP:case W.FRAG_PARSING_ERROR:case W.FRAG_DECRYPT_ERROR:case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ue.AUDIO,t);break;case W.AUDIO_TRACK_LOAD_ERROR:case W.AUDIO_TRACK_LOAD_TIMEOUT:case W.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Y.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===Te.AUDIO_TRACK&&(this.state=Y.IDLE);break;case W.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case W.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushed(e,{type:t}){t===Le.AUDIO&&(this.bufferFlushed=!0,this.state===Y.ENDED&&(this.state=Y.IDLE))}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:d}=a,{details:f}=d,{audio:h,text:g,id3:p,initSegment:m}=s;if(this.fragContextChanged(l)||!f){this.fragmentTracker.removeFragment(l);return}if(this.state=Y.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),m!=null&&m.tracks){const y=l.initSegment||l;this._bufferInitSegment(m.tracks,y,o),i.trigger(P.FRAG_PARSING_INIT_SEGMENT,{frag:y,id:n,tracks:m.tracks})}if(h){const{startPTS:y,endPTS:E,startDTS:A,endDTS:_}=h;c&&(c.elementaryStreams[Le.AUDIO]={startPTS:y,endPTS:E,startDTS:A,endDTS:_}),l.setElementaryStreamInfo(Le.AUDIO,y,E,A,_),this.bufferFragmentData(h,l,c,o)}if(p!=null&&(t=p.samples)!=null&&t.length){const y=Ke({id:n,frag:l,details:f},p);i.trigger(P.FRAG_PARSING_METADATA,y)}if(g){const y=Ke({id:n,frag:l,details:f},g);i.trigger(P.FRAG_PARSING_USERDATA,y)}}_bufferInitSegment(e,t,n){if(this.state!==Y.PARSING)return;e.video&&delete e.video;const i=e.audio;if(!i)return;i.levelCodec=i.codec,i.id="audio",this.log(`Init audio buffer, container:${i.container}, codecs[parsed]=[${i.codec}]`),this.hls.trigger(P.BUFFER_CODECS,e);const s=i.initSegment;if(s!=null&&s.byteLength){const o={type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:s};this.hls.trigger(P.BUFFER_APPENDING,o)}this.tick()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===Je.NOT_LOADED||i===Je.PARTIAL){var s;e.sn==="initSegment"?this._loadInitSegment(e,t):(s=t.details)!=null&&s.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Y.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,n))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:n,bufferedTrack:i}=this,s=i==null?void 0:i.attrs,o=e.attrs;n&&s&&(s.CHANNELS!==o.CHANNELS||s.NAME!==o.NAME||s.LANGUAGE!==o.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(P.AUDIO_TRACK_SWITCHED,nt({},e))}}class oE extends Pi{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.LEVEL_LOADING,this.onLevelLoading,this),e.on(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(P.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.LEVEL_LOADING,this.onLevelLoading,this),e.off(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(P.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Track with id:${n} and group:${i} not found in active group ${o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`audio-track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.audioGroupIds))return;const n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n||null;const i=this.tracks.filter(o=>!n||o.groupId===n);this.selectDefaultTrack&&!i.some(o=>o.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=i;const s={audioTracks:i};this.log(`Updating audio tracks, ${i.length} track(s) found in group:${n}`),this.hls.trigger(P.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Te.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();const n=this.currentTrack;t[this.trackId];const i=t[e],{groupId:s,name:o}=i;if(this.log(`Switching to audio-track ${e} "${o}" lang:${i.lang} group:${s}`),this.trackId=e,this.currentTrack=i,this.selectDefaultTrack=!1,this.hls.trigger(P.AUDIO_TRACK_SWITCHING,nt({},i)),i.details&&!i.details.live)return;const a=this.switchParams(i.url,n==null?void 0:n.details);this.loadPlaylist(a)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(t!==-1)this.setAudioTrack(t);else{const n=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(n.message),this.hls.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:n})}}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||e.attrs["STABLE-RENDITION-ID"]!==void 0&&e.attrs["STABLE-RENDITION-ID"]===i.attrs["STABLE-RENDITION-ID"]||e.name===i.name&&e.lang===i.lang))return i.id}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,i=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(P.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}}function gl(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!aE(r[t].attrs,e[t].attrs))return!1;return!0}function aE(r,e){const t=r["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(n=>r[n]!==e[n])}const ml=500;class lE extends Ui{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",ue.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.LEVEL_LOADED,this.onLevelLoaded,this),e.on(P.ERROR,this.onError,this),e.on(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(P.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(P.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.LEVEL_LOADED,this.onLevelLoaded,this),e.off(P.ERROR,this.onError,this),e.off(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(P.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(P.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Y.IDLE,this.setInterval(ml),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=Y.IDLE,!i)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const a=n.start;for(let c=0;c<s.length;c++)if(a>=s[c].start&&a<=s[c].end){o=s[c];break}const l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},s.push(o)),this.fragmentTracker.fragBuffered(n)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const{currentTrackId:s,levels:o}=this;if(!o.length||!o[s]||!o[s].details)return;const l=o[s].details.targetduration,c=i-l;if(c<=0)return;t.endOffsetSubtitles=Math.max(0,c),this.tracksBuffered.forEach(d=>{for(let f=0;f<d.length;){if(d[f].end<=c){d.shift();continue}else if(d[f].start<c)d[f].start=c;else break;f++}}),this.fragmentTracker.removeFragmentsInRange(n,c,ue.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===ue.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===ue.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Y.STOPPED&&(this.state=Y.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(gl(this.levels,t)){this.levels=t.map(n=>new jn(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new jn(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ue.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(ml)}onSubtitleTrackLoaded(e,t){var n;const{details:i,id:s}=t,{currentTrackId:o,levels:a}=this;if(!a.length)return;const l=a[o];if(s>=a.length||s!==o||!l)return;this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(i.live||(n=l.details)!=null&&n.live){const d=this.mainDetails;if(i.deltaUpdateFailed||!d)return;const f=d.fragments[0];l.details?(c=this.alignPlaylists(i,l.details),c===0&&f&&(c=f.start,ki(i,c))):i.hasProgramDateTime&&d.hasProgramDateTime?(Wa(i,d),c=i.fragments[0].start):f&&(c=f.start,ki(i,c))}l.details=i,this.levelLastLoaded=s,!this.startFragRequested&&(this.mainDetails||!i.live)&&this.setStartPosition(l.details,c),this.tick(),i.live&&!this.fragCurrent&&this.media&&this.state===Y.IDLE&&(Hn(null,i.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i&&i.key&&i.iv&&i.method==="AES-128"){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(a=>{throw s.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();s.trigger(P.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=Y.IDLE})}}doTick(){if(!this.media){this.state=Y.IDLE;return}if(this.state===Y.IDLE){const{currentTrackId:e,levels:t}=this,n=t[e];if(!t.length||!n||!n.details)return;const i=n.details,s=i.targetduration,{config:o}=this,a=this.getLoadPosition(),l=Oe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a-s,o.maxBufferHole),{end:c,len:d}=l,f=this.getFwdBufferInfo(this.media,ue.MAIN),h=this.getMaxBufferLength(f==null?void 0:f.len)+s;if(d>h)return;const g=i.fragments,p=g.length,m=i.edge;let y=null;const E=this.fragPrevious;if(c<m){const{maxFragLookUpTolerance:A}=o;y=Hn(E,g,Math.max(g[0].start,c),A),!y&&E&&E.start<g[0].start&&(y=g[0])}else y=g[p-1];if(!y)return;y=this.mapToInitFragWhenRequired(y),this.fragmentTracker.getState(y)===Je.NOT_LOADED&&this.loadFragment(y,n,c)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new uE(this.tracksBuffered[this.currentTrackId]||[])}}class uE{constructor(e){this.buffered=void 0;const t=(n,i,s)=>{if(i=i>>>0,i>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class cE extends Pi{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.LEVEL_LOADING,this.onLevelLoading,this),e.on(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(P.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.LEVEL_LOADING,this.onLevelLoading,this),e.off(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(P.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Xi(this.media.textTracks).forEach(t=>{mn(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,details:i}=t,{trackId:s}=this,o=this.tracksInGroup[s];if(!o){this.warn(`Invalid subtitle track id ${n}`);return}const a=o.details;o.details=t.details,this.log(`subtitle track ${n} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.textGroupIds))return;const n=t.textGroupIds[t.urlId],i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==n){const s=this.tracks.filter(l=>!n||l.groupId===n);this.tracksInGroup=s;const o=this.findTrackId(i==null?void 0:i.name)||this.findTrackId();this.groupId=n||null;const a={subtitleTracks:s};this.log(`Updating subtitle tracks, ${s.length} track(s) found in "${n}" group-id`),this.hls.trigger(P.SUBTITLE_TRACKS_UPDATED,a),o!==-1&&this.setSubtitleTrack(o,i)}else this.shouldReloadPlaylist(i)&&this.setSubtitleTrack(this.trackId,i)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||e===i.name))return i.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Te.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,i=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(P.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:n}=this;if(!t)return;const i=Xi(t.textTracks),s=i.filter(a=>a.groupId===this.groupId);if(e===-1)[].slice.call(i).forEach(a=>{a.mode="disabled"});else{const a=s[n];a&&(a.mode="disabled")}const o=s[e];o&&(o.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var n;const i=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(e===-1||(n=i[e])!=null&&n.details)||e<-1||e>=i.length)return;this.clearTimer();const s=i[e];if(this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:"")),this.trackId=e,s){const{id:o,groupId:a="",name:l,type:c,url:d}=s;this.hls.trigger(P.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:c,url:d});const f=this.switchParams(s.url,t==null?void 0:t.details);this.loadPlaylist(f)}else this.hls.trigger(P.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=Xi(this.media.textTracks);for(let n=0;n<t.length;n++)if(t[n].mode==="hidden")e=n;else if(t[n].mode==="showing"){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}}function Xi(r){const e=[];for(let t=0;t<r.length;t++){const n=r[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(r[t])}return e}class dE{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const n=this.queues[t];n.push(e),n.length===1&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(s=>{t=s}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const{buffers:t,queues:n}=this,i=t[e],s=n[e];if(s.length){const o=s[0];try{o.execute()}catch(a){V.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),o.onError(a),i!=null&&i.updating||(s.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const yl=Ar(),El=/([ha]vc.)(?:\.[^.,]+)+/;class fE{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:t,mediaSource:n}=this;V.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(P.MEDIA_ATTACHED,{media:t})),n&&n.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{V.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{V.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:t,_objectUrl:n}=this;t&&t.src!==n&&V.error(`Media element src was set while attaching MediaSource (${n} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.BUFFER_RESET,this.onBufferReset,this),e.on(P.BUFFER_APPENDING,this.onBufferAppending,this),e.on(P.BUFFER_CODECS,this.onBufferCodecs,this),e.on(P.BUFFER_EOS,this.onBufferEos,this),e.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(P.FRAG_PARSED,this.onFragParsed,this),e.on(P.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.BUFFER_RESET,this.onBufferReset,this),e.off(P.BUFFER_APPENDING,this.onBufferAppending,this),e.off(P.BUFFER_CODECS,this.onBufferCodecs,this),e.off(P.BUFFER_EOS,this.onBufferEos,this),e.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(P.FRAG_PARSED,this.onFragParsed,this),e.off(P.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new dE(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,V.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media;if(n&&yl){const i=this.mediaSource=new yl;i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(i),this._objectUrl=n.src,n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(V.log("[buffer-controller]: media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(i){V.warn(`[buffer-controller]: onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):V.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(P.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(n){V.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,n)}}),this._initSourceBuffer()}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length;Object.keys(t).forEach(i=>{if(n){const s=this.tracks[i];if(s&&typeof s.buffer.changeType=="function"){const{id:o,codec:a,levelCodec:l,container:c,metadata:d}=t[i],f=(s.levelCodec||s.codec).replace(El,"$1"),h=(l||a).replace(El,"$1");if(f!==h){const g=`${c};codecs=${l||a}`;this.appendChangeType(i,g),V.log(`[buffer-controller]: switching codec ${f} to ${h}`),this.tracks[i]={buffer:s.buffer,codec:a,container:c,levelCodec:l,metadata:d,id:o}}}}else this.pendingTracks[i]=t[i]}),!n&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const s=this.sourceBuffer[e];s&&(V.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{V.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,s)}};n.append(i,e)}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:s}=this,{data:o,type:a,frag:l,part:c,chunkMeta:d}=t,f=d.buffering[a],h=self.performance.now();f.start=h;const g=l.stats.buffering,p=c?c.stats.buffering:null;g.start===0&&(g.start=h),p&&p.start===0&&(p.start=h);const m=s.audio;let y=!1;a==="audio"&&(m==null?void 0:m.container)==="audio/mpeg"&&(y=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const E=l.start,A={execute:()=>{if(f.executeStart=self.performance.now(),y){const _=this.sourceBuffer[a];if(_){const x=E-_.timestampOffset;Math.abs(x)>=.1&&(V.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${E} (delta: ${x}) sn: ${l.sn})`),_.timestampOffset=E)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const _=self.performance.now();f.executeEnd=f.end=_,g.first===0&&(g.first=_),p&&p.first===0&&(p.first=_);const{sourceBuffer:x}=this,v={};for(const T in x)v[T]=Oe.getBuffered(x[T]);this.appendError=0,this.hls.trigger(P.BUFFER_APPENDED,{type:a,frag:l,part:c,chunkMeta:d,parent:l.type,timeRanges:v})},onError:_=>{V.error(`[buffer-controller]: Error encountered while trying to append to the ${a} SourceBuffer`,_);const x={type:le.MEDIA_ERROR,parent:l.type,details:W.BUFFER_APPEND_ERROR,frag:l,part:c,chunkMeta:d,error:_,err:_,fatal:!1};_.code===DOMException.QUOTA_EXCEEDED_ERR?x.details=W.BUFFER_FULL_ERROR:(this.appendError++,x.details=W.BUFFER_APPEND_ERROR,this.appendError>n.config.appendErrorMaxRetry&&(V.error(`[buffer-controller]: Failed ${n.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),x.fatal=!0)),n.trigger(P.ERROR,x)}};i.append(A,a)}onBufferFlushing(e,t){const{operationQueue:n}=this,i=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(P.BUFFER_FLUSHED,{type:s})},onError:o=>{V.warn(`[buffer-controller]: Failed to remove from ${s} SourceBuffer`,o)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(i(s),s)})}onFragParsed(e,t){const{frag:n,part:i}=t,s=[],o=i?i.elementaryStreams:n.elementaryStreams;o[Le.AUDIOVIDEO]?s.push("audiovideo"):(o[Le.AUDIO]&&s.push("audio"),o[Le.VIDEO]&&s.push("video"));const a=()=>{const l=self.performance.now();n.stats.buffering.end=l,i&&(i.stats.buffering.end=l);const c=i?i.stats:n.stats;this.hls.trigger(P.FRAG_BUFFERED,{frag:n,part:i,stats:c,id:n.type})};s.length===0&&V.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,s)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((i,s)=>{const o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,V.log(`[buffer-controller]: ${s} sourceBuffer now EOS`))),i&&!!(!o||o.ended)},!0)&&(V.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const o=this.sourceBuffer[s];o&&(o.ending=!1)});const{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&V.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}V.log("[buffer-controller]: Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:n,sourceBuffer:i}=this;if(!n||t===null)return;const s=this.getSourceBufferTypes();if(!s.length)return;const o=t.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!oe(o)||o<0)return;const a=n.currentTime,l=t.levelTargetDuration,c=Math.max(o,l),d=Math.floor(a/l)*l-c;s.forEach(f=>{const h=i[f];if(h){const g=Oe.getBuffered(h);if(g.length>0&&d>g.start(0)){if(e.trigger(P.BACK_BUFFER_REACHED,{bufferEnd:d}),t.live)e.trigger(P.LIVE_BACK_BUFFER_REACHED,{bufferEnd:d});else if(h.ended&&g.end(g.length-1)-a<l*2){V.info(`[buffer-controller]: Cannot flush ${f} back buffer while SourceBuffer is in ended state`);return}e.trigger(P.BUFFER_FLUSHING,{startOffset:0,endOffset:d,type:f})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:i}=this,s=e.fragments[0].start+e.totalduration,o=n.duration,a=oe(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(V.log("[buffer-controller]: Media Source duration is set to Infinity"),i.duration=1/0,this.updateSeekableRange(e)):(s>a&&s>o||!oe(o))&&(V.log(`[buffer-controller]: Updating Media Source duration to ${s.toFixed(3)}`),i.duration=s)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,n[0].start),o=Math.max(s,s+e.totalduration);t.setLiveSeekableRange(s,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&!e||i===2){this.createSourceBuffers(n),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(P.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const i in e)if(!t[i]){const s=e[i];if(!s)throw Error(`source buffer exists for track ${i}, however track does not`);const o=s.levelCodec||s.codec,a=`${s.container};codecs=${o}`;V.log(`[buffer-controller]: creating sourceBuffer(${a})`);try{const l=t[i]=n.addSourceBuffer(a),c=i;this.addBufferListener(c,"updatestart",this._onSBUpdateStart),this.addBufferListener(c,"updateend",this._onSBUpdateEnd),this.addBufferListener(c,"error",this._onSBUpdateError),this.tracks[i]={buffer:l,codec:o,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(l){V.error(`[buffer-controller]: error while trying to add sourceBuffer: ${l.message}`),this.hls.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:l,mimeType:a})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const n=new Error(`${e} SourceBuffer error`);V.error(`[buffer-controller]: ${n}`,t),this.hls.trigger(P.ERROR,{type:le.MEDIA_ERROR,details:W.BUFFER_APPENDING_ERROR,error:n,fatal:!1});const i=this.operationQueue.current(e);i&&i.onError(t)}removeExecutor(e,t,n){const{media:i,mediaSource:s,operationQueue:o,sourceBuffer:a}=this,l=a[e];if(!i||!s||!l){V.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}const c=oe(i.duration)?i.duration:1/0,d=oe(s.duration)?s.duration:1/0,f=Math.max(0,t),h=Math.min(n,c,d);h>f&&!l.ending?(l.ended=!1,V.log(`[buffer-controller]: Removing [${f},${h}] from the ${e} SourceBuffer`),l.remove(f,h)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:n,sourceBuffer:i}=this,s=i[t];if(!s){V.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),n.shiftAndExecuteNext(t);return}s.ended=!1,s.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){V.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,i=t.map(s=>n.appendBlocker(s));Promise.all(i).then(()=>{e(),t.forEach(s=>{const o=this.sourceBuffer[s];o!=null&&o.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),i.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}const vl={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Al=function(e){let t=e;return vl.hasOwnProperty(e)&&(t=vl[e]),String.fromCharCode(t)},St=15,Mt=100,hE={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},pE={17:2,18:4,21:6,22:8,23:10,19:13,20:15},gE={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},mE={25:2,26:4,29:6,30:8,31:10,27:13,28:15},yE=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class EE{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;V.log(`${this.time} [${e}] ${n}`)}}}const tn=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class _l{constructor(e,t,n,i,s){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=i||"black",this.flash=s||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class vE{constructor(e,t,n,i,s,o){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new _l(t,n,i,s,o)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class AE{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<Mt;t++)this.chars.push(new vE);this.logger=e,this.pos=0,this.currPenState=new _l}equals(e){let t=!0;for(let n=0;n<Mt;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}copy(e){for(let t=0;t<Mt;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Mt;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Mt&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Mt)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Al(e);if(this.pos>=Mt){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Mt;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Mt;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class $i{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<St;t++)this.rows.push(new AE(e));this.logger=e,this.currRow=St-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<St;e++)this.rows[e].clear();this.currRow=St-1}equals(e){let t=!0;for(let n=0;n<St;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<St;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<St;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<St;a++)this.rows[a].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[s].cueStartTime,l=this.logger.time;if(a&&l!==null&&a<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(o.rows[s+c])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,o=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let s=0;s<St;s++){const o=this.rows[s].getTextString();o&&(i=s+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class xl{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new $i(n),this.nonDisplayedMemory=new $i(n),this.lastOutputScreen=new $i(n),this.currRollUpRow=this.displayedMemory.rows[St-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[St-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Sl{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const i=new EE;this.channels=[null,new xl(e,t,i),new xl(e+1,n,i)],this.cmdHistory=Il(),this.logger=i}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,i,s,o=!1;this.logger.time=e;for(let a=0;a<t.length;a+=2)if(i=t[a]&127,s=t[a+1]&127,!(i===0&&s===0)){if(this.logger.log(3,"["+tn([t[a],t[a+1]])+"] -> ("+tn([i,s])+")"),n=this.parseCmd(i,s),n||(n=this.parseMidrow(i,s)),n||(n=this.parsePAC(i,s)),n||(n=this.parseBackgroundAttributes(i,s)),!n&&(o=this.parseChars(i,s),o)){const l=this.currentChannel;l&&l>0?this.channels[l].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!n&&!o&&this.logger.log(2,"Couldn't parse cleaned data "+tn([i,s])+" orig: "+tn([t[a],t[a+1]]))}}parseCmd(e,t){const{cmdHistory:n}=this,i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(i||s))return!1;if(Tl(e,t,n))return An(null,null,n),this.logger.log(3,"Repeated command ("+tn([e,t])+") is dropped"),!0;const o=e===20||e===21||e===23?1:2,a=this.channels[o];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),An(e,t,n),this.currentChannel=o,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,"MIDROW ("+tn([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=this.cmdHistory,s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,o=(e===16||e===24)&&t>=64&&t<=95;if(!(s||o))return!1;if(Tl(e,t,i))return An(null,null,i),!0;const a=e<=23?1:2;t>=64&&t<=95?n=a===1?hE[e]:gE[e]:n=a===1?pE[e]:mE[e];const l=this.channels[a];return l?(l.setPAC(this.interpretPAC(n,t)),An(e,t,i),this.currentChannel=a,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,"Special char '"+Al(o)+"' in channel "+n),i=[o]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);if(i){const o=tn(i);this.logger.log(3,"Char codes =  "+o.join(",")),An(e,t,this.cmdHistory)}return i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let s;const o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=yE[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),An(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory=Il()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function An(r,e,t){t.a=r,t.b=e}function Tl(r,e,t){return t.a===r&&t.b===e}function Il(){return{a:null,b:null}}class Dr{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var es=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;const r=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const c=l.toLowerCase();return~a.indexOf(c)?c:!1}function n(a){return t(r,a)}function i(a){return t(e,a)}function s(a,...l){let c=1;for(;c<arguments.length;c++){const d=arguments[c];for(const f in d)a[f]=d[f]}return a}function o(a,l,c){const d=this,f={enumerable:!0};d.hasBeenReset=!1;let h="",g=!1,p=a,m=l,y=c,E=null,A="",_=!0,x="auto",v="start",T=50,C="middle",k=50,B="middle";Object.defineProperty(d,"id",s({},f,{get:function(){return h},set:function(R){h=""+R}})),Object.defineProperty(d,"pauseOnExit",s({},f,{get:function(){return g},set:function(R){g=!!R}})),Object.defineProperty(d,"startTime",s({},f,{get:function(){return p},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");p=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",s({},f,{get:function(){return m},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");m=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",s({},f,{get:function(){return y},set:function(R){y=""+R,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",s({},f,{get:function(){return E},set:function(R){E=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",s({},f,{get:function(){return A},set:function(R){const I=n(R);if(I===!1)throw new SyntaxError("An invalid or illegal string was specified.");A=I,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",s({},f,{get:function(){return _},set:function(R){_=!!R,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",s({},f,{get:function(){return x},set:function(R){if(typeof R!="number"&&R!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");x=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",s({},f,{get:function(){return v},set:function(R){const I=i(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");v=I,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",s({},f,{get:function(){return T},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");T=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",s({},f,{get:function(){return C},set:function(R){const I=i(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");C=I,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",s({},f,{get:function(){return k},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");k=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",s({},f,{get:function(){return B},set:function(R){const I=i(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");B=I,this.hasBeenReset=!0}})),d.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class _E{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function bl(r){function e(n,i,s,o){return(n|0)*3600+(i|0)*60+(s|0)+parseFloat(o||0)}const t=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class xE{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function Cl(r,e,t,n){const i=n?r.split(n):[r];for(const s in i){if(typeof i[s]!="string")continue;const o=i[s].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const ts=new es(0,0,""),Or=ts.align==="middle"?"middle":"center";function SE(r,e,t){const n=r;function i(){const a=bl(r);if(a===null)throw new Error("Malformed timestamp: "+n);return r=r.replace(/^[^\sa-zA-Z-]+/,""),a}function s(a,l){const c=new xE;Cl(a,function(h,g){let p;switch(h){case"region":for(let m=t.length-1;m>=0;m--)if(t[m].id===g){c.set(h,t[m].region);break}break;case"vertical":c.alt(h,g,["rl","lr"]);break;case"line":p=g.split(","),c.integer(h,p[0]),c.percent(h,p[0])&&c.set("snapToLines",!1),c.alt(h,p[0],["auto"]),p.length===2&&c.alt("lineAlign",p[1],["start",Or,"end"]);break;case"position":p=g.split(","),c.percent(h,p[0]),p.length===2&&c.alt("positionAlign",p[1],["start",Or,"end","line-left","line-right","auto"]);break;case"size":c.percent(h,g);break;case"align":c.alt(h,g,["start",Or,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let d=c.get("line","auto");d==="auto"&&ts.line===-1&&(d=-1),l.line=d,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",Or);let f=c.get("position","auto");f==="auto"&&ts.position===50&&(f=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=f}function o(){r=r.replace(/^\s+/,"")}if(o(),e.startTime=i(),o(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);r=r.slice(3),o(),e.endTime=i(),o(),s(r,e)}function Ll(r){return r.replace(/<br(?: \/)?>/gi,`
`)}class TE{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new _E,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,o=0;for(s=Ll(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;const a=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),a}function i(s){Cl(s,function(o,a){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const a=s.match(/^()?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=n(),t.state){case"HEADER":/:/.test(s)?i(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new es(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{SE(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=s.indexOf("-->")!==-1;if(!s||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const IE=/\r\n|\n\r|\n|\r/g,ns=function(e,t,n=0){return e.slice(n,n+t.length)===t},bE=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!oe(t)||!oe(n)||!oe(i)||!oe(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*s,t},rs=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function is(r,e,t){return rs(r.toString())+rs(e.toString())+rs(t)}const CE=function(e,t,n){let i=e[t],s=e[i.prevCC];if(!s||!s.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=i.start-s.start,i.new=!1,i=s,s=e[i.prevCC]}e.presentationOffset=n};function LE(r,e,t,n,i,s,o){const a=new TE,l=Lt(new Uint8Array(r)).trim().replace(IE,`
`).split(`
`),c=[],d=Uy(e.baseTime,e.timescale);let f="00:00.000",h=0,g=0,p,m=!0;a.oncue=function(y){const E=t[n];let A=t.ccOffset;const _=(h-d)/9e4;E!=null&&E.new&&(g!==void 0?A=t.ccOffset=E.start:CE(t,n,_)),_&&(A=_-t.presentationOffset);const x=y.endTime-y.startTime,v=gt((y.startTime+A-g)*9e4,i*9e4)/9e4;y.startTime=Math.max(v,0),y.endTime=Math.max(v+x,0);const T=y.text.trim();y.text=decodeURIComponent(encodeURIComponent(T)),y.id||(y.id=is(y.startTime,y.endTime,T)),y.endTime>0&&c.push(y)},a.onparsingerror=function(y){p=y},a.onflush=function(){if(p){o(p);return}s(c)},l.forEach(y=>{if(m)if(ns(y,"X-TIMESTAMP-MAP=")){m=!1,y.slice(16).split(",").forEach(E=>{ns(E,"LOCAL:")?f=E.slice(6):ns(E,"MPEGTS:")&&(h=parseInt(E.slice(7)))});try{g=bE(f)/1e3}catch(E){p=E}return}else y===""&&(m=!1);a.parse(y+`
`)}),a.flush()}const ss="stpp.ttml.im1t",Rl=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,wl=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,RE={left:"start",center:"center",right:"end",start:"start",end:"end"};function kl(r,e,t,n){const i=xe(new Uint8Array(r),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=i.map(a=>Lt(a)),o=Ny(e.baseTime,1,e.timescale);try{s.forEach(a=>t(wE(a,o)))}catch(a){n(a)}}function wE(r,e){const i=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((f,h)=>(f[h]=i.getAttribute(`ttp:${h}`)||s[h],f),{}),a=i.getAttribute("xml:space")!=="preserve",l=Dl(os(i,"styling","style")),c=Dl(os(i,"layout","region")),d=os(i,"body","[begin]");return[].map.call(d,f=>{const h=Ol(f,a);if(!h||!f.hasAttribute("begin"))return null;const g=ls(f.getAttribute("begin"),o),p=ls(f.getAttribute("dur"),o);let m=ls(f.getAttribute("end"),o);if(g===null)throw Pl(f);if(m===null){if(p===null)throw Pl(f);m=g+p}const y=new es(g-e,m-e,h);y.id=is(y.startTime,y.endTime,y.text);const E=c[f.getAttribute("region")],A=l[f.getAttribute("style")],_=kE(E,A,l),{textAlign:x}=_;if(x){const v=RE[x];v&&(y.lineAlign=v),y.align=x}return Ke(y,_),y}).filter(f=>f!==null)}function os(r,e,t){const n=r.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function Dl(r){return r.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function Ol(r,e){return[].slice.call(r.childNodes).reduce((t,n,i)=>{var s;return n.nodeName==="br"&&i?t+`
`:(s=n.childNodes)!=null&&s.length?Ol(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function kE(r,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(i=t[o]),s.reduce((a,l)=>{const c=as(e,n,l)||as(r,n,l)||as(i,n,l);return c&&(a[l]=c),a},{})}function as(r,e,t){return r&&r.hasAttributeNS(e,t)?r.getAttributeNS(e,t):null}function Pl(r){return new Error(`Could not parse ttml timestamp ${r}`)}function ls(r,e){if(!r)return null;let t=bl(r);return t===null&&(Rl.test(r)?t=DE(r,e):wl.test(r)&&(t=OE(r,e))),t}function DE(r,e){const t=Rl.exec(r),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function OE(r,e){const t=wl.exec(r),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class PE{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Bl(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const t=new Dr(this,"textTrack1"),n=new Dr(this,"textTrack2"),i=new Dr(this,"textTrack3"),s=new Dr(this,"textTrack4");this.cea608Parser1=new Sl(1,t,n),this.cea608Parser2=new Sl(3,i,s)}e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(P.FRAG_LOADING,this.onFragLoading,this),e.on(P.FRAG_LOADED,this.onFragLoaded,this),e.on(P.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(P.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(P.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(P.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(P.FRAG_LOADING,this.onFragLoading,this),e.off(P.FRAG_LOADED,this.onFragLoaded,this),e.off(P.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(P.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(P.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(P.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,n,i,s){let o=!1;for(let a=s.length;a--;){const l=s[a],c=ME(l[0],l[1],t,n);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),o=!0,c/(n-t)>.5))return}if(o||s.push([t,n]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,n,i)}else{const a=this.Cues.newCue(null,t,n,i);this.hls.trigger(P.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){const{unparsedVttFrags:o}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:i,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(P.FRAG_LOADED,a)}))}getExistingTrack(e){const{media:t}=this;if(t)for(let n=0;n<t.textTracks.length;n++){const i=t.textTracks[n];if(i[e])return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:s,languageCode:o}=t[e],a=this.getExistingTrack(e);if(a)n[e]=a,mn(n[e]),Ra(n[e],i);else{const l=this.createTextTrack("captions",s,o);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(P.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{mn(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Bl(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)mn(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(s=>s.textCodec===ss);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(gl(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media?this.media.textTracks:null;this.tracks.forEach((a,l)=>{let c;if(o&&l<o.length){let d=null;for(let f=0;f<o.length;f++)if(BE(o[f],a)){d=o[f];break}d&&(c=d)}if(c)mn(c);else{const d=this._captionsOrSubtitlesFromCharacteristics(a);c=this.createTextTrack(d,a.name,a.lang),c&&(c.mode="disabled")}c&&(c.groupId=a.groupId,this.textTracks.push(c))})}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(P.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),n=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&n)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const s=`textTrack${i[1]}`,o=this.captionsProperties[s];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:n,cea608Parser2:i,lastSn:s,lastPartIndex:o}=this;if(!(!this.enabled||!(n&&i))&&t.frag.type===ue.MAIN){var a,l;const c=t.frag.sn,d=(a=t==null||(l=t.part)==null?void 0:l.index)!=null?a:-1;c===s+1||c===s&&d===o+1||(n.reset(),i.reset()),this.lastSn=c,this.lastPartIndex=d}}onFragLoaded(e,t){const{frag:n,payload:i}=t,{initPTS:s,unparsedVttFrags:o}=this;if(n.type===ue.SUBTITLE)if(i.byteLength){if(!s[n.cc]){o.push(t),s.length&&this.hls.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Missing initial subtitle PTS")});return}const a=n.decryptdata,l="stats"in t;if(a==null||!a.encrypted||l){const c=this.tracks[n.level],d=this.vttCCs;d[n.cc]||(d[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),c&&c.textCodec===ss?this._parseIMSC1(n,i):this._parseVTTs(n,i,d)}}else this.hls.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;kl(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{V.log(`Failed to parse IMSC1: ${i}`),n.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e,t,n){var i;const s=this.hls,o=(i=e.initSegment)!=null&&i.data?en(e.initSegment.data,new Uint8Array(t)):t;LE(o,this.initPTS[e.cc],n,e.cc,e.start,a=>{this._appendCues(a,e.level),s.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},a=>{this._fallbackToIMSC1(e,t),V.log(`Failed to parse VTT cue: ${a}`),s.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:a})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||kl(t,this.initPTS[e.cc],()=>{n.textCodec=ss,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(s=>wa(i,s))}else{const i=this.tracks[t];if(!i)return;const s=i.default?"default":"subtitles"+t;n.trigger(P.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:n}=t;if(n.type===ue.SUBTITLE){if(!this.initPTS[n.cc]){this.unparsedVttFrags.push(t);return}this.onFragLoaded(P.FRAG_LOADED,t)}}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!(n&&i))return;const{frag:s,samples:o}=t;if(!(s.type===ue.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let a=0;a<o.length;a++){const l=o[a].bytes;if(l){const c=this.extractCea608Data(l);n.addData(o[a].pts,c[0]),i.addData(o[a].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:s}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!s||s==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>bi(a[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>bi(a[l],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let s=0;s<n;s++){const o=e[i++],a=127&e[i++],l=127&e[i++];if(a===0&&l===0)continue;if((4&o)!==0){const d=3&o;(d===0||d===1)&&(t[d].push(a),t[d].push(l))}}return t}}function BE(r,e){return!!r&&r.label===e.name&&!(r.textTrack1||r.textTrack2)}function ME(r,e,t,n){return Math.min(e,n)-Math.max(r,t)}function Bl(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class us{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(P.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.BUFFER_CODECS,this.onBufferCodecs,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(P.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.BUFFER_CODECS,this.onBufferCodecs,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,s)=>this.isLevelAllowed(i)&&s<=e);return this.clientRect=null,us.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(o,a)=>a?o.width!==a.width||o.height!==a.height:!0;let s=e.length-1;for(let o=0;o<e.length;o+=1){const a=e[o];if((a.width>=t||a.height>=n)&&i(a,e[o+1])){s=o;break}}return s}}class FE{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const s=i-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/s,c=this.hls;if(c.trigger(P.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*a){let d=c.currentLevel;V.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=d)&&(d=d-1,c.trigger(P.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Pr="[eme]";class _n{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=_n.CDMCleanupPromise?[_n.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=V.debug.bind(V,Pr),this.log=V.log.bind(V,Pr),this.warn=V.warn.bind(V,Pr),this.error=V.error.bind(V,Pr),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(P.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(P.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(P.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(P.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(P.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(P.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===Be.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,a,l)=>!!o&&l.indexOf(o)===a,i=t.map(o=>o.audioCodec).filter(n),s=t.map(o=>o.videoCodec).filter(n);return i.length+s.length===0&&s.push("avc1.42e01e"),new Promise((o,a)=>{const l=c=>{const d=c.shift();this.getMediaKeysPromise(d,i,s).then(f=>o({keySystem:d,mediaKeys:f})).catch(f=>{c.length?l(c):f instanceof mt?a(f):a(new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_ACCESS,error:f,fatal:!0},f.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return ra===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=Zg(e,t,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let o=s==null?void 0:s.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),o=this.requestMediaKeySystemAccess(e,i);const a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),o.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const c=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),a.mediaKeys=l.createMediaKeys().then(d=>(this.log(`Media-keys created for "${e}"`),c.then(f=>f?this.setMediaKeysServerCertificate(d,e,f):d))),a.mediaKeys.catch(d=>{this.error(`Failed to create media-keys for "${e}"}: ${d}`)}),a.mediaKeys})}return o.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Rt.hexDump(e.keyId||[])}`);const i=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Rt.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${Rt.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=vi(this.config),s=e.map(ea).filter(o=>!!o&&i.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:o})=>{const a=na(o);a?t(a):n(new Error(`Unable to find format for key-system "${o}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:a})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(o,a).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:o,mediaKeys:a,decryptdata:t}),c="cenc";return this.generateRequestWithPreferredKeySession(l,c,t.pssh,"playlist-key")}))),s.catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof mt?this.hls.trigger(P.ERROR,e.data):this.hls.trigger(P.ERROR,{type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=ea(e.keyFormat),s=i?[i]:vi(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=vi(this.config)),e.length===0)throw new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),n===null)return;let i,s;if(t==="sinf"&&this.config.drmSystems[Be.FAIRPLAY]){const d=Qe(new Uint8Array(n));try{const f=Ei(JSON.parse(d).sinf),h=da(new Uint8Array(f));if(!h)return;i=h.subarray(8,24),s=Be.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const d=_m(n);if(d===null)return;d.version===0&&d.systemId===ta.WIDEVINE&&d.data&&(i=d.data.subarray(8,24)),s=qg(d.systemId)}if(!s||!i)return;const o=Rt.hexDump(i),{keyIdToKeySessionPromise:a,mediaKeySessions:l}=this;let c=a[o];for(let d=0;d<l.length;d++){const f=l[d],h=f.decryptdata;if(h.pssh||!h.keyId)continue;const g=Rt.hexDump(h.keyId);if(o===g||h.uri.replace(/-/g,"").indexOf(o)!==-1){c=a[g],delete a[g],h.pssh=new Uint8Array(n),h.keyId=i,c=a[o]=c.then(()=>this.generateRequestWithPreferredKeySession(f,t,n,"encrypted-event-key-match"));break}}c||(c=a[o]=this.getKeySystemSelectionPromise([s]).then(({keySystem:d,mediaKeys:f})=>{var h;this.throwIfDestroyed();const g=new Kn("ISO-23001-7",o,(h=na(d))!=null?h:"");return g.pssh=new Uint8Array(n),g.keyId=i,this.attemptSetMediaKeys(d,f).then(()=>{this.throwIfDestroyed();const p=this.createMediaKeySessionContext({decryptdata:g,keySystem:d,mediaKeys:f});return this.generateRequestWithPreferredKeySession(p,t,n,"encrypted-event-no-match")})})),c.catch(d=>this.handleError(d))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var s,o;const a=(s=this.config.drmSystems)==null||(o=s[e.keySystem])==null?void 0:o.generateRequest;if(a)try{const h=a.call(this.hls,t,n,e);if(!h)throw new Error("Invalid response from configured generateRequest filter");t=h.initDataType,n=e.decryptdata.pssh=h.initData?new Uint8Array(h.initData):null}catch(h){var l;if(this.warn(h.message),(l=this.hls)!=null&&l.config.debug)throw h}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);const d=new zi;e.mediaKeysSession.onmessage=h=>{const g=e.mediaKeysSession;if(!g){d.emit("error",new Error("invalid state"));return}const{messageType:p,message:m}=h;this.log(`"${p}" message event for session "${g.sessionId}" message size: ${m.byteLength}`),p==="license-request"||p==="license-renewal"?this.renewLicense(e,m).catch(y=>{this.handleError(y),d.emit("error",y)}):p==="license-release"?e.keySystem===Be.FAIRPLAY&&(this.updateKeySession(e,$o("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${p}"`)},e.mediaKeysSession.onkeystatuseschange=h=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const p=e.keyStatus;d.emit("keyStatus",p),p==="expired"&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};const f=new Promise((h,g)=>{d.on("error",g),d.on("keyStatus",p=>{p.startsWith("usable")?h():p==="output-restricted"?g(new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):p==="internal-error"?g(new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${p}"`)):p==="expired"?g(new Error("key expired while generating request")):this.warn(`unhandled key status change "${p}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var h;this.log(`Request generated for key-session "${(h=e.mediaKeysSession)==null?void 0:h.sessionId}" keyId: ${c}`)}).catch(h=>{throw new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_SESSION,error:h,fatal:!1},`Error generating key-session request: ${h}`)}).then(()=>f).catch(h=>{throw d.removeAllListeners(),this.removeSession(e),h}).then(()=>(d.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Rt.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Rt.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:s},c=t.certLoadPolicy.default,d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(h,g,p,m)=>{o(h.data)},onError:(h,g,p,m)=>{a(new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:nt({url:l.url,data:void 0},h)},`"${e}" certificate request failed (${s}). Status: ${h.code} (${h.text})`))},onTimeout:(h,g,p)=>{a(new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(h,g,p)=>{a(new Error("aborted"))}};i.load(l,d,f)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,s)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(o=>{s(new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}setupLicenseXHR(e,t,n,i){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,i)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),s.call(this.hls,e,t,n,i)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,s)=>{const o=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,a,o,e)}catch(d){this.error(d)}i(l)}else{const l=n.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||a.status>=400&&a.status<500)s(new mt({type:le.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const d=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${d} attempts left`),this.requestLicense(e,t).then(i,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:c})=>{l.send(c)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Kn.clearKeyUriToKeyIdMap();const n=t.length;_n.CDMCleanupPromise=Promise.all(t.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}. media.src: ${e==null?void 0:e.src}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}. media.src: ${e==null?void 0:e.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,s)=>(i.indexOf(s.keyFormat)===-1&&i.push(s.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}_n.CDMCleanupPromise=void 0;class mt extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}const NE=1;var at={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"};const UE="h";class Wt{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:at.MANIFEST,su:!this.initialized})}catch(s){V.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=i=>{try{const s=i.frag,o=this.hls.levels[s.level],a=this.getObjectType(s),l={d:s.duration*1e3,ot:a};(a===at.VIDEO||a===at.AUDIO||a==at.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(a)/1e3,l.bl=this.getBufferLength(a)),this.apply(i,l)}catch(s){V.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||Wt.uuid(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.registerListeners())}registerListeners(){const e=this.hls;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHED,this.onMediaDetached,this),e.on(P.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHED,this.onMediaDetached,this),e.off(P.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:NE,sf:UE,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ke(t,this.createData());const n=t.ot===at.INIT||t.ot===at.VIDEO||t.ot===at.MUXED;if(this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering),this.useHeaders){const i=Wt.toHeaders(t);if(!Object.keys(i).length)return;e.headers||(e.headers={}),Ke(e.headers,i)}else{const i=Wt.toQuery(t);if(!i)return;e.url=Wt.appendQueryToUri(e.url,i)}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return at.TIMED_TEXT;if(e.sn==="initSegment")return at.INIT;if(t==="audio")return at.AUDIO;if(t==="main")return this.hls.audioTracks.length?at.VIDEO:at.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===at.AUDIO)n=i.audioTracks;else{const s=i.maxAutoLevel,o=s>-1?s+1:i.levels.length;n=i.levels.slice(0,o)}for(const s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===at.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Oe.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],n=c=>!Number.isNaN(c)&&c!=null&&c!==""&&c!==!1,i=c=>Math.round(c),s=c=>i(c/100)*100,a={br:i,d:i,bl:s,dl:s,mtp:s,nor:c=>encodeURIComponent(c),rtp:s,tb:i},l=Object.keys(e||{}).sort();for(const c of l){let d=e[c];if(!n(d)||c==="v"&&d===1||c=="pr"&&d===1)continue;const f=a[c];f&&(d=f(d));const h=typeof d;let g;c==="ot"||c==="sf"||c==="st"?g=`${c}=${d}`:h==="boolean"?g=c:h==="number"?g=`${c}=${d}`:g=`${c}=${JSON.stringify(d)}`,t.push(g)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),n={},i=["Object","Request","Session","Status"],s=[{},{},{},{}],o={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const a of t){const l=o[a]!=null?o[a]:1;s[l][a]=e[a]}for(let a=0;a<s.length;a++){const l=Wt.serialize(s[a]);l&&(n[`CMCD-${i[a]}`]=l)}return n}static toQuery(e){return`CMCD=${encodeURIComponent(Wt.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const n=e.includes("?")?"&":"?";return`${e}${n}${t}`}}const VE=3e5;class KE{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=V.log.bind(V,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===st.SendAlternateToPenaltyBox&&n.flags===xt.MoveAllAlternatesMatchingHost){let i=this.pathwayPriority;const s=this.pathwayId;this.penalizedPathways[s]||(this.penalizedPathways[s]=performance.now()),!i&&this.levels&&(i=this.levels.reduce((o,a)=>(o.indexOf(a.pathwayId)===-1&&o.push(a.pathwayId),o),[])),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==s)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(s=>{i-n[s]>VE&&delete n[s]});for(let s=0;s<e.length;s++){const o=e[s];if(n[o])continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,this.hls.trigger(P.LEVELS_UPDATED,{levels:t});const c=this.hls.levels[a];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=a);break}}}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(s=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=s;if(t.some(d=>d.pathwayId===o))return;const c=this.getLevelsForPathway(a).map(d=>{const f=Ke({},d);f.details=void 0,f.url=Fl(d.uri,d.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l);const h=new Pe(d.attrs);h["PATHWAY-ID"]=o;const g=h.AUDIO&&`${h.AUDIO}_clone_${o}`,p=h.SUBTITLES&&`${h.SUBTITLES}_clone_${o}`;g&&(n[h.AUDIO]=g,h.AUDIO=g),p&&(i[h.SUBTITLES]=p,h.SUBTITLES=p),f.attrs=h;const m=new jn(f);return Tr(m,"audio",g),Tr(m,"text",p),m});t.push(...c),Ml(this.audioTracks,n,l,o),Ml(this.subtitleTracks,i,l,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const d=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+d)}const s={responseType:"json",url:i.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},c={onSuccess:(d,f,h,g)=>{this.log(`Loaded steering manifest: "${i}"`);const p=d.data;if(p.VERSION!==1){this.log(`Steering VERSION ${p.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=p.TTL;const{"RELOAD-URI":m,"PATHWAY-CLONES":y,"PATHWAY-PRIORITY":E}=p;if(m)try{this.uri=new self.URL(m,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${m}`);return}this.scheduleRefresh(this.uri||h.url),y&&this.clonePathways(y),E&&this.updatePathwayPriority(E)},onError:(d,f,h,g)=>{if(this.log(`Error loading steering manifest: ${d.code} ${d.text} (${f.url})`),this.stopLoad(),d.code===410){this.enabled=!1,this.log(`Steering manifest ${f.url} no longer available`);return}let p=this.timeToLoad*1e3;if(d.code===429){const m=this.loader;if(typeof(m==null?void 0:m.getResponseHeader)=="function"){const y=m.getResponseHeader("Retry-After");y&&(p=parseFloat(y)*1e3)}this.log(`Steering manifest ${f.url} rate limited`);return}this.scheduleRefresh(this.uri||f.url,p)},onTimeout:(d,f,h)=>{this.log(`Timeout loading steering manifest (${f.url})`),this.scheduleRefresh(this.uri||f.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(s,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}function Ml(r,e,t,n){r&&Object.keys(e).forEach(i=>{const s=r.filter(o=>o.groupId===i).map(o=>{const a=Ke({},o);return a.details=void 0,a.attrs=new Pe(a.attrs),a.url=a.attrs.URI=Fl(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[i],a.attrs["PATHWAY-ID"]=n,a});r.push(...s)})}function Fl(r,e,t,n){const{HOST:i,PARAMS:s,[t]:o}=n;let a;e&&(a=o==null?void 0:o[e],a&&(r=a));const l=new self.URL(r);return i&&!a&&(l.host=i),s&&Object.keys(s).sort().forEach(c=>{c&&l.searchParams.set(c,s[c])}),l.href}const GE=/^age:\s*[\d.]+\s*$/im;class Nl{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new gr,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!this.stats.aborted)return s(n,t.url)}).catch(o=>(n.open("GET",t.url,!0),s(n,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{this.callbacks.onError({code:n.status,text:o.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=this.context.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=n.loadPolicy;if(i)for(const a in i)e.setRequestHeader(a,i[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&oe(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,s=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,a=t.responseType!=="text";if(o>=200&&o<300&&(a&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=a?t.response:t.responseText,c=t.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=c,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const d=this.callbacks.onProgress;if(d&&d(n,e,l,t),!this.callbacks)return;const f={url:t.responseURL,data:l,code:o};this.callbacks.onSuccess(f,n,e,t)}else{const l=s.loadPolicy.errorRetry,c=n.retry;Sr(l,c,!1,o)?this.retry(l):(V.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,n))}}}loadtimeout(){var e;const t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,n=this.stats.retry;if(Sr(t,n,!0))this.retry(t);else{V.warn(`timeout while loading ${this.context.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Di(e,n.retry),n.retry++,V.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&GE.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function jE(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const HE=/(\d+)-(\d+)\/(\d+)/;class Ul{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||YE,this.controller=new self.AbortController,this.stats=new gr}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;e!=null&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const s=WE(e,this.controller.signal),o=n.onProgress,a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:c,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=c&&oe(c)?c:d,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(f=>{this.response=this.loader=f;const h=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},d-(h-i.loading.start)),!f.ok){const{status:g,statusText:p}=f;throw new zE(p||"fetch, bad network response",g,f)}return i.loading.first=h,i.total=JE(f.headers)||i.total,o&&oe(t.highWaterMark)?this.loadProgressively(f,i,e,t.highWaterMark,o):a?f.arrayBuffer():e.responseType==="json"?f.json():f.text()}).then(f=>{const{response:h}=this;self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const g=f[l];g&&(i.loaded=i.total=g);const p={url:h.url,data:f,code:h.status};o&&!oe(t.highWaterMark)&&o(i,e,f,h),n.onSuccess(p,i,e,h)}).catch(f=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const h=f&&f.code||0,g=f?f.message:null;n.onError({code:h,text:g},e,f?f.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,s){const o=new hl,a=e.body.getReader(),l=()=>a.read().then(c=>{if(c.done)return o.dataLength&&s(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const d=c.value,f=d.length;return t.loaded+=f,f<i||o.dataLength?(o.push(d),o.dataLength>=i&&s(t,n,o.flush(),e)):s(t,n,d,e),l()}).catch(()=>Promise.reject());return l()}}function WE(r,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ke({},r.headers))};return r.rangeEnd&&t.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),t}function QE(r){const e=HE.exec(r);if(e)return parseInt(e[2])-parseInt(e[1])+1}function JE(r){const e=r.get("Content-Range");if(e){const n=QE(e);if(oe(n))return n}const t=r.get("Content-Length");if(t)return parseInt(t)}function YE(r,e){return new self.Request(r.url,e)}class zE extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const qE=/\s/,ZE={newCue(r,e,t,n){const i=[];let s,o,a,l,c;const d=self.VTTCue||self.TextTrackCue;for(let h=0;h<n.rows.length;h++)if(s=n.rows[h],a=!0,l=0,c="",!s.isEmpty()){var f;for(let m=0;m<s.chars.length;m++)qE.test(s.chars[m].uchar)&&a?l++:(c+=s.chars[m].uchar,a=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const g=Ll(c.trim()),p=is(e,t,g);r!=null&&(f=r.cues)!=null&&f.getCueById(p)||(o=new d(e,t,g),o.id=p,o.line=h+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(o))}return r&&i.length&&(i.sort((h,g)=>h.line==="auto"||g.line==="auto"?0:h.line>8&&g.line>8?g.line-h.line:h.line-g.line),i.forEach(h=>wa(r,h))),i}},XE={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},$E=nt(nt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Nl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:rE,bufferController:fE,capLevelController:us,errorController:zm,fpsController:FE,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:ra,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:XE},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},ev()),{},{subtitleStreamController:lE,subtitleTrackController:cE,timelineController:PE,audioStreamController:sE,audioTrackController:oE,emeController:_n,cmcdController:Wt,contentSteeringController:KE});function ev(){return{cueHandler:ZE,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function tv(r,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=cs(r),n=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{const o=`${s==="level"?"playlist":s}LoadPolicy`,a=e[o]===void 0,l=[];i.forEach(c=>{const d=`${s}Loading${c}`,f=e[d];if(f!==void 0&&a){l.push(d);const h=t[o].default;switch(e[o]={default:h},c){case"TimeOut":h.maxLoadTimeMs=f,h.maxTimeToFirstByteMs=f;break;case"MaxRetry":h.errorRetry.maxNumRetry=f,h.timeoutRetry.maxNumRetry=f;break;case"RetryDelay":h.errorRetry.retryDelayMs=f,h.timeoutRetry.retryDelayMs=f;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=f,h.timeoutRetry.maxRetryDelayMs=f;break}}}),l.length&&V.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),nt(nt({},t),e)}function cs(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(cs):Object.keys(r).reduce((e,t)=>(e[t]=cs(r[t]),e),{}):r}function nv(r){const e=r.loader;e!==Ul&&e!==Nl?(V.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):jE()&&(r.loader=Ul,r.progressive=!0,r.enableSoftwareAES=!0,V.log("[config]: Progressive streaming enabled, using FetchLoader"))}class Ge{static get version(){return"1.4.3"}static isSupported(){return py()}static get Events(){return P}static get ErrorTypes(){return le}static get ErrorDetails(){return W}static get DefaultConfig(){return Ge.defaultConfig?Ge.defaultConfig:$E}static set DefaultConfig(e){Ge.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new zi,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,Vg(e.debug||!1,"Hls instance");const t=this.config=tv(Ge.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&nv(t);const{abrController:n,bufferController:i,capLevelController:s,errorController:o,fpsController:a}=t,l=new o(this),c=this.abrController=new n(this),d=this.bufferController=new i(this),f=this.capLevelController=new s(this),h=new a(this),g=new wm(this),p=new Bm(this),m=t.contentSteeringController,y=m?new m(this):null,E=this.levelController=new Zm(this,y),A=new Xm(this),_=new ey(this.config),x=this.streamController=new tE(this,A,_);f.setStreamController(x),h.setStreamController(x);const v=[g,E,x];y&&v.splice(1,0,y),this.networkControllers=v;const T=[c,d,f,h,p,A];this.audioTrackController=this.createController(t.audioTrackController,v);const C=t.audioStreamController;C&&v.push(new C(this,A,_)),this.subtitleTrackController=this.createController(t.subtitleTrackController,v);const k=t.subtitleStreamController;k&&v.push(new k(this,A,_)),this.createController(t.timelineController,T),_.emeController=this.emeController=this.createController(t.emeController,T),this.cmcdController=this.createController(t.cmcdController,T),this.latencyController=this.createController(Mm,T),this.coreComponents=T,v.push(l);const B=l.onErrorOut;typeof B=="function"&&this.on(P.ERROR,B,l)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){V.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),this.trigger(P.ERROR,{type:le.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,fatal:!1,event:e,error:n})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){V.log("destroy"),this.trigger(P.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){V.log("attachMedia"),this._media=e,this.trigger(P.MEDIA_ATTACHING,{media:e})}detachMedia(){V.log("detachMedia"),this.trigger(P.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=gi.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});V.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(P.MANIFEST_LOADING,{url:e})}startLoad(e=-1){V.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){V.log("stopLoad"),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){V.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){V.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){V.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){V.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){V.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){V.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){V.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(V.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Ri.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e&&e.length?i=e.length-1:i=t,n)for(let s=i;s--;){const o=e[s].attrs["HDCP-LEVEL"];if(o&&o<=n)return s}return i}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Ge.defaultConfig=void 0;var Vl={exports:{}};(function(r,e){(function(n,i){r.exports=i()})(self,function(){return function(){var t={"./node_modules/es6-promise/dist/es6-promise.js":function(o,a,l){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(c,d){o.exports=d()})(this,function(){function c(Q){var q=typeof Q;return Q!==null&&(q==="object"||q==="function")}function d(Q){return typeof Q=="function"}var f=void 0;Array.isArray?f=Array.isArray:f=function(Q){return Object.prototype.toString.call(Q)==="[object Array]"};var h=f,g=0,p=void 0,m=void 0,y=function(q,$){L[g]=q,L[g+1]=$,g+=2,g===2&&(m?m(b):M())};function E(Q){m=Q}function A(Q){y=Q}var _=typeof window<"u"?window:void 0,x=_||{},v=x.MutationObserver||x.WebKitMutationObserver,T=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",C=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function k(){return function(){return process.nextTick(b)}}function B(){return typeof p<"u"?function(){p(b)}:S()}function R(){var Q=0,q=new v(b),$=document.createTextNode("");return q.observe($,{characterData:!0}),function(){$.data=Q=++Q%2}}function I(){var Q=new MessageChannel;return Q.port1.onmessage=b,function(){return Q.port2.postMessage(0)}}function S(){var Q=setTimeout;return function(){return Q(b,1)}}var L=new Array(1e3);function b(){for(var Q=0;Q<g;Q+=2){var q=L[Q],$=L[Q+1];q($),L[Q]=void 0,L[Q+1]=void 0}g=0}function w(){try{var Q=Function("return this")().require("vertx");return p=Q.runOnLoop||Q.runOnContext,B()}catch{return S()}}var M=void 0;T?M=k():v?M=R():C?M=I():_===void 0?M=w():M=S();function O(Q,q){var $=this,ie=new this.constructor(U);ie[F]===void 0&&ve(ie);var fe=$._state;if(fe){var me=arguments[fe-1];y(function(){return ke(fe,ie,me,$._result)})}else he($,ie,Q,q);return ie}function D(Q){var q=this;if(Q&&typeof Q=="object"&&Q.constructor===q)return Q;var $=new q(U);return re($,Q),$}var F=Math.random().toString(36).substring(2);function U(){}var K=void 0,N=1,G=2;function H(){return new TypeError("You cannot resolve a promise with itself")}function Z(){return new TypeError("A promises callback cannot return that same promise.")}function J(Q,q,$,ie){try{Q.call(q,$,ie)}catch(fe){return fe}}function X(Q,q,$){y(function(ie){var fe=!1,me=J($,q,function(Ve){fe||(fe=!0,q!==Ve?re(ie,Ve):se(ie,Ve))},function(Ve){fe||(fe=!0,ee(ie,Ve))},"Settle: "+(ie._label||" unknown promise"));!fe&&me&&(fe=!0,ee(ie,me))},Q)}function ne(Q,q){q._state===N?se(Q,q._result):q._state===G?ee(Q,q._result):he(q,void 0,function($){return re(Q,$)},function($){return ee(Q,$)})}function ce(Q,q,$){q.constructor===Q.constructor&&$===O&&q.constructor.resolve===D?ne(Q,q):$===void 0?se(Q,q):d($)?X(Q,q,$):se(Q,q)}function re(Q,q){if(Q===q)ee(Q,H());else if(c(q)){var $=void 0;try{$=q.then}catch(ie){ee(Q,ie);return}ce(Q,q,$)}else se(Q,q)}function Ee(Q){Q._onerror&&Q._onerror(Q._result),_e(Q)}function se(Q,q){Q._state===K&&(Q._result=q,Q._state=N,Q._subscribers.length!==0&&y(_e,Q))}function ee(Q,q){Q._state===K&&(Q._state=G,Q._result=q,y(Ee,Q))}function he(Q,q,$,ie){var fe=Q._subscribers,me=fe.length;Q._onerror=null,fe[me]=q,fe[me+N]=$,fe[me+G]=ie,me===0&&Q._state&&y(_e,Q)}function _e(Q){var q=Q._subscribers,$=Q._state;if(q.length!==0){for(var ie=void 0,fe=void 0,me=Q._result,Ve=0;Ve<q.length;Ve+=3)ie=q[Ve],fe=q[Ve+$],ie?ke($,ie,fe,me):fe(me);Q._subscribers.length=0}}function ke(Q,q,$,ie){var fe=d($),me=void 0,Ve=void 0,Ft=!0;if(fe){try{me=$(ie)}catch(Sn){Ft=!1,Ve=Sn}if(q===me){ee(q,Z());return}}else me=ie;q._state!==K||(fe&&Ft?re(q,me):Ft===!1?ee(q,Ve):Q===N?se(q,me):Q===G&&ee(q,me))}function De(Q,q){try{q(function(ie){re(Q,ie)},function(ie){ee(Q,ie)})}catch($){ee(Q,$)}}var we=0;function Ie(){return we++}function ve(Q){Q[F]=we++,Q._state=void 0,Q._result=void 0,Q._subscribers=[]}function Ce(){return new Error("Array Methods must be provided an Array")}var Re=function(){function Q(q,$){this._instanceConstructor=q,this.promise=new q(U),this.promise[F]||ve(this.promise),h($)?(this.length=$.length,this._remaining=$.length,this._result=new Array(this.length),this.length===0?se(this.promise,this._result):(this.length=this.length||0,this._enumerate($),this._remaining===0&&se(this.promise,this._result))):ee(this.promise,Ce())}return Q.prototype._enumerate=function($){for(var ie=0;this._state===K&&ie<$.length;ie++)this._eachEntry($[ie],ie)},Q.prototype._eachEntry=function($,ie){var fe=this._instanceConstructor,me=fe.resolve;if(me===D){var Ve=void 0,Ft=void 0,Sn=!1;try{Ve=$.then}catch(nn){Sn=!0,Ft=nn}if(Ve===O&&$._state!==K)this._settledAt($._state,ie,$._result);else if(typeof Ve!="function")this._remaining--,this._result[ie]=$;else if(fe===Fe){var Tn=new fe(U);Sn?ee(Tn,Ft):ce(Tn,$,Ve),this._willSettleAt(Tn,ie)}else this._willSettleAt(new fe(function(nn){return nn($)}),ie)}else this._willSettleAt(me($),ie)},Q.prototype._settledAt=function($,ie,fe){var me=this.promise;me._state===K&&(this._remaining--,$===G?ee(me,fe):this._result[ie]=fe),this._remaining===0&&se(me,this._result)},Q.prototype._willSettleAt=function($,ie){var fe=this;he($,void 0,function(me){return fe._settledAt(N,ie,me)},function(me){return fe._settledAt(G,ie,me)})},Q}();function je(Q){return new Re(this,Q).promise}function z(Q){var q=this;return h(Q)?new q(function($,ie){for(var fe=Q.length,me=0;me<fe;me++)q.resolve(Q[me]).then($,ie)}):new q(function($,ie){return ie(new TypeError("You must pass an array to race."))})}function Ae(Q){var q=this,$=new q(U);return ee($,Q),$}function Me(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Ze(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Fe=function(){function Q(q){this[F]=Ie(),this._result=this._state=void 0,this._subscribers=[],U!==q&&(typeof q!="function"&&Me(),this instanceof Q?De(this,q):Ze())}return Q.prototype.catch=function($){return this.then(null,$)},Q.prototype.finally=function($){var ie=this,fe=ie.constructor;return d($)?ie.then(function(me){return fe.resolve($()).then(function(){return me})},function(me){return fe.resolve($()).then(function(){throw me})}):ie.then($,$)},Q}();Fe.prototype.then=O,Fe.all=je,Fe.race=z,Fe.resolve=D,Fe.reject=Ae,Fe._setScheduler=E,Fe._setAsap=A,Fe._asap=y;function ds(){var Q=void 0;if(typeof l.g<"u")Q=l.g;else if(typeof self<"u")Q=self;else try{Q=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var q=Q.Promise;if(q){var $=null;try{$=Object.prototype.toString.call(q.resolve())}catch{}if($==="[object Promise]"&&!q.cast)return}Q.Promise=Fe}return Fe.polyfill=ds,Fe.Promise=Fe,Fe})},"./node_modules/events/events.js":function(o){var a=typeof Reflect=="object"?Reflect:null,l=a&&typeof a.apply=="function"?a.apply:function(S,L,b){return Function.prototype.apply.call(S,L,b)},c;a&&typeof a.ownKeys=="function"?c=a.ownKeys:Object.getOwnPropertySymbols?c=function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:c=function(S){return Object.getOwnPropertyNames(S)};function d(I){console&&console.warn&&console.warn(I)}var f=Number.isNaN||function(S){return S!==S};function h(){h.init.call(this)}o.exports=h,o.exports.once=k,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var g=10;function p(I){if(typeof I!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof I)}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(I){if(typeof I!="number"||I<0||f(I))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+I+".");g=I}}),h.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(S){if(typeof S!="number"||S<0||f(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this};function m(I){return I._maxListeners===void 0?h.defaultMaxListeners:I._maxListeners}h.prototype.getMaxListeners=function(){return m(this)},h.prototype.emit=function(S){for(var L=[],b=1;b<arguments.length;b++)L.push(arguments[b]);var w=S==="error",M=this._events;if(M!==void 0)w=w&&M.error===void 0;else if(!w)return!1;if(w){var O;if(L.length>0&&(O=L[0]),O instanceof Error)throw O;var D=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw D.context=O,D}var F=M[S];if(F===void 0)return!1;if(typeof F=="function")l(F,this,L);else for(var U=F.length,K=v(F,U),b=0;b<U;++b)l(K[b],this,L);return!0};function y(I,S,L,b){var w,M,O;if(p(L),M=I._events,M===void 0?(M=I._events=Object.create(null),I._eventsCount=0):(M.newListener!==void 0&&(I.emit("newListener",S,L.listener?L.listener:L),M=I._events),O=M[S]),O===void 0)O=M[S]=L,++I._eventsCount;else if(typeof O=="function"?O=M[S]=b?[L,O]:[O,L]:b?O.unshift(L):O.push(L),w=m(I),w>0&&O.length>w&&!O.warned){O.warned=!0;var D=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");D.name="MaxListenersExceededWarning",D.emitter=I,D.type=S,D.count=O.length,d(D)}return I}h.prototype.addListener=function(S,L){return y(this,S,L,!1)},h.prototype.on=h.prototype.addListener,h.prototype.prependListener=function(S,L){return y(this,S,L,!0)};function E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function A(I,S,L){var b={fired:!1,wrapFn:void 0,target:I,type:S,listener:L},w=E.bind(b);return w.listener=L,b.wrapFn=w,w}h.prototype.once=function(S,L){return p(L),this.on(S,A(this,S,L)),this},h.prototype.prependOnceListener=function(S,L){return p(L),this.prependListener(S,A(this,S,L)),this},h.prototype.removeListener=function(S,L){var b,w,M,O,D;if(p(L),w=this._events,w===void 0)return this;if(b=w[S],b===void 0)return this;if(b===L||b.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete w[S],w.removeListener&&this.emit("removeListener",S,b.listener||L));else if(typeof b!="function"){for(M=-1,O=b.length-1;O>=0;O--)if(b[O]===L||b[O].listener===L){D=b[O].listener,M=O;break}if(M<0)return this;M===0?b.shift():T(b,M),b.length===1&&(w[S]=b[0]),w.removeListener!==void 0&&this.emit("removeListener",S,D||L)}return this},h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=function(S){var L,b,w;if(b=this._events,b===void 0)return this;if(b.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):b[S]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete b[S]),this;if(arguments.length===0){var M=Object.keys(b),O;for(w=0;w<M.length;++w)O=M[w],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=b[S],typeof L=="function")this.removeListener(S,L);else if(L!==void 0)for(w=L.length-1;w>=0;w--)this.removeListener(S,L[w]);return this};function _(I,S,L){var b=I._events;if(b===void 0)return[];var w=b[S];return w===void 0?[]:typeof w=="function"?L?[w.listener||w]:[w]:L?C(w):v(w,w.length)}h.prototype.listeners=function(S){return _(this,S,!0)},h.prototype.rawListeners=function(S){return _(this,S,!1)},h.listenerCount=function(I,S){return typeof I.listenerCount=="function"?I.listenerCount(S):x.call(I,S)},h.prototype.listenerCount=x;function x(I){var S=this._events;if(S!==void 0){var L=S[I];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}h.prototype.eventNames=function(){return this._eventsCount>0?c(this._events):[]};function v(I,S){for(var L=new Array(S),b=0;b<S;++b)L[b]=I[b];return L}function T(I,S){for(;S+1<I.length;S++)I[S]=I[S+1];I.pop()}function C(I){for(var S=new Array(I.length),L=0;L<S.length;++L)S[L]=I[L].listener||I[L];return S}function k(I,S){return new Promise(function(L,b){function w(O){I.removeListener(S,M),b(O)}function M(){typeof I.removeListener=="function"&&I.removeListener("error",w),L([].slice.call(arguments))}R(I,S,M,{once:!0}),S!=="error"&&B(I,w,{once:!0})})}function B(I,S,L){typeof I.on=="function"&&R(I,"error",S,L)}function R(I,S,L,b){if(typeof I.on=="function")b.once?I.once(S,L):I.on(S,L);else if(typeof I.addEventListener=="function")I.addEventListener(S,function w(M){b.once&&I.removeEventListener(S,w),L(M)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof I)}},"./node_modules/webworkify-webpack/index.js":function(o,a,l){function c(E){var A={};function _(v){if(A[v])return A[v].exports;var T=A[v]={i:v,l:!1,exports:{}};return E[v].call(T.exports,T,T.exports,_),T.l=!0,T.exports}_.m=E,_.c=A,_.i=function(v){return v},_.d=function(v,T,C){_.o(v,T)||Object.defineProperty(v,T,{configurable:!1,enumerable:!0,get:C})},_.r=function(v){Object.defineProperty(v,"__esModule",{value:!0})},_.n=function(v){var T=v&&v.__esModule?function(){return v.default}:function(){return v};return _.d(T,"a",T),T},_.o=function(v,T){return Object.prototype.hasOwnProperty.call(v,T)},_.p="/",_.oe=function(v){throw console.error(v),v};var x=_(_.s=ENTRY_MODULE);return x.default||x}var d="[\\.|\\-|\\+|\\w|/|@]+",f="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+d+").*?\\)";function h(E){return(E+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function g(E){return!isNaN(1*E)}function p(E,A,_){var x={};x[_]=[];var v=A.toString(),T=v.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!T)return x;for(var C=T[1],k=new RegExp("(\\\\n|\\W)"+h(C)+f,"g"),B;B=k.exec(v);)B[3]!=="dll-reference"&&x[_].push(B[3]);for(k=new RegExp("\\("+h(C)+'\\("(dll-reference\\s('+d+'))"\\)\\)'+f,"g");B=k.exec(v);)E[B[2]]||(x[_].push(B[1]),E[B[2]]=l(B[1]).m),x[B[2]]=x[B[2]]||[],x[B[2]].push(B[4]);for(var R=Object.keys(x),I=0;I<R.length;I++)for(var S=0;S<x[R[I]].length;S++)g(x[R[I]][S])&&(x[R[I]][S]=1*x[R[I]][S]);return x}function m(E){var A=Object.keys(E);return A.reduce(function(_,x){return _||E[x].length>0},!1)}function y(E,A){for(var _={main:[A]},x={main:[]},v={main:{}};m(_);)for(var T=Object.keys(_),C=0;C<T.length;C++){var k=T[C],B=_[k],R=B.pop();if(v[k]=v[k]||{},!(v[k][R]||!E[k][R])){v[k][R]=!0,x[k]=x[k]||[],x[k].push(R);for(var I=p(E,E[k][R],k),S=Object.keys(I),L=0;L<S.length;L++)_[S[L]]=_[S[L]]||[],_[S[L]]=_[S[L]].concat(I[S[L]])}}return x}o.exports=function(E,A){A=A||{};var _={main:l.m},x=A.all?{main:Object.keys(_.main)}:y(_,E),v="";Object.keys(x).filter(function(R){return R!=="main"}).forEach(function(R){for(var I=0;x[R][I];)I++;x[R].push(I),_[R][I]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",v=v+"var "+R+" = ("+c.toString().replace("ENTRY_MODULE",JSON.stringify(I))+")({"+x[R].map(function(S){return""+JSON.stringify(S)+": "+_[R][S].toString()}).join(",")+`});
`}),v=v+"new (("+c.toString().replace("ENTRY_MODULE",JSON.stringify(E))+")({"+x.main.map(function(R){return""+JSON.stringify(R)+": "+_.main[R].toString()}).join(",")+"}))(self);";var T=new window.Blob([v],{type:"text/javascript"});if(A.bare)return T;var C=window.URL||window.webkitURL||window.mozURL||window.msURL,k=C.createObjectURL(T),B=new window.Worker(k);return B.objectURL=k,B}},"./src/config.js":function(o,a,l){l.r(a),l.d(a,{defaultConfig:function(){return c},createDefaultConfig:function(){return d}});var c={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function d(){return Object.assign({},c)}},"./src/core/features.js":function(o,a,l){l.r(a);var c=l("./src/io/io-controller.js"),d=l("./src/config.js"),f=function(){function h(){}return h.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},h.supportNetworkStreamIO=function(){var g=new c.default({},(0,d.createDefaultConfig)()),p=g.loaderType;return g.destroy(),p=="fetch-stream-loader"||p=="xhr-moz-chunked-loader"},h.getNetworkLoaderTypeName=function(){var g=new c.default({},(0,d.createDefaultConfig)()),p=g.loaderType;return g.destroy(),p},h.supportNativeMediaPlayback=function(g){h.videoElement==null&&(h.videoElement=window.document.createElement("video"));var p=h.videoElement.canPlayType(g);return p==="probably"||p=="maybe"},h.getFeatureList=function(){var g={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return g.mseFlvPlayback=h.supportMSEH264Playback(),g.networkStreamIO=h.supportNetworkStreamIO(),g.networkLoaderName=h.getNetworkLoaderTypeName(),g.mseLiveFlvPlayback=g.mseFlvPlayback&&g.networkStreamIO,g.nativeMP4H264Playback=h.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),g.nativeWebmVP8Playback=h.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),g.nativeWebmVP9Playback=h.supportNativeMediaPlayback('video/webm; codecs="vp9"'),g},h}();a.default=f},"./src/core/media-info.js":function(o,a,l){l.r(a);var c=function(){function d(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return d.prototype.isComplete=function(){var f=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,h=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&f&&h},d.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},d.prototype.getNearestKeyframe=function(f){if(this.keyframesIndex==null)return null;var h=this.keyframesIndex,g=this._search(h.times,f);return{index:g,milliseconds:h.times[g],fileposition:h.filepositions[g]}},d.prototype._search=function(f,h){var g=0,p=f.length-1,m=0,y=0,E=p;for(h<f[0]&&(g=0,y=E+1);y<=E;)if(m=y+Math.floor((E-y)/2),m===p||h>=f[m]&&h<f[m+1]){g=m;break}else f[m]<h?y=m+1:E=m-1;return g},d}();a.default=c},"./src/core/media-segment-info.js":function(o,a,l){l.r(a),l.d(a,{SampleInfo:function(){return c},MediaSegmentInfo:function(){return d},IDRSampleList:function(){return f},MediaSegmentInfoList:function(){return h}});var c=function(){function g(p,m,y,E,A){this.dts=p,this.pts=m,this.duration=y,this.originalDts=E,this.isSyncPoint=A,this.fileposition=null}return g}(),d=function(){function g(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return g.prototype.appendSyncPoint=function(p){p.isSyncPoint=!0,this.syncPoints.push(p)},g}(),f=function(){function g(){this._list=[]}return g.prototype.clear=function(){this._list=[]},g.prototype.appendArray=function(p){var m=this._list;p.length!==0&&(m.length>0&&p[0].originalDts<m[m.length-1].originalDts&&this.clear(),Array.prototype.push.apply(m,p))},g.prototype.getLastSyncPointBeforeDts=function(p){if(this._list.length==0)return null;var m=this._list,y=0,E=m.length-1,A=0,_=0,x=E;for(p<m[0].dts&&(y=0,_=x+1);_<=x;)if(A=_+Math.floor((x-_)/2),A===E||p>=m[A].dts&&p<m[A+1].dts){y=A;break}else m[A].dts<p?_=A+1:x=A-1;return this._list[y]},g}(),h=function(){function g(p){this._type=p,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),g.prototype.isEmpty=function(){return this._list.length===0},g.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},g.prototype._searchNearestSegmentBefore=function(p){var m=this._list;if(m.length===0)return-2;var y=m.length-1,E=0,A=0,_=y,x=0;if(p<m[0].originalBeginDts)return x=-1,x;for(;A<=_;)if(E=A+Math.floor((_-A)/2),E===y||p>m[E].lastSample.originalDts&&p<m[E+1].originalBeginDts){x=E;break}else m[E].originalBeginDts<p?A=E+1:_=E-1;return x},g.prototype._searchNearestSegmentAfter=function(p){return this._searchNearestSegmentBefore(p)+1},g.prototype.append=function(p){var m=this._list,y=p,E=this._lastAppendLocation,A=0;E!==-1&&E<m.length&&y.originalBeginDts>=m[E].lastSample.originalDts&&(E===m.length-1||E<m.length-1&&y.originalBeginDts<m[E+1].originalBeginDts)?A=E+1:m.length>0&&(A=this._searchNearestSegmentBefore(y.originalBeginDts)+1),this._lastAppendLocation=A,this._list.splice(A,0,y)},g.prototype.getLastSegmentBefore=function(p){var m=this._searchNearestSegmentBefore(p);return m>=0?this._list[m]:null},g.prototype.getLastSampleBefore=function(p){var m=this.getLastSegmentBefore(p);return m!=null?m.lastSample:null},g.prototype.getLastSyncPointBefore=function(p){for(var m=this._searchNearestSegmentBefore(p),y=this._list[m].syncPoints;y.length===0&&m>0;)m--,y=this._list[m].syncPoints;return y.length>0?y[y.length-1]:null},g}()},"./src/core/mse-controller.js":function(o,a,l){l.r(a);var c=l("./node_modules/events/events.js"),d=l.n(c),f=l("./src/utils/logger.js"),h=l("./src/utils/browser.js"),g=l("./src/core/mse-events.js"),p=l("./src/core/media-segment-info.js"),m=l("./src/utils/exception.js"),y=function(){function E(A){this.TAG="MSEController",this._config=A,this._emitter=new(d()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new p.IDRSampleList}return E.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},E.prototype.on=function(A,_){this._emitter.addListener(A,_)},E.prototype.off=function(A,_){this._emitter.removeListener(A,_)},E.prototype.attachMediaElement=function(A){if(this._mediaSource)throw new m.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var _=this._mediaSource=new window.MediaSource;_.addEventListener("sourceopen",this.e.onSourceOpen),_.addEventListener("sourceended",this.e.onSourceEnded),_.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=A,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),A.src=this._mediaSourceObjectURL},E.prototype.detachMediaElement=function(){if(this._mediaSource){var A=this._mediaSource;for(var _ in this._sourceBuffers){var x=this._pendingSegments[_];x.splice(0,x.length),this._pendingSegments[_]=null,this._pendingRemoveRanges[_]=null,this._lastInitSegments[_]=null;var v=this._sourceBuffers[_];if(v){if(A.readyState!=="closed"){try{A.removeSourceBuffer(v)}catch(T){f.default.e(this.TAG,T.message)}v.removeEventListener("error",this.e.onSourceBufferError),v.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[_]=null,this._sourceBuffers[_]=null}}if(A.readyState==="open")try{A.endOfStream()}catch(T){f.default.e(this.TAG,T.message)}A.removeEventListener("sourceopen",this.e.onSourceOpen),A.removeEventListener("sourceended",this.e.onSourceEnded),A.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},E.prototype.appendInitSegment=function(A,_){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(A),this._pendingSegments[A.type].push(A);return}var x=A,v=""+x.container;x.codec&&x.codec.length>0&&(v+=";codecs="+x.codec);var T=!1;if(f.default.v(this.TAG,"Received Initialization Segment, mimeType: "+v),this._lastInitSegments[x.type]=x,v!==this._mimeTypes[x.type]){if(this._mimeTypes[x.type])f.default.v(this.TAG,"Notice: "+x.type+" mimeType changed, origin: "+this._mimeTypes[x.type]+", target: "+v);else{T=!0;try{var C=this._sourceBuffers[x.type]=this._mediaSource.addSourceBuffer(v);C.addEventListener("error",this.e.onSourceBufferError),C.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(k){f.default.e(this.TAG,k.message),this._emitter.emit(g.default.ERROR,{code:k.code,msg:k.message});return}}this._mimeTypes[x.type]=v}_||this._pendingSegments[x.type].push(x),T||this._sourceBuffers[x.type]&&!this._sourceBuffers[x.type].updating&&this._doAppendSegments(),h.default.safari&&x.container==="audio/mpeg"&&x.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=x.mediaDuration/1e3,this._updateMediaSourceDuration())},E.prototype.appendMediaSegment=function(A){var _=A;this._pendingSegments[_.type].push(_),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var x=this._sourceBuffers[_.type];x&&!x.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},E.prototype.seek=function(A){for(var _ in this._sourceBuffers)if(this._sourceBuffers[_]){var x=this._sourceBuffers[_];if(this._mediaSource.readyState==="open")try{x.abort()}catch(R){f.default.e(this.TAG,R.message)}this._idrList.clear();var v=this._pendingSegments[_];if(v.splice(0,v.length),this._mediaSource.readyState!=="closed"){for(var T=0;T<x.buffered.length;T++){var C=x.buffered.start(T),k=x.buffered.end(T);this._pendingRemoveRanges[_].push({start:C,end:k})}if(x.updating||this._doRemoveRanges(),h.default.safari){var B=this._lastInitSegments[_];B&&(this._pendingSegments[_].push(B),x.updating||this._doAppendSegments())}}}},E.prototype.endOfStream=function(){var A=this._mediaSource,_=this._sourceBuffers;if(!A||A.readyState!=="open"){A&&A.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}_.video&&_.video.updating||_.audio&&_.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,A.endOfStream())},E.prototype.getNearestKeyframe=function(A){return this._idrList.getLastSyncPointBeforeDts(A)},E.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var A=this._mediaElement.currentTime;for(var _ in this._sourceBuffers){var x=this._sourceBuffers[_];if(x){var v=x.buffered;if(v.length>=1&&A-v.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},E.prototype._doCleanupSourceBuffer=function(){var A=this._mediaElement.currentTime;for(var _ in this._sourceBuffers){var x=this._sourceBuffers[_];if(x){for(var v=x.buffered,T=!1,C=0;C<v.length;C++){var k=v.start(C),B=v.end(C);if(k<=A&&A<B+3){if(A-k>=this._config.autoCleanupMaxBackwardDuration){T=!0;var R=A-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[_].push({start:k,end:R})}}else B<A&&(T=!0,this._pendingRemoveRanges[_].push({start:k,end:B}))}T&&!x.updating&&this._doRemoveRanges()}}},E.prototype._updateMediaSourceDuration=function(){var A=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(A.video&&A.video.updating||A.audio&&A.audio.updating)){var _=this._mediaSource.duration,x=this._pendingMediaDuration;x>0&&(isNaN(_)||x>_)&&(f.default.v(this.TAG,"Update MediaSource duration from "+_+" to "+x),this._mediaSource.duration=x),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},E.prototype._doRemoveRanges=function(){for(var A in this._pendingRemoveRanges)if(!(!this._sourceBuffers[A]||this._sourceBuffers[A].updating))for(var _=this._sourceBuffers[A],x=this._pendingRemoveRanges[A];x.length&&!_.updating;){var v=x.shift();_.remove(v.start,v.end)}},E.prototype._doAppendSegments=function(){var A=this._pendingSegments;for(var _ in A)if(!(!this._sourceBuffers[_]||this._sourceBuffers[_].updating)&&A[_].length>0){var x=A[_].shift();if(x.timestampOffset){var v=this._sourceBuffers[_].timestampOffset,T=x.timestampOffset/1e3,C=Math.abs(v-T);C>.1&&(f.default.v(this.TAG,"Update MPEG audio timestampOffset from "+v+" to "+T),this._sourceBuffers[_].timestampOffset=T),delete x.timestampOffset}if(!x.data||x.data.byteLength===0)continue;try{this._sourceBuffers[_].appendBuffer(x.data),this._isBufferFull=!1,_==="video"&&x.hasOwnProperty("info")&&this._idrList.appendArray(x.info.syncPoints)}catch(k){this._pendingSegments[_].unshift(x),k.code===22?(this._isBufferFull||this._emitter.emit(g.default.BUFFER_FULL),this._isBufferFull=!0):(f.default.e(this.TAG,k.message),this._emitter.emit(g.default.ERROR,{code:k.code,msg:k.message}))}}},E.prototype._onSourceOpen=function(){if(f.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var A=this._pendingSourceBufferInit;A.length;){var _=A.shift();this.appendInitSegment(_,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(g.default.SOURCE_OPEN)},E.prototype._onSourceEnded=function(){f.default.v(this.TAG,"MediaSource onSourceEnded")},E.prototype._onSourceClose=function(){f.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},E.prototype._hasPendingSegments=function(){var A=this._pendingSegments;return A.video.length>0||A.audio.length>0},E.prototype._hasPendingRemoveRanges=function(){var A=this._pendingRemoveRanges;return A.video.length>0||A.audio.length>0},E.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(g.default.UPDATE_END)},E.prototype._onSourceBufferError=function(A){f.default.e(this.TAG,"SourceBuffer Error: "+A)},E}();a.default=y},"./src/core/mse-events.js":function(o,a,l){l.r(a);var c={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};a.default=c},"./src/core/transmuxer.js":function(o,a,l){l.r(a);var c=l("./node_modules/events/events.js"),d=l.n(c),f=l("./node_modules/webworkify-webpack/index.js"),h=l.n(f),g=l("./src/utils/logger.js"),p=l("./src/utils/logging-control.js"),m=l("./src/core/transmuxing-controller.js"),y=l("./src/core/transmuxing-events.js"),E=l("./src/core/media-info.js"),A=function(){function _(x,v){if(this.TAG="Transmuxer",this._emitter=new(d()),v.enableWorker&&typeof Worker<"u")try{this._worker=h()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[x,v]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},p.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:p.default.getConfig()})}catch{g.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new m.default(x,v)}else this._controller=new m.default(x,v);if(this._controller){var T=this._controller;T.on(y.default.IO_ERROR,this._onIOError.bind(this)),T.on(y.default.DEMUX_ERROR,this._onDemuxError.bind(this)),T.on(y.default.INIT_SEGMENT,this._onInitSegment.bind(this)),T.on(y.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),T.on(y.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),T.on(y.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),T.on(y.default.MEDIA_INFO,this._onMediaInfo.bind(this)),T.on(y.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),T.on(y.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),T.on(y.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),T.on(y.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return _.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),p.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},_.prototype.on=function(x,v){this._emitter.addListener(x,v)},_.prototype.off=function(x,v){this._emitter.removeListener(x,v)},_.prototype.hasWorker=function(){return this._worker!=null},_.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},_.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},_.prototype.seek=function(x){this._worker?this._worker.postMessage({cmd:"seek",param:x}):this._controller.seek(x)},_.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},_.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},_.prototype._onInitSegment=function(x,v){var T=this;Promise.resolve().then(function(){T._emitter.emit(y.default.INIT_SEGMENT,x,v)})},_.prototype._onMediaSegment=function(x,v){var T=this;Promise.resolve().then(function(){T._emitter.emit(y.default.MEDIA_SEGMENT,x,v)})},_.prototype._onLoadingComplete=function(){var x=this;Promise.resolve().then(function(){x._emitter.emit(y.default.LOADING_COMPLETE)})},_.prototype._onRecoveredEarlyEof=function(){var x=this;Promise.resolve().then(function(){x._emitter.emit(y.default.RECOVERED_EARLY_EOF)})},_.prototype._onMediaInfo=function(x){var v=this;Promise.resolve().then(function(){v._emitter.emit(y.default.MEDIA_INFO,x)})},_.prototype._onMetaDataArrived=function(x){var v=this;Promise.resolve().then(function(){v._emitter.emit(y.default.METADATA_ARRIVED,x)})},_.prototype._onScriptDataArrived=function(x){var v=this;Promise.resolve().then(function(){v._emitter.emit(y.default.SCRIPTDATA_ARRIVED,x)})},_.prototype._onStatisticsInfo=function(x){var v=this;Promise.resolve().then(function(){v._emitter.emit(y.default.STATISTICS_INFO,x)})},_.prototype._onIOError=function(x,v){var T=this;Promise.resolve().then(function(){T._emitter.emit(y.default.IO_ERROR,x,v)})},_.prototype._onDemuxError=function(x,v){var T=this;Promise.resolve().then(function(){T._emitter.emit(y.default.DEMUX_ERROR,x,v)})},_.prototype._onRecommendSeekpoint=function(x){var v=this;Promise.resolve().then(function(){v._emitter.emit(y.default.RECOMMEND_SEEKPOINT,x)})},_.prototype._onLoggingConfigChanged=function(x){this._worker&&this._worker.postMessage({cmd:"logging_config",param:x})},_.prototype._onWorkerMessage=function(x){var v=x.data,T=v.data;if(v.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(v.msg){case y.default.INIT_SEGMENT:case y.default.MEDIA_SEGMENT:this._emitter.emit(v.msg,T.type,T.data);break;case y.default.LOADING_COMPLETE:case y.default.RECOVERED_EARLY_EOF:this._emitter.emit(v.msg);break;case y.default.MEDIA_INFO:Object.setPrototypeOf(T,E.default.prototype),this._emitter.emit(v.msg,T);break;case y.default.METADATA_ARRIVED:case y.default.SCRIPTDATA_ARRIVED:case y.default.STATISTICS_INFO:this._emitter.emit(v.msg,T);break;case y.default.IO_ERROR:case y.default.DEMUX_ERROR:this._emitter.emit(v.msg,T.type,T.info);break;case y.default.RECOMMEND_SEEKPOINT:this._emitter.emit(v.msg,T);break;case"logcat_callback":g.default.emitter.emit("log",T.type,T.logcat);break}},_}();a.default=A},"./src/core/transmuxing-controller.js":function(o,a,l){l.r(a);var c=l("./node_modules/events/events.js"),d=l.n(c),f=l("./src/utils/logger.js"),h=l("./src/utils/browser.js"),g=l("./src/core/media-info.js"),p=l("./src/demux/flv-demuxer.js"),m=l("./src/remux/mp4-remuxer.js"),y=l("./src/demux/demux-errors.js"),E=l("./src/io/io-controller.js"),A=l("./src/core/transmuxing-events.js"),_=function(){function x(v,T){this.TAG="TransmuxingController",this._emitter=new(d()),this._config=T,v.segments||(v.segments=[{duration:v.duration,filesize:v.filesize,url:v.url}]),typeof v.cors!="boolean"&&(v.cors=!0),typeof v.withCredentials!="boolean"&&(v.withCredentials=!1),this._mediaDataSource=v,this._currentSegmentIndex=0;var C=0;this._mediaDataSource.segments.forEach(function(k){k.timestampBase=C,C+=k.duration,k.cors=v.cors,k.withCredentials=v.withCredentials,T.referrerPolicy&&(k.referrerPolicy=T.referrerPolicy)}),!isNaN(C)&&this._mediaDataSource.duration!==C&&(this._mediaDataSource.duration=C),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return x.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},x.prototype.on=function(v,T){this._emitter.addListener(v,T)},x.prototype.off=function(v,T){this._emitter.removeListener(v,T)},x.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},x.prototype._loadSegment=function(v,T){this._currentSegmentIndex=v;var C=this._mediaDataSource.segments[v],k=this._ioctl=new E.default(C,this._config,v);k.onError=this._onIOException.bind(this),k.onSeeked=this._onIOSeeked.bind(this),k.onComplete=this._onIOComplete.bind(this),k.onRedirect=this._onIORedirect.bind(this),k.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),T?this._demuxer.bindDataSource(this._ioctl):k.onDataArrival=this._onInitChunkArrival.bind(this),k.open(T)},x.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},x.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},x.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},x.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},x.prototype.seek=function(v){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var T=this._searchSegmentIndexContains(v);if(T===this._currentSegmentIndex){var C=this._mediaInfo.segments[T];if(C==null)this._pendingSeekTime=v;else{var k=C.getNearestKeyframe(v);this._remuxer.seek(k.milliseconds),this._ioctl.seek(k.fileposition),this._pendingResolveSeekPoint=k.milliseconds}}else{var B=this._mediaInfo.segments[T];if(B==null)this._pendingSeekTime=v,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(T);else{var k=B.getNearestKeyframe(v);this._internalAbort(),this._remuxer.seek(v),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[T].timestampBase,this._loadSegment(T,k.fileposition),this._pendingResolveSeekPoint=k.milliseconds,this._reportSegmentMediaInfo(T)}}this._enableStatisticsReporter()}},x.prototype._searchSegmentIndexContains=function(v){for(var T=this._mediaDataSource.segments,C=T.length-1,k=0;k<T.length;k++)if(v<T[k].timestampBase){C=k-1;break}return C},x.prototype._onInitChunkArrival=function(v,T){var C=this,k=null,B=0;if(T>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,B=this._demuxer.parseChunks(v,T);else if((k=p.default.probe(v)).match){this._demuxer=new p.default(k,this._config),this._remuxer||(this._remuxer=new m.default(this._config));var R=this._mediaDataSource;R.duration!=null&&!isNaN(R.duration)&&(this._demuxer.overridedDuration=R.duration),typeof R.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=R.hasAudio),typeof R.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=R.hasVideo),this._demuxer.timestampBase=R.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),B=this._demuxer.parseChunks(v,T)}else k=null,f.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){C._internalAbort()}),this._emitter.emit(A.default.DEMUX_ERROR,y.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),B=0;return B},x.prototype._onMediaInfo=function(v){var T=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},v),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,g.default.prototype));var C=Object.assign({},v);Object.setPrototypeOf(C,g.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=C,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var k=T._pendingSeekTime;T._pendingSeekTime=null,T.seek(k)})},x.prototype._onMetaDataArrived=function(v){this._emitter.emit(A.default.METADATA_ARRIVED,v)},x.prototype._onScriptDataArrived=function(v){this._emitter.emit(A.default.SCRIPTDATA_ARRIVED,v)},x.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},x.prototype._onIOComplete=function(v){var T=v,C=T+1;C<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(C)):(this._remuxer.flushStashedSamples(),this._emitter.emit(A.default.LOADING_COMPLETE),this._disableStatisticsReporter())},x.prototype._onIORedirect=function(v){var T=this._ioctl.extraData;this._mediaDataSource.segments[T].redirectedURL=v},x.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(A.default.RECOVERED_EARLY_EOF)},x.prototype._onIOException=function(v,T){f.default.e(this.TAG,"IOException: type = "+v+", code = "+T.code+", msg = "+T.msg),this._emitter.emit(A.default.IO_ERROR,v,T),this._disableStatisticsReporter()},x.prototype._onDemuxException=function(v,T){f.default.e(this.TAG,"DemuxException: type = "+v+", info = "+T),this._emitter.emit(A.default.DEMUX_ERROR,v,T)},x.prototype._onRemuxerInitSegmentArrival=function(v,T){this._emitter.emit(A.default.INIT_SEGMENT,v,T)},x.prototype._onRemuxerMediaSegmentArrival=function(v,T){if(this._pendingSeekTime==null&&(this._emitter.emit(A.default.MEDIA_SEGMENT,v,T),this._pendingResolveSeekPoint!=null&&v==="video")){var C=T.info.syncPoints,k=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,h.default.safari&&C.length>0&&C[0].originalDts===k&&(k=C[0].pts),this._emitter.emit(A.default.RECOMMEND_SEEKPOINT,k)}},x.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},x.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},x.prototype._reportSegmentMediaInfo=function(v){var T=this._mediaInfo.segments[v],C=Object.assign({},T);C.duration=this._mediaInfo.duration,C.segmentCount=this._mediaInfo.segmentCount,delete C.segments,delete C.keyframesIndex,this._emitter.emit(A.default.MEDIA_INFO,C)},x.prototype._reportStatisticsInfo=function(){var v={};v.url=this._ioctl.currentURL,v.hasRedirect=this._ioctl.hasRedirect,v.hasRedirect&&(v.redirectedURL=this._ioctl.currentRedirectedURL),v.speed=this._ioctl.currentSpeed,v.loaderType=this._ioctl.loaderType,v.currentSegmentIndex=this._currentSegmentIndex,v.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(A.default.STATISTICS_INFO,v)},x}();a.default=_},"./src/core/transmuxing-events.js":function(o,a,l){l.r(a);var c={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};a.default=c},"./src/core/transmuxing-worker.js":function(o,a,l){l.r(a);var c=l("./src/utils/logging-control.js"),d=l("./src/utils/polyfill.js"),f=l("./src/core/transmuxing-controller.js"),h=l("./src/core/transmuxing-events.js"),g=function(p){var m=null,y=S.bind(this);d.default.install(),p.addEventListener("message",function(L){switch(L.data.cmd){case"init":m=new f.default(L.data.param[0],L.data.param[1]),m.on(h.default.IO_ERROR,B.bind(this)),m.on(h.default.DEMUX_ERROR,R.bind(this)),m.on(h.default.INIT_SEGMENT,E.bind(this)),m.on(h.default.MEDIA_SEGMENT,A.bind(this)),m.on(h.default.LOADING_COMPLETE,_.bind(this)),m.on(h.default.RECOVERED_EARLY_EOF,x.bind(this)),m.on(h.default.MEDIA_INFO,v.bind(this)),m.on(h.default.METADATA_ARRIVED,T.bind(this)),m.on(h.default.SCRIPTDATA_ARRIVED,C.bind(this)),m.on(h.default.STATISTICS_INFO,k.bind(this)),m.on(h.default.RECOMMEND_SEEKPOINT,I.bind(this));break;case"destroy":m&&(m.destroy(),m=null),p.postMessage({msg:"destroyed"});break;case"start":m.start();break;case"stop":m.stop();break;case"seek":m.seek(L.data.param);break;case"pause":m.pause();break;case"resume":m.resume();break;case"logging_config":{var b=L.data.param;c.default.applyConfig(b),b.enableCallback===!0?c.default.addLogListener(y):c.default.removeLogListener(y);break}}});function E(L,b){var w={msg:h.default.INIT_SEGMENT,data:{type:L,data:b}};p.postMessage(w,[b.data])}function A(L,b){var w={msg:h.default.MEDIA_SEGMENT,data:{type:L,data:b}};p.postMessage(w,[b.data])}function _(){var L={msg:h.default.LOADING_COMPLETE};p.postMessage(L)}function x(){var L={msg:h.default.RECOVERED_EARLY_EOF};p.postMessage(L)}function v(L){var b={msg:h.default.MEDIA_INFO,data:L};p.postMessage(b)}function T(L){var b={msg:h.default.METADATA_ARRIVED,data:L};p.postMessage(b)}function C(L){var b={msg:h.default.SCRIPTDATA_ARRIVED,data:L};p.postMessage(b)}function k(L){var b={msg:h.default.STATISTICS_INFO,data:L};p.postMessage(b)}function B(L,b){p.postMessage({msg:h.default.IO_ERROR,data:{type:L,info:b}})}function R(L,b){p.postMessage({msg:h.default.DEMUX_ERROR,data:{type:L,info:b}})}function I(L){p.postMessage({msg:h.default.RECOMMEND_SEEKPOINT,data:L})}function S(L,b){p.postMessage({msg:"logcat_callback",data:{type:L,logcat:b}})}};a.default=g},"./src/demux/amf-parser.js":function(o,a,l){l.r(a);var c=l("./src/utils/logger.js"),d=l("./src/utils/utf8-conv.js"),f=l("./src/utils/exception.js"),h=function(){var p=new ArrayBuffer(2);return new DataView(p).setInt16(0,256,!0),new Int16Array(p)[0]===256}(),g=function(){function p(){}return p.parseScriptData=function(m,y,E){var A={};try{var _=p.parseValue(m,y,E),x=p.parseValue(m,y+_.size,E-_.size);A[_.data]=x.data}catch(v){c.default.e("AMF",v.toString())}return A},p.parseObject=function(m,y,E){if(E<3)throw new f.IllegalStateException("Data not enough when parse ScriptDataObject");var A=p.parseString(m,y,E),_=p.parseValue(m,y+A.size,E-A.size),x=_.objectEnd;return{data:{name:A.data,value:_.data},size:A.size+_.size,objectEnd:x}},p.parseVariable=function(m,y,E){return p.parseObject(m,y,E)},p.parseString=function(m,y,E){if(E<2)throw new f.IllegalStateException("Data not enough when parse String");var A=new DataView(m,y,E),_=A.getUint16(0,!h),x;return _>0?x=(0,d.default)(new Uint8Array(m,y+2,_)):x="",{data:x,size:2+_}},p.parseLongString=function(m,y,E){if(E<4)throw new f.IllegalStateException("Data not enough when parse LongString");var A=new DataView(m,y,E),_=A.getUint32(0,!h),x;return _>0?x=(0,d.default)(new Uint8Array(m,y+4,_)):x="",{data:x,size:4+_}},p.parseDate=function(m,y,E){if(E<10)throw new f.IllegalStateException("Data size invalid when parse Date");var A=new DataView(m,y,E),_=A.getFloat64(0,!h),x=A.getInt16(8,!h);return _+=x*60*1e3,{data:new Date(_),size:8+2}},p.parseValue=function(m,y,E){if(E<1)throw new f.IllegalStateException("Data not enough when parse Value");var A=new DataView(m,y,E),_=1,x=A.getUint8(0),v,T=!1;try{switch(x){case 0:v=A.getFloat64(1,!h),_+=8;break;case 1:{var C=A.getUint8(1);v=!!C,_+=1;break}case 2:{var k=p.parseString(m,y+1,E-1);v=k.data,_+=k.size;break}case 3:{v={};var B=0;for((A.getUint32(E-4,!h)&16777215)===9&&(B=3);_<E-4;){var R=p.parseObject(m,y+_,E-_-B);if(R.objectEnd)break;v[R.data.name]=R.data.value,_+=R.size}if(_<=E-3){var I=A.getUint32(_-1,!h)&16777215;I===9&&(_+=3)}break}case 8:{v={},_+=4;var B=0;for((A.getUint32(E-4,!h)&16777215)===9&&(B=3);_<E-8;){var S=p.parseVariable(m,y+_,E-_-B);if(S.objectEnd)break;v[S.data.name]=S.data.value,_+=S.size}if(_<=E-3){var I=A.getUint32(_-1,!h)&16777215;I===9&&(_+=3)}break}case 9:v=void 0,_=1,T=!0;break;case 10:{v=[];var L=A.getUint32(1,!h);_+=4;for(var b=0;b<L;b++){var w=p.parseValue(m,y+_,E-_);v.push(w.data),_+=w.size}break}case 11:{var M=p.parseDate(m,y+1,E-1);v=M.data,_+=M.size;break}case 12:{var O=p.parseString(m,y+1,E-1);v=O.data,_+=O.size;break}default:_=E,c.default.w("AMF","Unsupported AMF value type "+x)}}catch(D){c.default.e("AMF",D.toString())}return{data:v,size:_,objectEnd:T}},p}();a.default=g},"./src/demux/demux-errors.js":function(o,a,l){l.r(a);var c={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};a.default=c},"./src/demux/exp-golomb.js":function(o,a,l){l.r(a);var c=l("./src/utils/exception.js"),d=function(){function f(h){this.TAG="ExpGolomb",this._buffer=h,this._buffer_index=0,this._total_bytes=h.byteLength,this._total_bits=h.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return f.prototype.destroy=function(){this._buffer=null},f.prototype._fillCurrentWord=function(){var h=this._total_bytes-this._buffer_index;if(h<=0)throw new c.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var g=Math.min(4,h),p=new Uint8Array(4);p.set(this._buffer.subarray(this._buffer_index,this._buffer_index+g)),this._current_word=new DataView(p.buffer).getUint32(0,!1),this._buffer_index+=g,this._current_word_bits_left=g*8},f.prototype.readBits=function(h){if(h>32)throw new c.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(h<=this._current_word_bits_left){var g=this._current_word>>>32-h;return this._current_word<<=h,this._current_word_bits_left-=h,g}var p=this._current_word_bits_left?this._current_word:0;p=p>>>32-this._current_word_bits_left;var m=h-this._current_word_bits_left;this._fillCurrentWord();var y=Math.min(m,this._current_word_bits_left),E=this._current_word>>>32-y;return this._current_word<<=y,this._current_word_bits_left-=y,p=p<<y|E,p},f.prototype.readBool=function(){return this.readBits(1)===1},f.prototype.readByte=function(){return this.readBits(8)},f.prototype._skipLeadingZero=function(){var h;for(h=0;h<this._current_word_bits_left;h++)if(this._current_word&2147483648>>>h)return this._current_word<<=h,this._current_word_bits_left-=h,h;return this._fillCurrentWord(),h+this._skipLeadingZero()},f.prototype.readUEG=function(){var h=this._skipLeadingZero();return this.readBits(h+1)-1},f.prototype.readSEG=function(){var h=this.readUEG();return h&1?h+1>>>1:-1*(h>>>1)},f}();a.default=d},"./src/demux/flv-demuxer.js":function(o,a,l){l.r(a);var c=l("./src/utils/logger.js"),d=l("./src/demux/amf-parser.js"),f=l("./src/demux/sps-parser.js"),h=l("./src/demux/demux-errors.js"),g=l("./src/core/media-info.js"),p=l("./src/utils/exception.js");function m(E,A){return E[A]<<24|E[A+1]<<16|E[A+2]<<8|E[A+3]}var y=function(){function E(A,_){this.TAG="FLVDemuxer",this._config=_,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=A.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=A.hasAudioTrack,this._hasVideo=A.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new g.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var x=new ArrayBuffer(2);return new DataView(x).setInt16(0,256,!0),new Int16Array(x)[0]===256}()}return E.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},E.probe=function(A){var _=new Uint8Array(A),x={match:!1};if(_[0]!==70||_[1]!==76||_[2]!==86||_[3]!==1)return x;var v=(_[4]&4)>>>2!==0,T=(_[4]&1)!==0,C=m(_,5);return C<9?x:{match:!0,consumed:C,dataOffset:C,hasAudioTrack:v,hasVideoTrack:T}},E.prototype.bindDataSource=function(A){return A.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(E.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(A){this._onTrackMetadata=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(A){this._onMediaInfo=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(A){this._onMetaDataArrived=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(A){this._onScriptDataArrived=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onError",{get:function(){return this._onError},set:function(A){this._onError=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(A){this._onDataAvailable=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(A){this._timestampBase=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"overridedDuration",{get:function(){return this._duration},set:function(A){this._durationOverrided=!0,this._duration=A,this._mediaInfo.duration=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"overridedHasAudio",{set:function(A){this._hasAudioFlagOverrided=!0,this._hasAudio=A,this._mediaInfo.hasAudio=A},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"overridedHasVideo",{set:function(A){this._hasVideoFlagOverrided=!0,this._hasVideo=A,this._mediaInfo.hasVideo=A},enumerable:!1,configurable:!0}),E.prototype.resetMediaInfo=function(){this._mediaInfo=new g.default},E.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},E.prototype.parseChunks=function(A,_){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new p.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var x=0,v=this._littleEndian;if(_===0)if(A.byteLength>13){var T=E.probe(A);x=T.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,_+x!==this._dataOffset&&c.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var C=new DataView(A,x),k=C.getUint32(0,!v);k!==0&&c.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),x+=4}for(;x<A.byteLength;){this._dispatch=!0;var C=new DataView(A,x);if(x+11+4>A.byteLength)break;var B=C.getUint8(0),R=C.getUint32(0,!v)&16777215;if(x+11+R+4>A.byteLength)break;if(B!==8&&B!==9&&B!==18){c.default.w(this.TAG,"Unsupported tag type "+B+", skipped"),x+=11+R+4;continue}var I=C.getUint8(4),S=C.getUint8(5),L=C.getUint8(6),b=C.getUint8(7),w=L|S<<8|I<<16|b<<24,M=C.getUint32(7,!v)&16777215;M!==0&&c.default.w(this.TAG,"Meet tag which has StreamID != 0!");var O=x+11;switch(B){case 8:this._parseAudioData(A,O,R,w);break;case 9:this._parseVideoData(A,O,R,w,_+x);break;case 18:this._parseScriptData(A,O,R);break}var D=C.getUint32(11+R,!v);D!==11+R&&c.default.w(this.TAG,"Invalid PrevTagSize "+D),x+=11+R+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),x},E.prototype._parseScriptData=function(A,_,x){var v=d.default.parseScriptData(A,_,x);if(v.hasOwnProperty("onMetaData")){if(v.onMetaData==null||typeof v.onMetaData!="object"){c.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&c.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=v;var T=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},T)),typeof T.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=T.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof T.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=T.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof T.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=T.audiodatarate),typeof T.videodatarate=="number"&&(this._mediaInfo.videoDataRate=T.videodatarate),typeof T.width=="number"&&(this._mediaInfo.width=T.width),typeof T.height=="number"&&(this._mediaInfo.height=T.height),typeof T.duration=="number"){if(!this._durationOverrided){var C=Math.floor(T.duration*this._timescale);this._duration=C,this._mediaInfo.duration=C}}else this._mediaInfo.duration=0;if(typeof T.framerate=="number"){var k=Math.floor(T.framerate*1e3);if(k>0){var B=k/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=B,this._referenceFrameRate.fps_num=k,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=B}}if(typeof T.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var R=T.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(R),T.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=T,c.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(v).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},v))},E.prototype._parseKeyframesIndex=function(A){for(var _=[],x=[],v=1;v<A.times.length;v++){var T=this._timestampBase+Math.floor(A.times[v]*1e3);_.push(T),x.push(A.filepositions[v])}return{times:_,filepositions:x}},E.prototype._parseAudioData=function(A,_,x,v){if(x<=1){c.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var T=new DataView(A,_,x),C=T.getUint8(0),k=C>>>4;if(k!==2&&k!==10){this._onError(h.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+k);return}var B=0,R=(C&12)>>>2;if(R>=0&&R<=4)B=this._flvSoundRateTable[R];else{this._onError(h.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+R);return}var I=C&1,S=this._audioMetadata,L=this._audioTrack;if(S||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),S=this._audioMetadata={},S.type="audio",S.id=L.id,S.timescale=this._timescale,S.duration=this._duration,S.audioSampleRate=B,S.channelCount=I===0?1:2),k===10){var b=this._parseAACAudioData(A,_+1,x-1);if(b==null)return;if(b.packetType===0){S.config&&c.default.w(this.TAG,"Found another AudioSpecificConfig!");var w=b.data;S.audioSampleRate=w.samplingRate,S.channelCount=w.channelCount,S.codec=w.codec,S.originalCodec=w.originalCodec,S.config=w.config,S.refSampleDuration=1024/S.audioSampleRate*S.timescale,c.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",S);var M=this._mediaInfo;M.audioCodec=S.originalCodec,M.audioSampleRate=S.audioSampleRate,M.audioChannelCount=S.channelCount,M.hasVideo?M.videoCodec!=null&&(M.mimeType='video/x-flv; codecs="'+M.videoCodec+","+M.audioCodec+'"'):M.mimeType='video/x-flv; codecs="'+M.audioCodec+'"',M.isComplete()&&this._onMediaInfo(M)}else if(b.packetType===1){var O=this._timestampBase+v,D={unit:b.data,length:b.data.byteLength,dts:O,pts:O};L.samples.push(D),L.length+=b.data.length}else c.default.e(this.TAG,"Flv: Unsupported AAC data type "+b.packetType)}else if(k===2){if(!S.codec){var w=this._parseMP3AudioData(A,_+1,x-1,!0);if(w==null)return;S.audioSampleRate=w.samplingRate,S.channelCount=w.channelCount,S.codec=w.codec,S.originalCodec=w.originalCodec,S.refSampleDuration=1152/S.audioSampleRate*S.timescale,c.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",S);var M=this._mediaInfo;M.audioCodec=S.codec,M.audioSampleRate=S.audioSampleRate,M.audioChannelCount=S.channelCount,M.audioDataRate=w.bitRate,M.hasVideo?M.videoCodec!=null&&(M.mimeType='video/x-flv; codecs="'+M.videoCodec+","+M.audioCodec+'"'):M.mimeType='video/x-flv; codecs="'+M.audioCodec+'"',M.isComplete()&&this._onMediaInfo(M)}var F=this._parseMP3AudioData(A,_+1,x-1,!1);if(F==null)return;var O=this._timestampBase+v,U={unit:F,length:F.byteLength,dts:O,pts:O};L.samples.push(U),L.length+=F.length}}},E.prototype._parseAACAudioData=function(A,_,x){if(x<=1){c.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var v={},T=new Uint8Array(A,_,x);return v.packetType=T[0],T[0]===0?v.data=this._parseAACAudioSpecificConfig(A,_+1,x-1):v.data=T.subarray(1),v},E.prototype._parseAACAudioSpecificConfig=function(A,_,x){var v=new Uint8Array(A,_,x),T=null,C=0,k=0,B=0,R=null;if(C=k=v[0]>>>3,B=(v[0]&7)<<1|v[1]>>>7,B<0||B>=this._mpegSamplingRates.length){this._onError(h.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var I=this._mpegSamplingRates[B],S=(v[1]&120)>>>3;if(S<0||S>=8){this._onError(h.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}C===5&&(R=(v[1]&7)<<1|v[2]>>>7,(v[2]&124)>>>2);var L=self.navigator.userAgent.toLowerCase();return L.indexOf("firefox")!==-1?B>=6?(C=5,T=new Array(4),R=B-3):(C=2,T=new Array(2),R=B):L.indexOf("android")!==-1?(C=2,T=new Array(2),R=B):(C=5,R=B,T=new Array(4),B>=6?R=B-3:S===1&&(C=2,T=new Array(2),R=B)),T[0]=C<<3,T[0]|=(B&15)>>>1,T[1]=(B&15)<<7,T[1]|=(S&15)<<3,C===5&&(T[1]|=(R&15)>>>1,T[2]=(R&1)<<7,T[2]|=8,T[3]=0),{config:T,samplingRate:I,channelCount:S,codec:"mp4a.40."+C,originalCodec:"mp4a.40."+k}},E.prototype._parseMP3AudioData=function(A,_,x,v){if(x<4){c.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var T=new Uint8Array(A,_,x),C=null;if(v){if(T[0]!==255)return;var k=T[1]>>>3&3,B=(T[1]&6)>>1,R=(T[2]&240)>>>4,I=(T[2]&12)>>>2,S=T[3]>>>6&3,L=S!==3?2:1,b=0,w=0,M="mp3";switch(k){case 0:b=this._mpegAudioV25SampleRateTable[I];break;case 2:b=this._mpegAudioV20SampleRateTable[I];break;case 3:b=this._mpegAudioV10SampleRateTable[I];break}switch(B){case 1:R<this._mpegAudioL3BitRateTable.length&&(w=this._mpegAudioL3BitRateTable[R]);break;case 2:R<this._mpegAudioL2BitRateTable.length&&(w=this._mpegAudioL2BitRateTable[R]);break;case 3:R<this._mpegAudioL1BitRateTable.length&&(w=this._mpegAudioL1BitRateTable[R]);break}C={bitRate:w,samplingRate:b,channelCount:L,codec:M,originalCodec:M}}else C=T;return C},E.prototype._parseVideoData=function(A,_,x,v,T){if(x<=1){c.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var C=new Uint8Array(A,_,x)[0],k=(C&240)>>>4,B=C&15;if(B!==7){this._onError(h.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+B);return}this._parseAVCVideoPacket(A,_+1,x-1,v,T,k)}},E.prototype._parseAVCVideoPacket=function(A,_,x,v,T,C){if(x<4){c.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var k=this._littleEndian,B=new DataView(A,_,x),R=B.getUint8(0),I=B.getUint32(0,!k)&16777215,S=I<<8>>8;if(R===0)this._parseAVCDecoderConfigurationRecord(A,_+4,x-4);else if(R===1)this._parseAVCVideoData(A,_+4,x-4,v,T,C,S);else if(R!==2){this._onError(h.default.FORMAT_ERROR,"Flv: Invalid video packet type "+R);return}},E.prototype._parseAVCDecoderConfigurationRecord=function(A,_,x){if(x<7){c.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var v=this._videoMetadata,T=this._videoTrack,C=this._littleEndian,k=new DataView(A,_,x);v?typeof v.avcc<"u"&&c.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),v=this._videoMetadata={},v.type="video",v.id=T.id,v.timescale=this._timescale,v.duration=this._duration);var B=k.getUint8(0),R=k.getUint8(1);if(k.getUint8(2),k.getUint8(3),B!==1||R===0){this._onError(h.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(k.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(h.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var I=k.getUint8(5)&31;if(I===0){this._onError(h.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else I>1&&c.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+I);for(var S=6,L=0;L<I;L++){var b=k.getUint16(S,!C);if(S+=2,b!==0){var w=new Uint8Array(A,_+S,b);S+=b;var M=f.default.parseSPS(w);if(L===0){v.codecWidth=M.codec_size.width,v.codecHeight=M.codec_size.height,v.presentWidth=M.present_size.width,v.presentHeight=M.present_size.height,v.profile=M.profile_string,v.level=M.level_string,v.bitDepth=M.bit_depth,v.chromaFormat=M.chroma_format,v.sarRatio=M.sar_ratio,v.frameRate=M.frame_rate,(M.frame_rate.fixed===!1||M.frame_rate.fps_num===0||M.frame_rate.fps_den===0)&&(v.frameRate=this._referenceFrameRate);var O=v.frameRate.fps_den,D=v.frameRate.fps_num;v.refSampleDuration=v.timescale*(O/D);for(var F=w.subarray(1,4),U="avc1.",K=0;K<3;K++){var N=F[K].toString(16);N.length<2&&(N="0"+N),U+=N}v.codec=U;var G=this._mediaInfo;G.width=v.codecWidth,G.height=v.codecHeight,G.fps=v.frameRate.fps,G.profile=v.profile,G.level=v.level,G.refFrames=M.ref_frames,G.chromaFormat=M.chroma_format_string,G.sarNum=v.sarRatio.width,G.sarDen=v.sarRatio.height,G.videoCodec=U,G.hasAudio?G.audioCodec!=null&&(G.mimeType='video/x-flv; codecs="'+G.videoCodec+","+G.audioCodec+'"'):G.mimeType='video/x-flv; codecs="'+G.videoCodec+'"',G.isComplete()&&this._onMediaInfo(G)}}}var H=k.getUint8(S);if(H===0){this._onError(h.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else H>1&&c.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+H);S++;for(var L=0;L<H;L++){var b=k.getUint16(S,!C);S+=2,b!==0&&(S+=b)}v.avcc=new Uint8Array(x),v.avcc.set(new Uint8Array(A,_,x),0),c.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",v)},E.prototype._parseAVCVideoData=function(A,_,x,v,T,C,k){for(var B=this._littleEndian,R=new DataView(A,_,x),I=[],S=0,L=0,b=this._naluLengthSize,w=this._timestampBase+v,M=C===1;L<x;){if(L+4>=x){c.default.w(this.TAG,"Malformed Nalu near timestamp "+w+", offset = "+L+", dataSize = "+x);break}var O=R.getUint32(L,!B);if(b===3&&(O>>>=8),O>x-b){c.default.w(this.TAG,"Malformed Nalus near timestamp "+w+", NaluSize > DataSize!");return}var D=R.getUint8(L+b)&31;D===5&&(M=!0);var F=new Uint8Array(A,_+L,b+O),U={type:D,data:F};I.push(U),S+=F.byteLength,L+=b+O}if(I.length){var K=this._videoTrack,N={units:I,length:S,isKeyframe:M,dts:w,cts:k,pts:w+k};M&&(N.fileposition=T),K.samples.push(N),K.length+=S}},E}();a.default=y},"./src/demux/sps-parser.js":function(o,a,l){l.r(a);var c=l("./src/demux/exp-golomb.js"),d=function(){function f(){}return f._ebsp2rbsp=function(h){for(var g=h,p=g.byteLength,m=new Uint8Array(p),y=0,E=0;E<p;E++)E>=2&&g[E]===3&&g[E-1]===0&&g[E-2]===0||(m[y]=g[E],y++);return new Uint8Array(m.buffer,0,y)},f.parseSPS=function(h){var g=f._ebsp2rbsp(h),p=new c.default(g);p.readByte();var m=p.readByte();p.readByte();var y=p.readByte();p.readUEG();var E=f.getProfileString(m),A=f.getLevelString(y),_=1,x=420,v=[0,420,422,444],T=8;if((m===100||m===110||m===122||m===244||m===44||m===83||m===86||m===118||m===128||m===138||m===144)&&(_=p.readUEG(),_===3&&p.readBits(1),_<=3&&(x=v[_]),T=p.readUEG()+8,p.readUEG(),p.readBits(1),p.readBool()))for(var C=_!==3?8:12,k=0;k<C;k++)p.readBool()&&(k<6?f._skipScalingList(p,16):f._skipScalingList(p,64));p.readUEG();var B=p.readUEG();if(B===0)p.readUEG();else if(B===1){p.readBits(1),p.readSEG(),p.readSEG();for(var R=p.readUEG(),k=0;k<R;k++)p.readSEG()}var I=p.readUEG();p.readBits(1);var S=p.readUEG(),L=p.readUEG(),b=p.readBits(1);b===0&&p.readBits(1),p.readBits(1);var w=0,M=0,O=0,D=0,F=p.readBool();F&&(w=p.readUEG(),M=p.readUEG(),O=p.readUEG(),D=p.readUEG());var U=1,K=1,N=0,G=!0,H=0,Z=0,J=p.readBool();if(J){if(p.readBool()){var X=p.readByte(),ne=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ce=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];X>0&&X<16?(U=ne[X-1],K=ce[X-1]):X===255&&(U=p.readByte()<<8|p.readByte(),K=p.readByte()<<8|p.readByte())}if(p.readBool()&&p.readBool(),p.readBool()&&(p.readBits(4),p.readBool()&&p.readBits(24)),p.readBool()&&(p.readUEG(),p.readUEG()),p.readBool()){var re=p.readBits(32),Ee=p.readBits(32);G=p.readBool(),H=Ee,Z=re*2,N=H/Z}}var se=1;(U!==1||K!==1)&&(se=U/K);var ee=0,he=0;if(_===0)ee=1,he=2-b;else{var _e=_===3?1:2,ke=_===1?2:1;ee=_e,he=ke*(2-b)}var De=(S+1)*16,we=(2-b)*((L+1)*16);De-=(w+M)*ee,we-=(O+D)*he;var Ie=Math.ceil(De*se);return p.destroy(),p=null,{profile_string:E,level_string:A,bit_depth:T,ref_frames:I,chroma_format:x,chroma_format_string:f.getChromaFormatString(x),frame_rate:{fixed:G,fps:N,fps_den:Z,fps_num:H},sar_ratio:{width:U,height:K},codec_size:{width:De,height:we},present_size:{width:Ie,height:we}}},f._skipScalingList=function(h,g){for(var p=8,m=8,y=0,E=0;E<g;E++)m!==0&&(y=h.readSEG(),m=(p+y+256)%256),p=m===0?p:m},f.getProfileString=function(h){switch(h){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},f.getLevelString=function(h){return(h/10).toFixed(1)},f.getChromaFormatString=function(h){switch(h){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},f}();a.default=d},"./src/flv.js":function(o,a,l){l.r(a);var c=l("./src/utils/polyfill.js"),d=l("./src/core/features.js"),f=l("./src/io/loader.js"),h=l("./src/player/flv-player.js"),g=l("./src/player/native-player.js"),p=l("./src/player/player-events.js"),m=l("./src/player/player-errors.js"),y=l("./src/utils/logging-control.js"),E=l("./src/utils/exception.js");c.default.install();function A(T,C){var k=T;if(k==null||typeof k!="object")throw new E.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!k.hasOwnProperty("type"))throw new E.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(k.type){case"flv":return new h.default(k,C);default:return new g.default(k,C)}}function _(){return d.default.supportMSEH264Playback()}function x(){return d.default.getFeatureList()}var v={};v.createPlayer=A,v.isSupported=_,v.getFeatureList=x,v.BaseLoader=f.BaseLoader,v.LoaderStatus=f.LoaderStatus,v.LoaderErrors=f.LoaderErrors,v.Events=p.default,v.ErrorTypes=m.ErrorTypes,v.ErrorDetails=m.ErrorDetails,v.FlvPlayer=h.default,v.NativePlayer=g.default,v.LoggingControl=y.default,Object.defineProperty(v,"version",{enumerable:!0,get:function(){return"1.6.2"}}),a.default=v},"./src/index.js":function(o,a,l){o.exports=l("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(o,a,l){l.r(a);var c=l("./src/utils/browser.js"),d=l("./src/io/loader.js"),f=l("./src/utils/exception.js"),h=function(){var p=function(m,y){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,A){E.__proto__=A}||function(E,A){for(var _ in A)Object.prototype.hasOwnProperty.call(A,_)&&(E[_]=A[_])},p(m,y)};return function(m,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");p(m,y);function E(){this.constructor=m}m.prototype=y===null?Object.create(y):(E.prototype=y.prototype,new E)}}(),g=function(p){h(m,p);function m(y,E){var A=p.call(this,"fetch-stream-loader")||this;return A.TAG="FetchStreamLoader",A._seekHandler=y,A._config=E,A._needStash=!0,A._requestAbort=!1,A._contentLength=null,A._receivedLength=0,A}return m.isSupported=function(){try{var y=c.default.msedge&&c.default.version.minor>=15048,E=c.default.msedge?y:!0;return self.fetch&&self.ReadableStream&&E}catch{return!1}},m.prototype.destroy=function(){this.isWorking()&&this.abort(),p.prototype.destroy.call(this)},m.prototype.open=function(y,E){var A=this;this._dataSource=y,this._range=E;var _=y.url;this._config.reuseRedirectedURL&&y.redirectedURL!=null&&(_=y.redirectedURL);var x=this._seekHandler.getConfig(_,E),v=new self.Headers;if(typeof x.headers=="object"){var T=x.headers;for(var C in T)T.hasOwnProperty(C)&&v.append(C,T[C])}var k={method:"GET",headers:v,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var C in this._config.headers)v.append(C,this._config.headers[C]);y.cors===!1&&(k.mode="same-origin"),y.withCredentials&&(k.credentials="include"),y.referrerPolicy&&(k.referrerPolicy=y.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,k.signal=this._abortController.signal),this._status=d.LoaderStatus.kConnecting,self.fetch(x.url,k).then(function(B){if(A._requestAbort){A._status=d.LoaderStatus.kIdle,B.body.cancel();return}if(B.ok&&B.status>=200&&B.status<=299){if(B.url!==x.url&&A._onURLRedirect){var R=A._seekHandler.removeURLParameters(B.url);A._onURLRedirect(R)}var I=B.headers.get("Content-Length");return I!=null&&(A._contentLength=parseInt(I),A._contentLength!==0&&A._onContentLengthKnown&&A._onContentLengthKnown(A._contentLength)),A._pump.call(A,B.body.getReader())}else if(A._status=d.LoaderStatus.kError,A._onError)A._onError(d.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:B.status,msg:B.statusText});else throw new f.RuntimeException("FetchStreamLoader: Http code invalid, "+B.status+" "+B.statusText)}).catch(function(B){if(!(A._abortController&&A._abortController.signal.aborted))if(A._status=d.LoaderStatus.kError,A._onError)A._onError(d.LoaderErrors.EXCEPTION,{code:-1,msg:B.message});else throw B})},m.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==d.LoaderStatus.kBuffering||!c.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},m.prototype._pump=function(y){var E=this;return y.read().then(function(A){if(A.done)if(E._contentLength!==null&&E._receivedLength<E._contentLength){E._status=d.LoaderStatus.kError;var _=d.LoaderErrors.EARLY_EOF,x={code:-1,msg:"Fetch stream meet Early-EOF"};if(E._onError)E._onError(_,x);else throw new f.RuntimeException(x.msg)}else E._status=d.LoaderStatus.kComplete,E._onComplete&&E._onComplete(E._range.from,E._range.from+E._receivedLength-1);else{if(E._abortController&&E._abortController.signal.aborted){E._status=d.LoaderStatus.kComplete;return}else if(E._requestAbort===!0)return E._status=d.LoaderStatus.kComplete,y.cancel();E._status=d.LoaderStatus.kBuffering;var v=A.value.buffer,T=E._range.from+E._receivedLength;E._receivedLength+=v.byteLength,E._onDataArrival&&E._onDataArrival(v,T,E._receivedLength),E._pump(y)}}).catch(function(A){if(E._abortController&&E._abortController.signal.aborted){E._status=d.LoaderStatus.kComplete;return}if(!(A.code===11&&c.default.msedge)){E._status=d.LoaderStatus.kError;var _=0,x=null;if((A.code===19||A.message==="network error")&&(E._contentLength===null||E._contentLength!==null&&E._receivedLength<E._contentLength)?(_=d.LoaderErrors.EARLY_EOF,x={code:A.code,msg:"Fetch stream meet Early-EOF"}):(_=d.LoaderErrors.EXCEPTION,x={code:A.code,msg:A.message}),E._onError)E._onError(_,x);else throw new f.RuntimeException(x.msg)}})},m}(d.BaseLoader);a.default=g},"./src/io/io-controller.js":function(o,a,l){l.r(a);var c=l("./src/utils/logger.js"),d=l("./src/io/speed-sampler.js"),f=l("./src/io/loader.js"),h=l("./src/io/fetch-stream-loader.js"),g=l("./src/io/xhr-moz-chunked-loader.js"),p=l("./src/io/xhr-range-loader.js"),m=l("./src/io/websocket-loader.js"),y=l("./src/io/range-seek-handler.js"),E=l("./src/io/param-seek-handler.js"),A=l("./src/utils/exception.js"),_=function(){function x(v,T,C){this.TAG="IOController",this._config=T,this._extraData=C,this._stashInitialSize=1024*384,T.stashInitialSize!=null&&T.stashInitialSize>0&&(this._stashInitialSize=T.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,T.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=v,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(v.url),this._refTotalLength=v.filesize?v.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new d.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return x.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},x.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},x.prototype.isPaused=function(){return this._paused},Object.defineProperty(x.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"extraData",{get:function(){return this._extraData},set:function(v){this._extraData=v},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(v){this._onDataArrival=v},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(v){this._onSeeked=v},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onError",{get:function(){return this._onError},set:function(v){this._onError=v},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onComplete",{get:function(){return this._onComplete},set:function(v){this._onComplete=v},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(v){this._onRedirect=v},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(v){this._onRecoveredEarlyEof=v},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentSpeed",{get:function(){return this._loaderClass===p.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),x.prototype._selectSeekHandler=function(){var v=this._config;if(v.seekType==="range")this._seekHandler=new y.default(this._config.rangeLoadZeroStart);else if(v.seekType==="param"){var T=v.seekParamStart||"bstart",C=v.seekParamEnd||"bend";this._seekHandler=new E.default(T,C)}else if(v.seekType==="custom"){if(typeof v.customSeekHandler!="function")throw new A.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new v.customSeekHandler}else throw new A.InvalidArgumentException("Invalid seekType in config: "+v.seekType)},x.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=m.default;else if(h.default.isSupported())this._loaderClass=h.default;else if(g.default.isSupported())this._loaderClass=g.default;else if(p.default.isSupported())this._loaderClass=p.default;else throw new A.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},x.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},x.prototype.open=function(v){this._currentRange={from:0,to:-1},v&&(this._currentRange.from=v),this._speedSampler.reset(),v||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},x.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},x.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},x.prototype.resume=function(){if(this._paused){this._paused=!1;var v=this._resumeFrom;this._resumeFrom=0,this._internalSeek(v,!0)}},x.prototype.seek=function(v){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(v,!0)},x.prototype._internalSeek=function(v,T){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(T),this._loader.destroy(),this._loader=null;var C={from:v,to:-1};this._currentRange={from:C.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,C),this._onSeeked&&this._onSeeked()},x.prototype.updateUrl=function(v){if(!v||typeof v!="string"||v.length===0)throw new A.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=v},x.prototype._expandBuffer=function(v){for(var T=this._stashSize;T+1024*1024*1<v;)T*=2;if(T+=1024*1024*1,T!==this._bufferSize){var C=new ArrayBuffer(T);if(this._stashUsed>0){var k=new Uint8Array(this._stashBuffer,0,this._stashUsed),B=new Uint8Array(C,0,T);B.set(k,0)}this._stashBuffer=C,this._bufferSize=T}},x.prototype._normalizeSpeed=function(v){var T=this._speedNormalizeList,C=T.length-1,k=0,B=0,R=C;if(v<T[0])return T[0];for(;B<=R;){if(k=B+Math.floor((R-B)/2),k===C||v>=T[k]&&v<T[k+1])return T[k];T[k]<v?B=k+1:R=k-1}},x.prototype._adjustStashSize=function(v){var T=0;this._config.isLive||v<512?T=v:v>=512&&v<=1024?T=Math.floor(v*1.5):T=v*2,T>8192&&(T=8192);var C=T*1024+1024*1024*1;this._bufferSize<C&&this._expandBuffer(C),this._stashSize=T*1024},x.prototype._dispatchChunks=function(v,T){return this._currentRange.to=T+v.byteLength-1,this._onDataArrival(v,T)},x.prototype._onURLRedirect=function(v){this._redirectedURL=v,this._onRedirect&&this._onRedirect(v)},x.prototype._onContentLengthKnown=function(v){v&&this._fullRequestFlag&&(this._totalLength=v,this._fullRequestFlag=!1)},x.prototype._onLoaderChunkArrival=function(v,T,C){if(!this._onDataArrival)throw new A.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(v.byteLength);var k=this._speedSampler.lastSecondKBps;if(k!==0){var B=this._normalizeSpeed(k);this._speedNormalized!==B&&(this._speedNormalized=B,this._adjustStashSize(B))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=T),this._stashUsed+v.byteLength<=this._stashSize){var S=new Uint8Array(this._stashBuffer,0,this._stashSize);S.set(new Uint8Array(v),this._stashUsed),this._stashUsed+=v.byteLength}else{var S=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var b=this._stashBuffer.slice(0,this._stashUsed),R=this._dispatchChunks(b,this._stashByteStart);if(R<b.byteLength){if(R>0){var L=new Uint8Array(b,R);S.set(L,0),this._stashUsed=L.byteLength,this._stashByteStart+=R}}else this._stashUsed=0,this._stashByteStart+=R;this._stashUsed+v.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+v.byteLength),S=new Uint8Array(this._stashBuffer,0,this._bufferSize)),S.set(new Uint8Array(v),this._stashUsed),this._stashUsed+=v.byteLength}else{var R=this._dispatchChunks(v,T);if(R<v.byteLength){var I=v.byteLength-R;I>this._bufferSize&&(this._expandBuffer(I),S=new Uint8Array(this._stashBuffer,0,this._bufferSize)),S.set(new Uint8Array(v,R),0),this._stashUsed+=I,this._stashByteStart=T+R}}}else if(this._stashUsed===0){var R=this._dispatchChunks(v,T);if(R<v.byteLength){var I=v.byteLength-R;I>this._bufferSize&&this._expandBuffer(I);var S=new Uint8Array(this._stashBuffer,0,this._bufferSize);S.set(new Uint8Array(v,R),0),this._stashUsed+=I,this._stashByteStart=T+R}}else{this._stashUsed+v.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+v.byteLength);var S=new Uint8Array(this._stashBuffer,0,this._bufferSize);S.set(new Uint8Array(v),this._stashUsed),this._stashUsed+=v.byteLength;var R=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(R<this._stashUsed&&R>0){var L=new Uint8Array(this._stashBuffer,R);S.set(L,0)}this._stashUsed-=R,this._stashByteStart+=R}}},x.prototype._flushStashBuffer=function(v){if(this._stashUsed>0){var T=this._stashBuffer.slice(0,this._stashUsed),C=this._dispatchChunks(T,this._stashByteStart),k=T.byteLength-C;if(C<T.byteLength)if(v)c.default.w(this.TAG,k+" bytes unconsumed data remain when flush buffer, dropped");else{if(C>0){var B=new Uint8Array(this._stashBuffer,0,this._bufferSize),R=new Uint8Array(T,C);B.set(R,0),this._stashUsed=R.byteLength,this._stashByteStart+=C}return 0}return this._stashUsed=0,this._stashByteStart=0,k}return 0},x.prototype._onLoaderComplete=function(v,T){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},x.prototype._onLoaderError=function(v,T){switch(c.default.e(this.TAG,"Loader error, code = "+T.code+", msg = "+T.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,v=f.LoaderErrors.UNRECOVERABLE_EARLY_EOF),v){case f.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var C=this._currentRange.to+1;C<this._totalLength&&(c.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(C,!1));return}v=f.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case f.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case f.LoaderErrors.CONNECTING_TIMEOUT:case f.LoaderErrors.HTTP_STATUS_CODE_INVALID:case f.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(v,T);else throw new A.RuntimeException("IOException: "+T.msg)},x}();a.default=_},"./src/io/loader.js":function(o,a,l){l.r(a),l.d(a,{LoaderStatus:function(){return d},LoaderErrors:function(){return f},BaseLoader:function(){return h}});var c=l("./src/utils/exception.js"),d={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},f={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},h=function(){function g(p){this._type=p||"undefined",this._status=d.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return g.prototype.destroy=function(){this._status=d.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},g.prototype.isWorking=function(){return this._status===d.kConnecting||this._status===d.kBuffering},Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(p){this._onContentLengthKnown=p},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(p){this._onURLRedirect=p},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(p){this._onDataArrival=p},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onError",{get:function(){return this._onError},set:function(p){this._onError=p},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onComplete",{get:function(){return this._onComplete},set:function(p){this._onComplete=p},enumerable:!1,configurable:!0}),g.prototype.open=function(p,m){throw new c.NotImplementedException("Unimplemented abstract function!")},g.prototype.abort=function(){throw new c.NotImplementedException("Unimplemented abstract function!")},g}()},"./src/io/param-seek-handler.js":function(o,a,l){l.r(a);var c=function(){function d(f,h){this._startName=f,this._endName=h}return d.prototype.getConfig=function(f,h){var g=f;if(h.from!==0||h.to!==-1){var p=!0;g.indexOf("?")===-1&&(g+="?",p=!1),p&&(g+="&"),g+=this._startName+"="+h.from.toString(),h.to!==-1&&(g+="&"+this._endName+"="+h.to.toString())}return{url:g,headers:{}}},d.prototype.removeURLParameters=function(f){var h=f.split("?")[0],g=void 0,p=f.indexOf("?");p!==-1&&(g=f.substring(p+1));var m="";if(g!=null&&g.length>0)for(var y=g.split("&"),E=0;E<y.length;E++){var A=y[E].split("="),_=E>0;A[0]!==this._startName&&A[0]!==this._endName&&(_&&(m+="&"),m+=y[E])}return m.length===0?h:h+"?"+m},d}();a.default=c},"./src/io/range-seek-handler.js":function(o,a,l){l.r(a);var c=function(){function d(f){this._zeroStart=f||!1}return d.prototype.getConfig=function(f,h){var g={};if(h.from!==0||h.to!==-1){var p=void 0;h.to!==-1?p="bytes="+h.from.toString()+"-"+h.to.toString():p="bytes="+h.from.toString()+"-",g.Range=p}else this._zeroStart&&(g.Range="bytes=0-");return{url:f,headers:g}},d.prototype.removeURLParameters=function(f){return f},d}();a.default=c},"./src/io/speed-sampler.js":function(o,a,l){l.r(a);var c=function(){function d(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return d.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},d.prototype.addBytes=function(f){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=f,this._totalBytes+=f):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=f,this._totalBytes+=f):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=f,this._totalBytes+=f,this._lastCheckpoint=this._now())},Object.defineProperty(d.prototype,"currentKBps",{get:function(){this.addBytes(0);var f=(this._now()-this._lastCheckpoint)/1e3;return f==0&&(f=1),this._intervalBytes/f/1024},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"averageKBps",{get:function(){var f=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/f/1024},enumerable:!1,configurable:!0}),d}();a.default=c},"./src/io/websocket-loader.js":function(o,a,l){l.r(a);var c=l("./src/io/loader.js"),d=l("./src/utils/exception.js"),f=function(){var g=function(p,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,E){y.__proto__=E}||function(y,E){for(var A in E)Object.prototype.hasOwnProperty.call(E,A)&&(y[A]=E[A])},g(p,m)};return function(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");g(p,m);function y(){this.constructor=p}p.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}(),h=function(g){f(p,g);function p(){var m=g.call(this,"websocket-loader")||this;return m.TAG="WebSocketLoader",m._needStash=!0,m._ws=null,m._requestAbort=!1,m._receivedLength=0,m}return p.isSupported=function(){try{return typeof self.WebSocket<"u"}catch{return!1}},p.prototype.destroy=function(){this._ws&&this.abort(),g.prototype.destroy.call(this)},p.prototype.open=function(m){try{var y=this._ws=new self.WebSocket(m.url);y.binaryType="arraybuffer",y.onopen=this._onWebSocketOpen.bind(this),y.onclose=this._onWebSocketClose.bind(this),y.onmessage=this._onWebSocketMessage.bind(this),y.onerror=this._onWebSocketError.bind(this),this._status=c.LoaderStatus.kConnecting}catch(A){this._status=c.LoaderStatus.kError;var E={code:A.code,msg:A.message};if(this._onError)this._onError(c.LoaderErrors.EXCEPTION,E);else throw new d.RuntimeException(E.msg)}},p.prototype.abort=function(){var m=this._ws;m&&(m.readyState===0||m.readyState===1)&&(this._requestAbort=!0,m.close()),this._ws=null,this._status=c.LoaderStatus.kComplete},p.prototype._onWebSocketOpen=function(m){this._status=c.LoaderStatus.kBuffering},p.prototype._onWebSocketClose=function(m){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=c.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},p.prototype._onWebSocketMessage=function(m){var y=this;if(m.data instanceof ArrayBuffer)this._dispatchArrayBuffer(m.data);else if(m.data instanceof Blob){var E=new FileReader;E.onload=function(){y._dispatchArrayBuffer(E.result)},E.readAsArrayBuffer(m.data)}else{this._status=c.LoaderStatus.kError;var A={code:-1,msg:"Unsupported WebSocket message type: "+m.data.constructor.name};if(this._onError)this._onError(c.LoaderErrors.EXCEPTION,A);else throw new d.RuntimeException(A.msg)}},p.prototype._dispatchArrayBuffer=function(m){var y=m,E=this._receivedLength;this._receivedLength+=y.byteLength,this._onDataArrival&&this._onDataArrival(y,E,this._receivedLength)},p.prototype._onWebSocketError=function(m){this._status=c.LoaderStatus.kError;var y={code:m.code,msg:m.message};if(this._onError)this._onError(c.LoaderErrors.EXCEPTION,y);else throw new d.RuntimeException(y.msg)},p}(c.BaseLoader);a.default=h},"./src/io/xhr-moz-chunked-loader.js":function(o,a,l){l.r(a);var c=l("./src/utils/logger.js"),d=l("./src/io/loader.js"),f=l("./src/utils/exception.js"),h=function(){var p=function(m,y){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,A){E.__proto__=A}||function(E,A){for(var _ in A)Object.prototype.hasOwnProperty.call(A,_)&&(E[_]=A[_])},p(m,y)};return function(m,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");p(m,y);function E(){this.constructor=m}m.prototype=y===null?Object.create(y):(E.prototype=y.prototype,new E)}}(),g=function(p){h(m,p);function m(y,E){var A=p.call(this,"xhr-moz-chunked-loader")||this;return A.TAG="MozChunkedLoader",A._seekHandler=y,A._config=E,A._needStash=!0,A._xhr=null,A._requestAbort=!1,A._contentLength=null,A._receivedLength=0,A}return m.isSupported=function(){try{var y=new XMLHttpRequest;return y.open("GET","https://example.com",!0),y.responseType="moz-chunked-arraybuffer",y.responseType==="moz-chunked-arraybuffer"}catch(E){return c.default.w("MozChunkedLoader",E.message),!1}},m.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),p.prototype.destroy.call(this)},m.prototype.open=function(y,E){this._dataSource=y,this._range=E;var A=y.url;this._config.reuseRedirectedURL&&y.redirectedURL!=null&&(A=y.redirectedURL);var _=this._seekHandler.getConfig(A,E);this._requestURL=_.url;var x=this._xhr=new XMLHttpRequest;if(x.open("GET",_.url,!0),x.responseType="moz-chunked-arraybuffer",x.onreadystatechange=this._onReadyStateChange.bind(this),x.onprogress=this._onProgress.bind(this),x.onloadend=this._onLoadEnd.bind(this),x.onerror=this._onXhrError.bind(this),y.withCredentials&&(x.withCredentials=!0),typeof _.headers=="object"){var v=_.headers;for(var T in v)v.hasOwnProperty(T)&&x.setRequestHeader(T,v[T])}if(typeof this._config.headers=="object"){var v=this._config.headers;for(var T in v)v.hasOwnProperty(T)&&x.setRequestHeader(T,v[T])}this._status=d.LoaderStatus.kConnecting,x.send()},m.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=d.LoaderStatus.kComplete},m.prototype._onReadyStateChange=function(y){var E=y.target;if(E.readyState===2){if(E.responseURL!=null&&E.responseURL!==this._requestURL&&this._onURLRedirect){var A=this._seekHandler.removeURLParameters(E.responseURL);this._onURLRedirect(A)}if(E.status!==0&&(E.status<200||E.status>299))if(this._status=d.LoaderStatus.kError,this._onError)this._onError(d.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:E.status,msg:E.statusText});else throw new f.RuntimeException("MozChunkedLoader: Http code invalid, "+E.status+" "+E.statusText);else this._status=d.LoaderStatus.kBuffering}},m.prototype._onProgress=function(y){if(this._status!==d.LoaderStatus.kError){this._contentLength===null&&y.total!==null&&y.total!==0&&(this._contentLength=y.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var E=y.target.response,A=this._range.from+this._receivedLength;this._receivedLength+=E.byteLength,this._onDataArrival&&this._onDataArrival(E,A,this._receivedLength)}},m.prototype._onLoadEnd=function(y){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===d.LoaderStatus.kError)return;this._status=d.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},m.prototype._onXhrError=function(y){this._status=d.LoaderStatus.kError;var E=0,A=null;if(this._contentLength&&y.loaded<this._contentLength?(E=d.LoaderErrors.EARLY_EOF,A={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(E=d.LoaderErrors.EXCEPTION,A={code:-1,msg:y.constructor.name+" "+y.type}),this._onError)this._onError(E,A);else throw new f.RuntimeException(A.msg)},m}(d.BaseLoader);a.default=g},"./src/io/xhr-range-loader.js":function(o,a,l){l.r(a);var c=l("./src/utils/logger.js"),d=l("./src/io/speed-sampler.js"),f=l("./src/io/loader.js"),h=l("./src/utils/exception.js"),g=function(){var m=function(y,E){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,_){A.__proto__=_}||function(A,_){for(var x in _)Object.prototype.hasOwnProperty.call(_,x)&&(A[x]=_[x])},m(y,E)};return function(y,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");m(y,E);function A(){this.constructor=y}y.prototype=E===null?Object.create(E):(A.prototype=E.prototype,new A)}}(),p=function(m){g(y,m);function y(E,A){var _=m.call(this,"xhr-range-loader")||this;return _.TAG="RangeLoader",_._seekHandler=E,_._config=A,_._needStash=!1,_._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],_._currentChunkSizeKB=384,_._currentSpeedNormalized=0,_._zeroSpeedChunkCount=0,_._xhr=null,_._speedSampler=new d.default,_._requestAbort=!1,_._waitForTotalLength=!1,_._totalLengthReceived=!1,_._currentRequestURL=null,_._currentRedirectedURL=null,_._currentRequestRange=null,_._totalLength=null,_._contentLength=null,_._receivedLength=0,_._lastTimeLoaded=0,_}return y.isSupported=function(){try{var E=new XMLHttpRequest;return E.open("GET","https://example.com",!0),E.responseType="arraybuffer",E.responseType==="arraybuffer"}catch(A){return c.default.w("RangeLoader",A.message),!1}},y.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),m.prototype.destroy.call(this)},Object.defineProperty(y.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),y.prototype.open=function(E,A){this._dataSource=E,this._range=A,this._status=f.LoaderStatus.kConnecting;var _=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(_=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!_?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},y.prototype._openSubRange=function(){var E=this._currentChunkSizeKB*1024,A=this._range.from+this._receivedLength,_=A+E;this._contentLength!=null&&_-this._range.from>=this._contentLength&&(_=this._range.from+this._contentLength-1),this._currentRequestRange={from:A,to:_},this._internalOpen(this._dataSource,this._currentRequestRange)},y.prototype._internalOpen=function(E,A){this._lastTimeLoaded=0;var _=E.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?_=this._currentRedirectedURL:E.redirectedURL!=null&&(_=E.redirectedURL));var x=this._seekHandler.getConfig(_,A);this._currentRequestURL=x.url;var v=this._xhr=new XMLHttpRequest;if(v.open("GET",x.url,!0),v.responseType="arraybuffer",v.onreadystatechange=this._onReadyStateChange.bind(this),v.onprogress=this._onProgress.bind(this),v.onload=this._onLoad.bind(this),v.onerror=this._onXhrError.bind(this),E.withCredentials&&(v.withCredentials=!0),typeof x.headers=="object"){var T=x.headers;for(var C in T)T.hasOwnProperty(C)&&v.setRequestHeader(C,T[C])}if(typeof this._config.headers=="object"){var T=this._config.headers;for(var C in T)T.hasOwnProperty(C)&&v.setRequestHeader(C,T[C])}v.send()},y.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=f.LoaderStatus.kComplete},y.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},y.prototype._onReadyStateChange=function(E){var A=E.target;if(A.readyState===2){if(A.responseURL!=null){var _=this._seekHandler.removeURLParameters(A.responseURL);A.responseURL!==this._currentRequestURL&&_!==this._currentRedirectedURL&&(this._currentRedirectedURL=_,this._onURLRedirect&&this._onURLRedirect(_))}if(A.status>=200&&A.status<=299){if(this._waitForTotalLength)return;this._status=f.LoaderStatus.kBuffering}else if(this._status=f.LoaderStatus.kError,this._onError)this._onError(f.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:A.status,msg:A.statusText});else throw new h.RuntimeException("RangeLoader: Http code invalid, "+A.status+" "+A.statusText)}},y.prototype._onProgress=function(E){if(this._status!==f.LoaderStatus.kError){if(this._contentLength===null){var A=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,A=!0;var _=E.total;this._internalAbort(),_!=null&_!==0&&(this._totalLength=_)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,A){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var x=E.loaded-this._lastTimeLoaded;this._lastTimeLoaded=E.loaded,this._speedSampler.addBytes(x)}},y.prototype._normalizeSpeed=function(E){var A=this._chunkSizeKBList,_=A.length-1,x=0,v=0,T=_;if(E<A[0])return A[0];for(;v<=T;){if(x=v+Math.floor((T-v)/2),x===_||E>=A[x]&&E<A[x+1])return A[x];A[x]<E?v=x+1:T=x-1}},y.prototype._onLoad=function(E){if(this._status!==f.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var A=this._speedSampler.lastSecondKBps;if(A===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(A=this._speedSampler.currentKBps)),A!==0){var _=this._normalizeSpeed(A);this._currentSpeedNormalized!==_&&(this._currentSpeedNormalized=_,this._currentChunkSizeKB=_)}var x=E.target.response,v=this._range.from+this._receivedLength;this._receivedLength+=x.byteLength;var T=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():T=!0,this._onDataArrival&&this._onDataArrival(x,v,this._receivedLength),T&&(this._status=f.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},y.prototype._onXhrError=function(E){this._status=f.LoaderStatus.kError;var A=0,_=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(A=f.LoaderErrors.EARLY_EOF,_={code:-1,msg:"RangeLoader meet Early-Eof"}):(A=f.LoaderErrors.EXCEPTION,_={code:-1,msg:E.constructor.name+" "+E.type}),this._onError)this._onError(A,_);else throw new h.RuntimeException(_.msg)},y}(f.BaseLoader);a.default=p},"./src/player/flv-player.js":function(o,a,l){l.r(a);var c=l("./node_modules/events/events.js"),d=l.n(c),f=l("./src/utils/logger.js"),h=l("./src/utils/browser.js"),g=l("./src/player/player-events.js"),p=l("./src/core/transmuxer.js"),m=l("./src/core/transmuxing-events.js"),y=l("./src/core/mse-controller.js"),E=l("./src/core/mse-events.js"),A=l("./src/player/player-errors.js"),_=l("./src/config.js"),x=l("./src/utils/exception.js"),v=function(){function T(C,k){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(d()),this._config=(0,_.createDefaultConfig)(),typeof k=="object"&&Object.assign(this._config,k),C.type.toLowerCase()!=="flv")throw new x.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");C.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=C,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var B=h.default.chrome&&(h.default.version.major<50||h.default.version.major===50&&h.default.version.build<2661);this._alwaysSeekKeyframe=!!(B||h.default.msedge||h.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return T.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},T.prototype.on=function(C,k){var B=this;C===g.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){B._emitter.emit(g.default.MEDIA_INFO,B.mediaInfo)}):C===g.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){B._emitter.emit(g.default.STATISTICS_INFO,B.statisticsInfo)}),this._emitter.addListener(C,k)},T.prototype.off=function(C,k){this._emitter.removeListener(C,k)},T.prototype.attachMediaElement=function(C){var k=this;if(this._mediaElement=C,C.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),C.addEventListener("seeking",this.e.onvSeeking),C.addEventListener("canplay",this.e.onvCanPlay),C.addEventListener("stalled",this.e.onvStalled),C.addEventListener("progress",this.e.onvProgress),this._msectl=new y.default(this._config),this._msectl.on(E.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(E.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(E.default.SOURCE_OPEN,function(){k._mseSourceOpened=!0,k._hasPendingLoad&&(k._hasPendingLoad=!1,k.load())}),this._msectl.on(E.default.ERROR,function(B){k._emitter.emit(g.default.ERROR,A.ErrorTypes.MEDIA_ERROR,A.ErrorDetails.MEDIA_MSE_ERROR,B)}),this._msectl.attachMediaElement(C),this._pendingSeekTime!=null)try{C.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},T.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},T.prototype.load=function(){var C=this;if(!this._mediaElement)throw new x.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new x.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new p.default(this._mediaDataSource,this._config),this._transmuxer.on(m.default.INIT_SEGMENT,function(k,B){C._msectl.appendInitSegment(B)}),this._transmuxer.on(m.default.MEDIA_SEGMENT,function(k,B){if(C._msectl.appendMediaSegment(B),C._config.lazyLoad&&!C._config.isLive){var R=C._mediaElement.currentTime;B.info.endDts>=(R+C._config.lazyLoadMaxDuration)*1e3&&C._progressChecker==null&&(f.default.v(C.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),C._suspendTransmuxer())}}),this._transmuxer.on(m.default.LOADING_COMPLETE,function(){C._msectl.endOfStream(),C._emitter.emit(g.default.LOADING_COMPLETE)}),this._transmuxer.on(m.default.RECOVERED_EARLY_EOF,function(){C._emitter.emit(g.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(m.default.IO_ERROR,function(k,B){C._emitter.emit(g.default.ERROR,A.ErrorTypes.NETWORK_ERROR,k,B)}),this._transmuxer.on(m.default.DEMUX_ERROR,function(k,B){C._emitter.emit(g.default.ERROR,A.ErrorTypes.MEDIA_ERROR,k,{code:-1,msg:B})}),this._transmuxer.on(m.default.MEDIA_INFO,function(k){C._mediaInfo=k,C._emitter.emit(g.default.MEDIA_INFO,Object.assign({},k))}),this._transmuxer.on(m.default.METADATA_ARRIVED,function(k){C._emitter.emit(g.default.METADATA_ARRIVED,k)}),this._transmuxer.on(m.default.SCRIPTDATA_ARRIVED,function(k){C._emitter.emit(g.default.SCRIPTDATA_ARRIVED,k)}),this._transmuxer.on(m.default.STATISTICS_INFO,function(k){C._statisticsInfo=C._fillStatisticsInfo(k),C._emitter.emit(g.default.STATISTICS_INFO,Object.assign({},C._statisticsInfo))}),this._transmuxer.on(m.default.RECOMMEND_SEEKPOINT,function(k){C._mediaElement&&!C._config.accurateSeek&&(C._requestSetTime=!0,C._mediaElement.currentTime=k/1e3)}),this._transmuxer.open()}},T.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},T.prototype.play=function(){return this._mediaElement.play()},T.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(T.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(C){this._mediaElement.volume=C},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(C){this._mediaElement.muted=C},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(C){this._mediaElement?this._internalSeek(C):this._pendingSeekTime=C},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),T.prototype._fillStatisticsInfo=function(C){if(C.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return C;var k=!0,B=0,R=0;if(this._mediaElement.getVideoPlaybackQuality){var I=this._mediaElement.getVideoPlaybackQuality();B=I.totalVideoFrames,R=I.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(B=this._mediaElement.webkitDecodedFrameCount,R=this._mediaElement.webkitDroppedFrameCount):k=!1;return k&&(C.decodedFrames=B,C.droppedFrames=R),C},T.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var C=this._mediaElement.buffered,k=this._mediaElement.currentTime,B=0,R=0;R<C.length;R++){var I=C.start(R),S=C.end(R);if(I<=k&&k<S){B=S;break}}B>=k+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(f.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},T.prototype._onmseBufferFull=function(){f.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},T.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},T.prototype._checkProgressAndResume=function(){for(var C=this._mediaElement.currentTime,k=this._mediaElement.buffered,B=!1,R=0;R<k.length;R++){var I=k.start(R),S=k.end(R);if(C>=I&&C<S){C>=S-this._config.lazyLoadRecoverDuration&&(B=!0);break}}B&&(window.clearInterval(this._progressChecker),this._progressChecker=null,B&&(f.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},T.prototype._isTimepointBuffered=function(C){for(var k=this._mediaElement.buffered,B=0;B<k.length;B++){var R=k.start(B),I=k.end(B);if(C>=R&&C<I)return!0}return!1},T.prototype._internalSeek=function(C){var k=this._isTimepointBuffered(C),B=!1,R=0;if(C<1&&this._mediaElement.buffered.length>0){var I=this._mediaElement.buffered.start(0);(I<1&&C<I||h.default.safari)&&(B=!0,R=h.default.safari?.1:I)}if(B)this._requestSetTime=!0,this._mediaElement.currentTime=R;else if(k){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=C;else{var S=this._msectl.getNearestKeyframe(Math.floor(C*1e3));this._requestSetTime=!0,S!=null?this._mediaElement.currentTime=S.dts/1e3:this._mediaElement.currentTime=C}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(C),this._transmuxer.seek(Math.floor(C*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=C)},T.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var C=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(C)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(C),this._transmuxer.seek(Math.floor(C*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=C))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},T.prototype._checkAndResumeStuckPlayback=function(C){var k=this._mediaElement;if(C||!this._receivedCanPlay||k.readyState<2){var B=k.buffered;B.length>0&&k.currentTime<B.start(0)&&(f.default.w(this.TAG,"Playback seems stuck at "+k.currentTime+", seek to "+B.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=B.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},T.prototype._onvLoadedMetadata=function(C){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},T.prototype._onvSeeking=function(C){var k=this._mediaElement.currentTime,B=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(k<1&&B.length>0){var R=B.start(0);if(R<1&&k<R||h.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=h.default.safari?.1:R;return}}if(this._isTimepointBuffered(k)){if(this._alwaysSeekKeyframe){var I=this._msectl.getNearestKeyframe(Math.floor(k*1e3));I!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=I.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:k,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},T.prototype._onvCanPlay=function(C){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},T.prototype._onvStalled=function(C){this._checkAndResumeStuckPlayback(!0)},T.prototype._onvProgress=function(C){this._checkAndResumeStuckPlayback()},T}();a.default=v},"./src/player/native-player.js":function(o,a,l){l.r(a);var c=l("./node_modules/events/events.js"),d=l.n(c),f=l("./src/player/player-events.js"),h=l("./src/config.js"),g=l("./src/utils/exception.js"),p=function(){function m(y,E){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(d()),this._config=(0,h.createDefaultConfig)(),typeof E=="object"&&Object.assign(this._config,E),y.type.toLowerCase()==="flv")throw new g.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(y.hasOwnProperty("segments"))throw new g.InvalidArgumentException("NativePlayer("+y.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=y,this._mediaElement=null}return m.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},m.prototype.on=function(y,E){var A=this;y===f.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){A._emitter.emit(f.default.MEDIA_INFO,A.mediaInfo)}):y===f.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){A._emitter.emit(f.default.STATISTICS_INFO,A.statisticsInfo)}),this._emitter.addListener(y,E)},m.prototype.off=function(y,E){this._emitter.removeListener(y,E)},m.prototype.attachMediaElement=function(y){if(this._mediaElement=y,y.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{y.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},m.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},m.prototype.load=function(){if(!this._mediaElement)throw new g.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},m.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},m.prototype.play=function(){return this._mediaElement.play()},m.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(m.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(y){this._mediaElement.volume=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(y){this._mediaElement.muted=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(y){this._mediaElement?this._mediaElement.currentTime=y:this._pendingSeekTime=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"mediaInfo",{get:function(){var y=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",E={mimeType:y+this._mediaDataSource.type};return this._mediaElement&&(E.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(E.width=this._mediaElement.videoWidth,E.height=this._mediaElement.videoHeight)),E},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"statisticsInfo",{get:function(){var y={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return y;var E=!0,A=0,_=0;if(this._mediaElement.getVideoPlaybackQuality){var x=this._mediaElement.getVideoPlaybackQuality();A=x.totalVideoFrames,_=x.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(A=this._mediaElement.webkitDecodedFrameCount,_=this._mediaElement.webkitDroppedFrameCount):E=!1;return E&&(y.decodedFrames=A,y.droppedFrames=_),y},enumerable:!1,configurable:!0}),m.prototype._onvLoadedMetadata=function(y){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(f.default.MEDIA_INFO,this.mediaInfo)},m.prototype._reportStatisticsInfo=function(){this._emitter.emit(f.default.STATISTICS_INFO,this.statisticsInfo)},m}();a.default=p},"./src/player/player-errors.js":function(o,a,l){l.r(a),l.d(a,{ErrorTypes:function(){return f},ErrorDetails:function(){return h}});var c=l("./src/io/loader.js"),d=l("./src/demux/demux-errors.js"),f={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},h={NETWORK_EXCEPTION:c.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:c.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:c.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:c.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:d.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:d.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:d.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(o,a,l){l.r(a);var c={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};a.default=c},"./src/remux/aac-silent.js":function(o,a,l){l.r(a);var c=function(){function d(){}return d.getSilentFrame=function(f,h){if(f==="mp4a.40.2"){if(h===1)return new Uint8Array([0,200,0,128,35,128]);if(h===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(h===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(h===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(h===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(h===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(h===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(h===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(h===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},d}();a.default=c},"./src/remux/mp4-generator.js":function(o,a,l){l.r(a);var c=function(){function d(){}return d.init=function(){d.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var f in d.types)d.types.hasOwnProperty(f)&&(d.types[f]=[f.charCodeAt(0),f.charCodeAt(1),f.charCodeAt(2),f.charCodeAt(3)]);var h=d.constants={};h.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),h.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),h.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),h.STSC=h.STCO=h.STTS,h.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),h.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),h.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),h.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),h.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),h.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},d.box=function(f){for(var h=8,g=null,p=Array.prototype.slice.call(arguments,1),m=p.length,y=0;y<m;y++)h+=p[y].byteLength;g=new Uint8Array(h),g[0]=h>>>24&255,g[1]=h>>>16&255,g[2]=h>>>8&255,g[3]=h&255,g.set(f,4);for(var E=8,y=0;y<m;y++)g.set(p[y],E),E+=p[y].byteLength;return g},d.generateInitSegment=function(f){var h=d.box(d.types.ftyp,d.constants.FTYP),g=d.moov(f),p=new Uint8Array(h.byteLength+g.byteLength);return p.set(h,0),p.set(g,h.byteLength),p},d.moov=function(f){var h=d.mvhd(f.timescale,f.duration),g=d.trak(f),p=d.mvex(f);return d.box(d.types.moov,h,g,p)},d.mvhd=function(f,h){return d.box(d.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},d.trak=function(f){return d.box(d.types.trak,d.tkhd(f),d.mdia(f))},d.tkhd=function(f){var h=f.id,g=f.duration,p=f.presentWidth,m=f.presentHeight;return d.box(d.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,h>>>24&255,h>>>16&255,h>>>8&255,h&255,0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,p>>>8&255,p&255,0,0,m>>>8&255,m&255,0,0]))},d.mdia=function(f){return d.box(d.types.mdia,d.mdhd(f),d.hdlr(f),d.minf(f))},d.mdhd=function(f){var h=f.timescale,g=f.duration;return d.box(d.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,h>>>24&255,h>>>16&255,h>>>8&255,h&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,85,196,0,0]))},d.hdlr=function(f){var h=null;return f.type==="audio"?h=d.constants.HDLR_AUDIO:h=d.constants.HDLR_VIDEO,d.box(d.types.hdlr,h)},d.minf=function(f){var h=null;return f.type==="audio"?h=d.box(d.types.smhd,d.constants.SMHD):h=d.box(d.types.vmhd,d.constants.VMHD),d.box(d.types.minf,h,d.dinf(),d.stbl(f))},d.dinf=function(){var f=d.box(d.types.dinf,d.box(d.types.dref,d.constants.DREF));return f},d.stbl=function(f){var h=d.box(d.types.stbl,d.stsd(f),d.box(d.types.stts,d.constants.STTS),d.box(d.types.stsc,d.constants.STSC),d.box(d.types.stsz,d.constants.STSZ),d.box(d.types.stco,d.constants.STCO));return h},d.stsd=function(f){return f.type==="audio"?f.codec==="mp3"?d.box(d.types.stsd,d.constants.STSD_PREFIX,d.mp3(f)):d.box(d.types.stsd,d.constants.STSD_PREFIX,d.mp4a(f)):d.box(d.types.stsd,d.constants.STSD_PREFIX,d.avc1(f))},d.mp3=function(f){var h=f.channelCount,g=f.audioSampleRate,p=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return d.box(d.types[".mp3"],p)},d.mp4a=function(f){var h=f.channelCount,g=f.audioSampleRate,p=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return d.box(d.types.mp4a,p,d.esds(f))},d.esds=function(f){var h=f.config||[],g=h.length,p=new Uint8Array([0,0,0,0,3,23+g,0,1,0,4,15+g,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([g]).concat(h).concat([6,1,2]));return d.box(d.types.esds,p)},d.avc1=function(f){var h=f.avcc,g=f.codecWidth,p=f.codecHeight,m=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>>8&255,g&255,p>>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return d.box(d.types.avc1,m,d.box(d.types.avcC,h))},d.mvex=function(f){return d.box(d.types.mvex,d.trex(f))},d.trex=function(f){var h=f.id,g=new Uint8Array([0,0,0,0,h>>>24&255,h>>>16&255,h>>>8&255,h&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return d.box(d.types.trex,g)},d.moof=function(f,h){return d.box(d.types.moof,d.mfhd(f.sequenceNumber),d.traf(f,h))},d.mfhd=function(f){var h=new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255]);return d.box(d.types.mfhd,h)},d.traf=function(f,h){var g=f.id,p=d.box(d.types.tfhd,new Uint8Array([0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255])),m=d.box(d.types.tfdt,new Uint8Array([0,0,0,0,h>>>24&255,h>>>16&255,h>>>8&255,h&255])),y=d.sdtp(f),E=d.trun(f,y.byteLength+16+16+8+16+8+8);return d.box(d.types.traf,p,m,E,y)},d.sdtp=function(f){for(var h=f.samples||[],g=h.length,p=new Uint8Array(4+g),m=0;m<g;m++){var y=h[m].flags;p[m+4]=y.isLeading<<6|y.dependsOn<<4|y.isDependedOn<<2|y.hasRedundancy}return d.box(d.types.sdtp,p)},d.trun=function(f,h){var g=f.samples||[],p=g.length,m=12+16*p,y=new Uint8Array(m);h+=8+m,y.set([0,0,15,1,p>>>24&255,p>>>16&255,p>>>8&255,p&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255],0);for(var E=0;E<p;E++){var A=g[E].duration,_=g[E].size,x=g[E].flags,v=g[E].cts;y.set([A>>>24&255,A>>>16&255,A>>>8&255,A&255,_>>>24&255,_>>>16&255,_>>>8&255,_&255,x.isLeading<<2|x.dependsOn,x.isDependedOn<<6|x.hasRedundancy<<4|x.isNonSync,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255],12+16*E)}return d.box(d.types.trun,y)},d.mdat=function(f){return d.box(d.types.mdat,f)},d}();c.init(),a.default=c},"./src/remux/mp4-remuxer.js":function(o,a,l){l.r(a);var c=l("./src/utils/logger.js"),d=l("./src/remux/mp4-generator.js"),f=l("./src/remux/aac-silent.js"),h=l("./src/utils/browser.js"),g=l("./src/core/media-segment-info.js"),p=l("./src/utils/exception.js"),m=function(){function y(E){this.TAG="MP4Remuxer",this._config=E,this._isLive=E.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new g.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new g.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(h.default.chrome&&(h.default.version.major<50||h.default.version.major===50&&h.default.version.build<2661)),this._fillSilentAfterSeek=h.default.msedge||h.default.msie,this._mp3UseMpegAudio=!h.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return y.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},y.prototype.bindDataSource=function(E){return E.onDataAvailable=this.remux.bind(this),E.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(y.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(E){this._onInitSegment=E},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(E){this._onMediaSegment=E},enumerable:!1,configurable:!0}),y.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},y.prototype.seek=function(E){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},y.prototype.remux=function(E,A){if(!this._onMediaSegment)throw new p.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(E,A),this._remuxVideo(A),this._remuxAudio(E)},y.prototype._onTrackMetadataReceived=function(E,A){var _=null,x="mp4",v=A.codec;if(E==="audio")this._audioMeta=A,A.codec==="mp3"&&this._mp3UseMpegAudio?(x="mpeg",v="",_=new Uint8Array):_=d.default.generateInitSegment(A);else if(E==="video")this._videoMeta=A,_=d.default.generateInitSegment(A);else return;if(!this._onInitSegment)throw new p.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(E,{type:E,data:_.buffer,codec:v,container:E+"/"+x,mediaDuration:A.duration})},y.prototype._calculateDtsBase=function(E,A){this._dtsBaseInited||(E.samples&&E.samples.length&&(this._audioDtsBase=E.samples[0].dts),A.samples&&A.samples.length&&(this._videoDtsBase=A.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},y.prototype.flushStashedSamples=function(){var E=this._videoStashedLastSample,A=this._audioStashedLastSample,_={type:"video",id:1,sequenceNumber:0,samples:[],length:0};E!=null&&(_.samples.push(E),_.length=E.length);var x={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};A!=null&&(x.samples.push(A),x.length=A.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(_,!0),this._remuxAudio(x,!0)},y.prototype._remuxAudio=function(E,A){if(this._audioMeta!=null){var _=E,x=_.samples,v=void 0,T=-1,C=-1,k=this._audioMeta.refSampleDuration,B=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,R=this._dtsBaseInited&&this._audioNextDts===void 0,I=!1;if(!(!x||x.length===0)&&!(x.length===1&&!A)){var S=0,L=null,b=0;B?(S=0,b=_.length):(S=8,b=8+_.length);var w=null;if(x.length>1&&(w=x.pop(),b-=w.length),this._audioStashedLastSample!=null){var M=this._audioStashedLastSample;this._audioStashedLastSample=null,x.unshift(M),b+=M.length}w!=null&&(this._audioStashedLastSample=w);var O=x[0].dts-this._dtsBase;if(this._audioNextDts)v=O-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())v=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(I=!0);else{var D=this._audioSegmentInfoList.getLastSampleBefore(O);if(D!=null){var F=O-(D.originalDts+D.duration);F<=3&&(F=0);var U=D.dts+D.duration+F;v=O-U}else v=0}if(I){var K=O-v,N=this._videoSegmentInfoList.getLastSegmentBefore(O);if(N!=null&&N.beginDts<K){var G=f.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(G){var H=N.beginDts,Z=K-N.beginDts;c.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+H+", duration: "+Z),x.unshift({unit:G,dts:H,pts:H}),b+=G.byteLength}}else I=!1}for(var J=[],X=0;X<x.length;X++){var M=x[X],ne=M.unit,ce=M.dts-this._dtsBase,H=ce,re=!1,Ee=null,se=0;if(!(ce<-.001)){if(this._audioMeta.codec!=="mp3"){var ee=ce,he=3;if(this._audioNextDts&&(ee=this._audioNextDts),v=ce-ee,v<=-he*k){c.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+ce+" ms ,curRefDts: "+ee+" ms)  due to dtsCorrection: "+v+" ms overlap.");continue}else if(v>=he*k&&this._fillAudioTimestampGap&&!h.default.safari){re=!0;var _e=Math.floor(v/k);c.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+ce+" ms, curRefDts: "+ee+" ms, ")+("dtsCorrection: "+Math.round(v)+" ms, generate: "+_e+" frames")),H=Math.floor(ee),se=Math.floor(ee+k)-H;var G=f.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);G==null&&(c.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),G=ne),Ee=[];for(var ke=0;ke<_e;ke++){ee=ee+k;var De=Math.floor(ee),we=Math.floor(ee+k)-De,Ie={dts:De,pts:De,cts:0,unit:G,size:G.byteLength,duration:we,originalDts:ce,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Ee.push(Ie),b+=Ie.size}this._audioNextDts=ee+k}else H=Math.floor(ee),se=Math.floor(ee+k)-H,this._audioNextDts=ee+k}else{if(H=ce-v,X!==x.length-1){var ve=x[X+1].dts-this._dtsBase-v;se=ve-H}else if(w!=null){var ve=w.dts-this._dtsBase-v;se=ve-H}else J.length>=1?se=J[J.length-1].duration:se=Math.floor(k);this._audioNextDts=H+se}T===-1&&(T=H),J.push({dts:H,pts:H,cts:0,unit:M.unit,size:M.unit.byteLength,duration:se,originalDts:ce,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),re&&J.push.apply(J,Ee)}}if(J.length===0){_.samples=[],_.length=0;return}B?L=new Uint8Array(b):(L=new Uint8Array(b),L[0]=b>>>24&255,L[1]=b>>>16&255,L[2]=b>>>8&255,L[3]=b&255,L.set(d.default.types.mdat,4));for(var X=0;X<J.length;X++){var ne=J[X].unit;L.set(ne,S),S+=ne.byteLength}var Ce=J[J.length-1];C=Ce.dts+Ce.duration;var Re=new g.MediaSegmentInfo;Re.beginDts=T,Re.endDts=C,Re.beginPts=T,Re.endPts=C,Re.originalBeginDts=J[0].originalDts,Re.originalEndDts=Ce.originalDts+Ce.duration,Re.firstSample=new g.SampleInfo(J[0].dts,J[0].pts,J[0].duration,J[0].originalDts,!1),Re.lastSample=new g.SampleInfo(Ce.dts,Ce.pts,Ce.duration,Ce.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Re),_.samples=J,_.sequenceNumber++;var je=null;B?je=new Uint8Array:je=d.default.moof(_,T),_.samples=[],_.length=0;var z={type:"audio",data:this._mergeBoxes(je,L).buffer,sampleCount:J.length,info:Re};B&&R&&(z.timestampOffset=T),this._onMediaSegment("audio",z)}}},y.prototype._remuxVideo=function(E,A){if(this._videoMeta!=null){var _=E,x=_.samples,v=void 0,T=-1,C=-1,k=-1,B=-1;if(!(!x||x.length===0)&&!(x.length===1&&!A)){var R=8,I=null,S=8+E.length,L=null;if(x.length>1&&(L=x.pop(),S-=L.length),this._videoStashedLastSample!=null){var b=this._videoStashedLastSample;this._videoStashedLastSample=null,x.unshift(b),S+=b.length}L!=null&&(this._videoStashedLastSample=L);var w=x[0].dts-this._dtsBase;if(this._videoNextDts)v=w-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())v=0;else{var M=this._videoSegmentInfoList.getLastSampleBefore(w);if(M!=null){var O=w-(M.originalDts+M.duration);O<=3&&(O=0);var D=M.dts+M.duration+O;v=w-D}else v=0}for(var F=new g.MediaSegmentInfo,U=[],K=0;K<x.length;K++){var b=x[K],N=b.dts-this._dtsBase,G=b.isKeyframe,H=N-v,Z=b.cts,J=H+Z;T===-1&&(T=H,k=J);var X=0;if(K!==x.length-1){var ne=x[K+1].dts-this._dtsBase-v;X=ne-H}else if(L!=null){var ne=L.dts-this._dtsBase-v;X=ne-H}else U.length>=1?X=U[U.length-1].duration:X=Math.floor(this._videoMeta.refSampleDuration);if(G){var ce=new g.SampleInfo(H,J,X,b.dts,!0);ce.fileposition=b.fileposition,F.appendSyncPoint(ce)}U.push({dts:H,pts:J,cts:Z,units:b.units,size:b.length,isKeyframe:G,duration:X,originalDts:N,flags:{isLeading:0,dependsOn:G?2:1,isDependedOn:G?1:0,hasRedundancy:0,isNonSync:G?0:1}})}I=new Uint8Array(S),I[0]=S>>>24&255,I[1]=S>>>16&255,I[2]=S>>>8&255,I[3]=S&255,I.set(d.default.types.mdat,4);for(var K=0;K<U.length;K++)for(var re=U[K].units;re.length;){var Ee=re.shift(),se=Ee.data;I.set(se,R),R+=se.byteLength}var ee=U[U.length-1];if(C=ee.dts+ee.duration,B=ee.pts+ee.duration,this._videoNextDts=C,F.beginDts=T,F.endDts=C,F.beginPts=k,F.endPts=B,F.originalBeginDts=U[0].originalDts,F.originalEndDts=ee.originalDts+ee.duration,F.firstSample=new g.SampleInfo(U[0].dts,U[0].pts,U[0].duration,U[0].originalDts,U[0].isKeyframe),F.lastSample=new g.SampleInfo(ee.dts,ee.pts,ee.duration,ee.originalDts,ee.isKeyframe),this._isLive||this._videoSegmentInfoList.append(F),_.samples=U,_.sequenceNumber++,this._forceFirstIDR){var he=U[0].flags;he.dependsOn=2,he.isNonSync=0}var _e=d.default.moof(_,T);_.samples=[],_.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(_e,I).buffer,sampleCount:U.length,info:F})}}},y.prototype._mergeBoxes=function(E,A){var _=new Uint8Array(E.byteLength+A.byteLength);return _.set(E,0),_.set(A,E.byteLength),_},y}();a.default=m},"./src/utils/browser.js":function(o,a,l){l.r(a);var c={};function d(){var f=self.navigator.userAgent.toLowerCase(),h=/(edge)\/([\w.]+)/.exec(f)||/(opr)[\/]([\w.]+)/.exec(f)||/(chrome)[ \/]([\w.]+)/.exec(f)||/(iemobile)[\/]([\w.]+)/.exec(f)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(f)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(f)||/(webkit)[ \/]([\w.]+)/.exec(f)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(f)||/(msie) ([\w.]+)/.exec(f)||f.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(f)||f.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(f)||[],g=/(ipad)/.exec(f)||/(ipod)/.exec(f)||/(windows phone)/.exec(f)||/(iphone)/.exec(f)||/(kindle)/.exec(f)||/(android)/.exec(f)||/(windows)/.exec(f)||/(mac)/.exec(f)||/(linux)/.exec(f)||/(cros)/.exec(f)||[],p={browser:h[5]||h[3]||h[1]||"",version:h[2]||h[4]||"0",majorVersion:h[4]||h[2]||"0",platform:g[0]||""},m={};if(p.browser){m[p.browser]=!0;var y=p.majorVersion.split(".");m.version={major:parseInt(p.majorVersion,10),string:p.version},y.length>1&&(m.version.minor=parseInt(y[1],10)),y.length>2&&(m.version.build=parseInt(y[2],10))}if(p.platform&&(m[p.platform]=!0),(m.chrome||m.opr||m.safari)&&(m.webkit=!0),m.rv||m.iemobile){m.rv&&delete m.rv;var E="msie";p.browser=E,m[E]=!0}if(m.edge){delete m.edge;var A="msedge";p.browser=A,m[A]=!0}if(m.opr){var _="opera";p.browser=_,m[_]=!0}if(m.safari&&m.android){var x="android";p.browser=x,m[x]=!0}m.name=p.browser,m.platform=p.platform;for(var v in c)c.hasOwnProperty(v)&&delete c[v];Object.assign(c,m)}d(),a.default=c},"./src/utils/exception.js":function(o,a,l){l.r(a),l.d(a,{RuntimeException:function(){return d},IllegalStateException:function(){return f},InvalidArgumentException:function(){return h},NotImplementedException:function(){return g}});var c=function(){var p=function(m,y){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,A){E.__proto__=A}||function(E,A){for(var _ in A)Object.prototype.hasOwnProperty.call(A,_)&&(E[_]=A[_])},p(m,y)};return function(m,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");p(m,y);function E(){this.constructor=m}m.prototype=y===null?Object.create(y):(E.prototype=y.prototype,new E)}}(),d=function(){function p(m){this._message=m}return Object.defineProperty(p.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),p.prototype.toString=function(){return this.name+": "+this.message},p}(),f=function(p){c(m,p);function m(y){return p.call(this,y)||this}return Object.defineProperty(m.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),m}(d),h=function(p){c(m,p);function m(y){return p.call(this,y)||this}return Object.defineProperty(m.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),m}(d),g=function(p){c(m,p);function m(y){return p.call(this,y)||this}return Object.defineProperty(m.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),m}(d)},"./src/utils/logger.js":function(o,a,l){l.r(a);var c=l("./node_modules/events/events.js"),d=l.n(c),f=function(){function h(){}return h.e=function(g,p){(!g||h.FORCE_GLOBAL_TAG)&&(g=h.GLOBAL_TAG);var m="["+g+"] > "+p;h.ENABLE_CALLBACK&&h.emitter.emit("log","error",m),h.ENABLE_ERROR&&(console.error?console.error(m):console.warn?console.warn(m):console.log(m))},h.i=function(g,p){(!g||h.FORCE_GLOBAL_TAG)&&(g=h.GLOBAL_TAG);var m="["+g+"] > "+p;h.ENABLE_CALLBACK&&h.emitter.emit("log","info",m),h.ENABLE_INFO&&(console.info?console.info(m):console.log(m))},h.w=function(g,p){(!g||h.FORCE_GLOBAL_TAG)&&(g=h.GLOBAL_TAG);var m="["+g+"] > "+p;h.ENABLE_CALLBACK&&h.emitter.emit("log","warn",m),h.ENABLE_WARN&&(console.warn?console.warn(m):console.log(m))},h.d=function(g,p){(!g||h.FORCE_GLOBAL_TAG)&&(g=h.GLOBAL_TAG);var m="["+g+"] > "+p;h.ENABLE_CALLBACK&&h.emitter.emit("log","debug",m),h.ENABLE_DEBUG&&(console.debug?console.debug(m):console.log(m))},h.v=function(g,p){(!g||h.FORCE_GLOBAL_TAG)&&(g=h.GLOBAL_TAG);var m="["+g+"] > "+p;h.ENABLE_CALLBACK&&h.emitter.emit("log","verbose",m),h.ENABLE_VERBOSE&&console.log(m)},h}();f.GLOBAL_TAG="flv.js",f.FORCE_GLOBAL_TAG=!1,f.ENABLE_ERROR=!0,f.ENABLE_INFO=!0,f.ENABLE_WARN=!0,f.ENABLE_DEBUG=!0,f.ENABLE_VERBOSE=!0,f.ENABLE_CALLBACK=!1,f.emitter=new(d()),a.default=f},"./src/utils/logging-control.js":function(o,a,l){l.r(a);var c=l("./node_modules/events/events.js"),d=l.n(c),f=l("./src/utils/logger.js"),h=function(){function g(){}return Object.defineProperty(g,"forceGlobalTag",{get:function(){return f.default.FORCE_GLOBAL_TAG},set:function(p){f.default.FORCE_GLOBAL_TAG=p,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"globalTag",{get:function(){return f.default.GLOBAL_TAG},set:function(p){f.default.GLOBAL_TAG=p,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableAll",{get:function(){return f.default.ENABLE_VERBOSE&&f.default.ENABLE_DEBUG&&f.default.ENABLE_INFO&&f.default.ENABLE_WARN&&f.default.ENABLE_ERROR},set:function(p){f.default.ENABLE_VERBOSE=p,f.default.ENABLE_DEBUG=p,f.default.ENABLE_INFO=p,f.default.ENABLE_WARN=p,f.default.ENABLE_ERROR=p,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableDebug",{get:function(){return f.default.ENABLE_DEBUG},set:function(p){f.default.ENABLE_DEBUG=p,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableVerbose",{get:function(){return f.default.ENABLE_VERBOSE},set:function(p){f.default.ENABLE_VERBOSE=p,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableInfo",{get:function(){return f.default.ENABLE_INFO},set:function(p){f.default.ENABLE_INFO=p,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableWarn",{get:function(){return f.default.ENABLE_WARN},set:function(p){f.default.ENABLE_WARN=p,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableError",{get:function(){return f.default.ENABLE_ERROR},set:function(p){f.default.ENABLE_ERROR=p,g._notifyChange()},enumerable:!1,configurable:!0}),g.getConfig=function(){return{globalTag:f.default.GLOBAL_TAG,forceGlobalTag:f.default.FORCE_GLOBAL_TAG,enableVerbose:f.default.ENABLE_VERBOSE,enableDebug:f.default.ENABLE_DEBUG,enableInfo:f.default.ENABLE_INFO,enableWarn:f.default.ENABLE_WARN,enableError:f.default.ENABLE_ERROR,enableCallback:f.default.ENABLE_CALLBACK}},g.applyConfig=function(p){f.default.GLOBAL_TAG=p.globalTag,f.default.FORCE_GLOBAL_TAG=p.forceGlobalTag,f.default.ENABLE_VERBOSE=p.enableVerbose,f.default.ENABLE_DEBUG=p.enableDebug,f.default.ENABLE_INFO=p.enableInfo,f.default.ENABLE_WARN=p.enableWarn,f.default.ENABLE_ERROR=p.enableError,f.default.ENABLE_CALLBACK=p.enableCallback},g._notifyChange=function(){var p=g.emitter;if(p.listenerCount("change")>0){var m=g.getConfig();p.emit("change",m)}},g.registerListener=function(p){g.emitter.addListener("change",p)},g.removeListener=function(p){g.emitter.removeListener("change",p)},g.addLogListener=function(p){f.default.emitter.addListener("log",p),f.default.emitter.listenerCount("log")>0&&(f.default.ENABLE_CALLBACK=!0,g._notifyChange())},g.removeLogListener=function(p){f.default.emitter.removeListener("log",p),f.default.emitter.listenerCount("log")===0&&(f.default.ENABLE_CALLBACK=!1,g._notifyChange())},g}();h.emitter=new(d()),a.default=h},"./src/utils/polyfill.js":function(o,a,l){l.r(a);var c=function(){function d(){}return d.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(f,h){return f.__proto__=h,f},Object.assign=Object.assign||function(f){if(f==null)throw new TypeError("Cannot convert undefined or null to object");for(var h=Object(f),g=1;g<arguments.length;g++){var p=arguments[g];if(p!=null)for(var m in p)p.hasOwnProperty(m)&&(h[m]=p[m])}return h},typeof self.Promise!="function"&&l("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},d}();c.install(),a.default=c},"./src/utils/utf8-conv.js":function(o,a,l){l.r(a);function c(f,h,g){var p=f;if(h+g<p.length){for(;g--;)if((p[++h]&192)!==128)return!1;return!0}else return!1}function d(f){for(var h=[],g=f,p=0,m=f.length;p<m;){if(g[p]<128){h.push(String.fromCharCode(g[p])),++p;continue}else if(!(g[p]<192)){if(g[p]<224){if(c(g,p,1)){var y=(g[p]&31)<<6|g[p+1]&63;if(y>=128){h.push(String.fromCharCode(y&65535)),p+=2;continue}}}else if(g[p]<240){if(c(g,p,2)){var y=(g[p]&15)<<12|(g[p+1]&63)<<6|g[p+2]&63;if(y>=2048&&(y&63488)!==55296){h.push(String.fromCharCode(y&65535)),p+=3;continue}}}else if(g[p]<248&&c(g,p,3)){var y=(g[p]&7)<<18|(g[p+1]&63)<<12|(g[p+2]&63)<<6|g[p+3]&63;if(y>65536&&y<1114112){y-=65536,h.push(String.fromCharCode(y>>>10|55296)),h.push(String.fromCharCode(y&1023|56320)),p+=4;continue}}}h.push(String.fromCharCode(65533)),++p}return h.join("")}a.default=d}},n={};function i(o){var a=n[o];if(a!==void 0)return a.exports;var l=n[o]={exports:{}};return t[o].call(l.exports,l,l.exports,i),l.exports}i.m=t,function(){i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,{a}),a}}(),function(){i.d=function(o,a){for(var l in a)i.o(a,l)&&!i.o(o,l)&&Object.defineProperty(o,l,{enumerable:!0,get:a[l]})}}(),function(){i.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)}}(),function(){i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}}();var s=i("./src/index.js");return s}()})})(Vl);var rv=Vl.exports;const xn=qp(rv),Yv="",Br=r=>(u.pushScopeId("data-v-8ac92887"),r=r(),u.popScopeId(),r),iv=["src"],sv=["src"],ov=Br(()=>u.createElementVNode("div",{class:"video-control-mask"},null,-1)),av={class:"video-progress"},lv=Br(()=>u.createElementVNode("div",{class:"video-progress-not-yet"},null,-1)),uv=["src"],cv={class:"video-action"},dv={class:"video-play"},fv={class:"video-play-icon"},hv={key:0,class:"video-time"},pv={key:1,class:"video-live flex flex-row justify-center items-center"},gv=Br(()=>u.createElementVNode("div",{class:"video-space"},null,-1)),mv={class:"video-setting"},yv={class:"video-action-icon"},Ev={class:"selection-list"},vv=["onClick"],Av={class:"video-action-icon"},_v={key:0,class:"multiple"},xv={key:1,class:"multiple"},Sv={class:"speed-list"},Tv=["onClick"],Iv={key:0,class:"video-action-icon"},bv={key:1,class:"video-action-icon"},Cv=Br(()=>u.createElementVNode("div",{class:"video-action-icon"},[u.createElementVNode("img",{src:vg,alt:"volume"})],-1)),Lv={class:"setting-list"},Rv={class:"setting-item"},wv={class:"setting-item"},kv={class:"video-action-icon"},Dv={class:"video-action-icon"},Ov=u.defineComponent({__name:"feather-video-player",props:{url:{default:""},type:{default:void 0}},setup(r){var jl;const e=r,t=u.ref(),n=u.ref(),i=u.ref(),s=u.ref(),o=u.ref(),a=u.ref(),l=u.ref(),c=u.ref(),d=u.ref(),f=u.ref(),h=u.ref(),g=u.ref(),p=u.ref(),m=u.ref(),y=u.ref(),E=u.ref("video"),A=u.ref(!1),_=u.ref(!1),x=u.ref(!1),v=u.ref(!1),T=u.ref(0),C=u.ref(0),k=u.ref(0),B=u.ref(0),R=u.ref(0),I=u.ref(""),S=u.ref(!1),L=[2,1.5,1.25,1,.75,.5],b=u.ref(1),w=u.ref(!1),M=u.ref(!1),O=u.ref(!0),D=u.ref(100),F=u.ref(),U=u.ref([]),K=u.ref(!0),N=u.ref(!1),G=u.ref(!1),H=u.ref(""),Z=u.ref([]);if(typeof e.url=="string")H.value=e.url;else if(e.url.urls.length>0){H.value=e.url.urls[0];const te=(jl=e.url.names)==null?void 0:jl.length;Z.value=e.url.urls.map((ae,pe)=>({url:ae,name:1<=te-pe?e.url.names[pe]:""+(pe+1)}))}u.watch(x,te=>{c.value.style.pointerEvents=te?"none":"auto"}),u.watch(T,te=>{}),u.watch(N,te=>{n.value&&(n.value.loop=te)}),u.watch(G,te=>{n.value&&(n.value.style.transform=te?"rotateY(180deg)":"")}),u.onMounted(()=>{console.log("onMounted"),u.nextTick(()=>{t.value&&(t.value.style.height=t.value.clientWidth*.5625+"px"),J(),X(n.value)})}),u.onUnmounted(()=>{Ee()});const J=()=>{window.addEventListener("resize",Ce),window.addEventListener("fullscreenchange",Re),window.addEventListener("enterpictureinpicture",je),window.addEventListener("leavepictureinpicture",je),t.value.addEventListener("mouseenter",q),t.value.addEventListener("mousemove",$),t.value.addEventListener("mouseleave",ie),n.value.addEventListener("click",z),n.value.addEventListener("loadedmetadata",Ae),n.value.addEventListener("timeupdate",Me),n.value.addEventListener("progress",Ze),n.value.addEventListener("ended",Fe),n.value.addEventListener("canplay",ds),n.value.addEventListener("pause",Q),d.value.addEventListener("mouseenter",Sn),d.value.addEventListener("mousedown",me),d.value.addEventListener("mousemove",Ve),d.value.addEventListener("mouseleave",Tn)},X=(te,ae="normal")=>{switch(e.type){case"m3u8":{ne(te,ae);break}case"flv":{ce(te,ae);break}default:H.value.includes(".m3u8")?ne(te,ae):H.value.includes(".flv")?ce(te,ae):re(te,ae)}},ne=(te,ae="normal")=>{var pe,be,Se,Ye;ae==="normal"?Ge.isSupported()?(s.value=new Ge({liveDurationInfinity:!0}),(pe=s.value)==null||pe.attachMedia(te),(be=s.value)==null||be.on(Ge.Events.MEDIA_ATTACHED,()=>{var ye,Xe,Tt;console.log(""),(ye=s.value)==null||ye.loadSource(H.value),(Xe=s.value)==null||Xe.on(Ge.Events.MANIFEST_PARSED,(Qn,ze)=>{console.log("manifest loaded, found "+ze.levels.length+" quality level")}),(Tt=s.value)==null||Tt.on(Ge.Events.ERROR,function(Qn,ze){let fs=ze.type,hs=ze.details,ps=ze.fatal;switch(console.log(""),console.log(fs),console.log(hs),console.log(ps),ze.details){case Ge.ErrorDetails.FRAG_LOAD_ERROR:break}})})):console.error("M3U8"):Ge.isSupported()?(o.value=new Ge({liveDurationInfinity:!0}),(Se=o.value)==null||Se.attachMedia(te),(Ye=o.value)==null||Ye.on(Ge.Events.MEDIA_ATTACHED,()=>{var ye,Xe,Tt;console.log("Preview"),(ye=o.value)==null||ye.loadSource(H.value),(Xe=o.value)==null||Xe.on(Ge.Events.MANIFEST_PARSED,(Qn,ze)=>{console.log("Preview manifest loaded, found "+ze.levels.length+" quality level")}),(Tt=o.value)==null||Tt.on(Ge.Events.ERROR,function(Qn,ze){let fs=ze.type,hs=ze.details,ps=ze.fatal;switch(console.log(""),console.log(fs),console.log(hs),console.log(ps),ze.details){case Ge.ErrorDetails.FRAG_LOAD_ERROR:break}})})):console.error("Preview M3U8")},ce=(te,ae="normal")=>{var pe,be,Se,Ye,ye,Xe;ae==="normal"?xn.isSupported()?(a.value=xn.createPlayer({type:"flv",url:H.value}),(pe=a.value)==null||pe.attachMediaElement(te),(be=a.value)==null||be.load(),(Se=a.value)==null||Se.on(xn.Events.ERROR,(Tt,Qn,ze)=>{console.log(""),ze.code===-1&&console.log("flv")})):console.error("FLV"):xn.isSupported()?(l.value=xn.createPlayer({type:"flv",url:H.value}),(Ye=l.value)==null||Ye.attachMediaElement(te),(ye=l.value)==null||ye.load(),(Xe=l.value)==null||Xe.on(xn.Events.ERROR,(Tt,Qn,ze)=>{console.log("Preview "),ze.code===-1&&console.log("Preview flv")})):console.error("Preview FLV")},re=(te,ae="normal")=>{ae==="normal"?n.value.src=H.value:i.value.src=H.value},Ee=()=>{var te,ae,pe,be;(te=s.value)==null||te.destroy(),(ae=o.value)==null||ae.destroy(),(pe=a.value)==null||pe.destroy(),(be=l.value)==null||be.destroy(),s.value=null,o.value=null,a.value=null,l.value=null},se=()=>{n.value.paused?(n.value.play(),v.value=!0):(n.value.pause(),v.value=!1)},ee=()=>{w.value&&document.fullscreenElement?(w.value=!1,document.exitFullscreen()):(w.value=!0,t.value.requestFullscreen())},he=()=>{M.value&&document.pictureInPictureElement?(M.value=!1,document.exitPictureInPicture()):(M.value=!0,n.value.requestPictureInPicture())},_e=()=>{K.value?(K.value=!1,F.value.hide(),F.value.pause()):(K.value=!0,F.value.show(),F.value.play())},ke=()=>{O.value?(O.value=!1,n.value.muted=!0):(O.value=!0,n.value.muted=!1)},De=te=>{D.value=te,O.value=te!==0,n.value&&(n.value.volume=te/100,te===0&&(n.value.muted=!0))},we=te=>{b.value=te,n.value&&(n.value.playbackRate=te)},Ie=te=>{let ae=Math.round(te),pe=0,be=0;ae>60&&(pe=Math.floor(ae/60),ae=Math.floor(ae%60),pe>60&&(be=Math.floor(pe/60),pe=Math.floor(pe%60)));let Se="00:"+ve(ae);return pe>0&&(Se=ve(pe)+":"+ve(ae)),(be>0||R.value>=3600)&&(Se=ve(be)+":"+ve(pe)+":"+ve(ae)),Se},ve=te=>{let ae=te.toString();return te<10&&(ae="0"+te),ae},Ce=()=>{if(t.value&&(t.value.style.height=t.value.clientWidth*.5625+"px"),F.value&&F.value.resize(),d.value){const ae=d.value.getBoundingClientRect().width;h.value.style.width=ae*(C.value/R.value)+"px",f.value.style.width=ae*(T.value/R.value)+"px",g.value.style.left=ae*(T.value/R.value)-12+"px"}},Re=()=>{w.value=document.fullscreenElement!==null},je=()=>{M.value=document.pictureInPictureElement!==null},z=te=>{te.preventDefault(),se()},Ae=()=>{const te=n.value.duration;te===1/0?E.value="live":(R.value=te,X(i.value,"preview")),F.value.play()},Me=()=>{if(E.value==="video"){T.value=n.value.currentTime;const ae=d.value.getBoundingClientRect().width;x.value||(f.value.style.width=ae*(T.value/R.value)+"px",g.value.style.left=ae*(T.value/R.value)-12+"px")}},Ze=()=>{if(E.value==="video"){const te=n.value.buffered,pe=d.value.getBoundingClientRect().width;te.length>0&&(C.value=te.end(te.length-1),h.value.style.width=pe*(C.value/R.value)+"px")}},Fe=()=>{v.value=!1,F.value&&F.value.stop()},ds=()=>{console.log("Canplay"),n.value.paused&&n.value.play(),v.value=!0},Q=()=>{v.value=!1},q=()=>{A.value=!0,clearTimeout(y.value),fe()},$=()=>{A.value=!0,clearTimeout(y.value),fe()},ie=()=>{x.value||(A.value=!1)},fe=()=>{y.value=setTimeout(()=>{A.value=!1,clearTimeout(y.value)},3200)},me=()=>{x.value=!0,document.addEventListener("mousemove",nn),document.addEventListener("mouseup",Kl)},Ve=te=>{const ae=d.value.getBoundingClientRect(),pe=ae.left,be=ae.right;let Se=0;te.pageX>=pe&&te.pageX<=be?Se=te.pageX-pe:te.pageX>be&&(Se=be-pe),B.value=Se,E.value==="video"&&(Gl(),Ft())},Ft=()=>{S.value=!0;const te=d.value.getBoundingClientRect(),ae=p.value.getBoundingClientRect(),pe=m.value.getBoundingClientRect(),be=te.width,Se=ae.width,Ye=pe.width;let ye=B.value;ye<Se/2?ye=0:ye>be-Se/2?ye=be-Se:ye-=Se/2,p.value.style.left=ye+"px",m.value.style.left=ye+(Se-Ye)/2+"px",m.value.innerText=Ie(B.value/be*R.value)},Sn=()=>{const te=d.value.children[0];te&&(te.style.height="4px"),_.value=!0},Tn=()=>{const te=d.value.children[0];x.value||(te&&(te.style.height="2px"),_.value=!1,S.value=!1)},nn=te=>{if(x.value){clearTimeout(y.value);const ae=d.value.children[0];ae&&(ae.style.height="4px"),_.value=!0;const pe=d.value.getBoundingClientRect(),be=pe.left,Se=pe.right,Ye=pe.width;let ye=0;te.pageX>=be&&te.pageX<=Se?ye=te.pageX-be:te.pageX>Se&&(ye=Se-be),B.value=ye,E.value==="video"&&(Gl(),Ft()),f.value.style.width=ye+"px",g.value.style.left=ye-12+"px",k.value=ye/Ye*R.value}},Kl=te=>{document.removeEventListener("mousemove",nn),document.removeEventListener("mouseup",Kl),nn(te),Tn(),fe(),x.value=!1,S.value=!1,n.value&&(n.value.currentTime=k.value,k.value=0,n.value.paused&&n.value.play(),v.value=!0)},{run:Gl}=Cg(()=>{Bv(B.value).then(te=>{typeof te=="string"&&(I.value=te)})},250),Bv=te=>new Promise(ae=>{const be=d.value.getBoundingClientRect().width;let Se=i.value;Se.currentTime=R.value*te/be,Se.addEventListener("seeked",()=>{var Tt;let Ye=document.createElement("canvas"),ye=Se.width,Xe=Se.width*Se.videoHeight/Se.videoWidth;Ye.width=ye,Ye.height=Xe,(Tt=Ye.getContext("2d"))==null||Tt.drawImage(Se,0,0,ye,Xe),ae(Ye.toDataURL("image/jpeg"))})}),Mv=te=>{H.value=Z.value[te].url,Ee(),X(n.value),X(i.value,"preview")};return(te,ae)=>{const pe=ci,be=S0,Se=$0,Ye=cg;return u.openBlock(),u.createElementBlock("div",{class:"feather-video-container",ref_key:"containerRef",ref:t},[u.createElementVNode("video",{class:"feather-video",ref_key:"videoRef",ref:n,src:H.value},null,8,iv),u.createElementVNode("video",{class:"feather-video-preview",src:H.value,ref_key:"videoPreviewRef",ref:i,preload:"none",crossOrigin:"anonymous",width:"960",height:"540"},null,8,sv),u.createVNode(u.unref(pi),{class:"feather-video-danmaku",ref_key:"danmaku",ref:F,danmus:U.value,autoplay:!1,speeds:120,randomChannel:!0,top:8},null,8,["danmus"]),u.createVNode(u.Transition,{name:"fade"},{default:u.withCtx(()=>[u.withDirectives(u.createElementVNode("div",{class:"feather-video-control",ref_key:"controlRef",ref:c},[ov,u.withDirectives(u.createElementVNode("div",{class:"video-progress-box",ref_key:"progressRef",ref:d},[u.createElementVNode("div",av,[u.createElementVNode("div",{class:"video-progress-has-done",ref_key:"progressDoneRef",ref:f},null,512),u.createElementVNode("div",{class:"video-progress-has-buffered",ref_key:"progressBufferedRef",ref:h},null,512),lv,u.withDirectives(u.createElementVNode("img",{class:"video-progress-block",src:dg,ref_key:"progressBlockRef",ref:g,alt:"block"},null,512),[[u.vShow,_.value]]),u.withDirectives(u.createElementVNode("img",{class:"video-progress-preview",src:I.value,ref_key:"progressPreviewRef",ref:p,alt:"video-progress-preview"},null,8,uv),[[u.vShow,I.value&&S.value]]),u.withDirectives(u.createElementVNode("div",{class:"video-progress-preview-time",ref_key:"progressPreviewTimeRef",ref:m},null,512),[[u.vShow,I.value&&S.value]])])],512),[[u.vShow,E.value==="video"]]),u.createElementVNode("div",cv,[u.createElementVNode("div",dv,[u.createElementVNode("div",fv,[v.value?(u.openBlock(),u.createElementBlock("img",{key:0,src:fg,alt:"pause",onClick:se})):(u.openBlock(),u.createElementBlock("img",{key:1,src:hg,alt:"play",onClick:se}))]),E.value==="video"?(u.openBlock(),u.createElementBlock("div",hv,u.toDisplayString(`${Ie(T.value)} / ${Ie(R.value)}`),1)):u.createCommentVNode("",!0),E.value==="live"?(u.openBlock(),u.createElementBlock("div",pv,"Live")):u.createCommentVNode("",!0)]),gv,u.createElementVNode("div",mv,[u.createElementVNode("div",yv,[K.value?(u.openBlock(),u.createBlock(pe,{key:0,class:"box-item",effect:"dark",content:"",placement:"top",teleported:!1},{default:u.withCtx(()=>[u.createElementVNode("img",{style:{width:"28px",height:"30px"},src:pg,alt:"danmu",onClick:_e})]),_:1})):(u.openBlock(),u.createBlock(pe,{key:1,class:"box-item",effect:"dark",content:"",placement:"top",teleported:!1},{default:u.withCtx(()=>[u.createElementVNode("img",{style:{width:"28px",height:"30px"},src:gg,alt:"danmu",onClick:_e})]),_:1}))]),Z.value&&Z.value.length>0?(u.openBlock(),u.createBlock(be,{key:0,width:"160px",trigger:"hover",effect:"dark",placement:"top","show-arrow":!1,teleported:!1,"popper-class":"volume-popover"},{reference:u.withCtx(()=>[u.createElementVNode("div",{class:"video-action-icon"},[u.createElementVNode("img",{src:mg,alt:"list",onClick:ke})])]),default:u.withCtx(()=>[u.createElementVNode("div",Ev,[(u.openBlock(!0),u.createElementBlock(u.Fragment,null,u.renderList(Z.value,(ye,Xe)=>(u.openBlock(),u.createElementBlock("div",{class:u.normalizeClass(`selection-item flex flex-row justify-center ${H.value===ye.url?"selection-item-select":""}`),key:Xe,onClick:Tt=>Mv(Xe)},u.toDisplayString(ye.name),11,vv))),128))])]),_:1})):u.createCommentVNode("",!0),u.createVNode(be,{width:"75px",trigger:"hover",effect:"dark",placement:"top","show-arrow":!1,teleported:!1,"popper-class":"volume-popover"},{reference:u.withCtx(()=>[u.createElementVNode("div",Av,[b.value===1?(u.openBlock(),u.createElementBlock("div",_v,"")):(u.openBlock(),u.createElementBlock("div",xv,u.toDisplayString(b.value)+"x",1))])]),default:u.withCtx(()=>[u.createElementVNode("div",Sv,[(u.openBlock(),u.createElementBlock(u.Fragment,null,u.renderList(L,ye=>u.createElementVNode("div",{class:"speed-item flex flex-row justify-center",style:u.normalizeStyle({color:b.value===ye?"var(--el-color-primary)":"#d8eaf5"}),key:ye,onClick:Xe=>we(ye)},u.toDisplayString(ye)+"x ",13,Tv)),64))])]),_:1}),u.createVNode(be,{width:"20px",trigger:"hover",effect:"dark",placement:"top","show-arrow":!1,teleported:!1,"popper-class":"volume-popover"},{reference:u.withCtx(()=>[O.value?(u.openBlock(),u.createElementBlock("div",Iv,[u.createElementVNode("img",{src:yg,alt:"volume",onClick:ke})])):(u.openBlock(),u.createElementBlock("div",bv,[u.createElementVNode("img",{src:Eg,alt:"volume",onClick:ke})]))]),default:u.withCtx(()=>[u.createVNode(Se,{modelValue:D.value,"onUpdate:modelValue":ae[0]||(ae[0]=ye=>D.value=ye),vertical:"",height:"120px",size:"small",onInput:De,onChange:De},null,8,["modelValue"])]),_:1}),u.createVNode(be,{width:"120px",trigger:"hover",effect:"dark",placement:"top","show-arrow":!1,teleported:!1,"popper-class":"volume-popover"},{reference:u.withCtx(()=>[Cv]),default:u.withCtx(()=>[u.createElementVNode("div",Lv,[u.createElementVNode("div",Rv,[u.createVNode(Ye,{modelValue:N.value,"onUpdate:modelValue":ae[1]||(ae[1]=ye=>N.value=ye),"inactive-text":"",size:"small"},null,8,["modelValue"])]),u.createElementVNode("div",wv,[u.createVNode(Ye,{modelValue:G.value,"onUpdate:modelValue":ae[2]||(ae[2]=ye=>G.value=ye),"inactive-text":"",size:"small"},null,8,["modelValue"])])])]),_:1}),u.createElementVNode("div",kv,[M.value?(u.openBlock(),u.createBlock(pe,{key:0,class:"box-item",effect:"dark",content:"",placement:"top",teleported:!1},{default:u.withCtx(()=>[u.createElementVNode("img",{src:Ag,alt:"PictureInPicture",onClick:he})]),_:1})):(u.openBlock(),u.createBlock(pe,{key:1,class:"box-item",effect:"dark",content:"",placement:"top",teleported:!1},{default:u.withCtx(()=>[u.createElementVNode("img",{src:_g,alt:"PictureInPicture",onClick:he})]),_:1}))]),u.createElementVNode("div",Dv,[w.value?(u.openBlock(),u.createBlock(pe,{key:0,class:"box-item",effect:"dark",content:"",placement:"top-end",teleported:!1},{default:u.withCtx(()=>[u.createElementVNode("img",{src:xg,alt:"fullscreen",onClick:ee})]),_:1})):(u.openBlock(),u.createBlock(pe,{key:1,class:"box-item",effect:"dark",content:"",placement:"top-end",teleported:!1},{default:u.withCtx(()=>[u.createElementVNode("img",{src:Sg,alt:"fullscreen",onClick:ee})]),_:1}))])])])],512),[[u.vShow,A.value]])]),_:1})],512)}}}),zv="",Pv=((r,e)=>{const t=r.__vccOpts||r;for(const[n,i]of e)t[n]=i;return t})(Ov,[["__scopeId","data-v-8ac92887"]]),Zv="";return Pv});
